--######################################################################################################################
--#   This source code is the property of:
--#   Cablevision Systems Corporation, Inc. (c) 2015
--#   1111 Stewart Avenue, Bethpage, NY 11714
--#   www.cablevision.com
--#   Department: AM
--#
--#   Program name: module-transform.hql
--#   Program type: Hive Query Language script
--#   Purpose:    : Build GOLD_RSDVR_SCHEDULE_LAST_REC_tbl table 
--#   Author(s)   : DataMetica Team
--#   Usage       : beeline -u  <url> -n <username> -p <password> -hivevar var1=var1 -f module-transform.hql
--#   Date        : 12/28/2015
--#   Log File    : .../log/mrdvr/${job_name}.log
--#   SQL File    : 
--#   Error File  : .../log/mrdvr/${job_name}.log
--#   Dependency  : 
--#   Disclaimer  : 
--#
--#   Modification History :
--#   =======================
--#
--#    ver     who                      date             comments
--#   ------   --------------------     ----------       -------------------------------------
--#    1.0     DataMetica Team          12/28/2015       Initial version
--#
--#
--#####################################################################################################################

set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;

INSERT OVERWRITE TABLE ${hivevar:hive_database_name_gold}.${hivevar:gold_rsdvr_schedule_last_rec_tbl}       
SELECT
    case when GOLD_RSDVR_SCHEDULE_LAST_REC.CALLSIGN is null then WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING else GOLD_RSDVR_SCHEDULE_LAST_REC.CALLSIGN end as CALLSIGN,
    case when GOLD_RSDVR_SCHEDULE_LAST_REC.STARTDATE is null then WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING else GOLD_RSDVR_SCHEDULE_LAST_REC.STARTDATE end as STARTDATE,
    case when GOLD_RSDVR_SCHEDULE_LAST_REC.STARTTIME is null then WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING else GOLD_RSDVR_SCHEDULE_LAST_REC.STARTTIME end as STARTTIME,
    case when GOLD_RSDVR_SCHEDULE_LAST_REC.DURATION is null then WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING else GOLD_RSDVR_SCHEDULE_LAST_REC.DURATION end as DURATION,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.SHORTTITLE else WORK_RSDVR_SCHEDULE_DEDUP.SHORT_TITLE_INCOMING end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.SHORTTITLE end as SHORTTITLE,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.LONGTITLE else WORK_RSDVR_SCHEDULE_DEDUP.LONG_TITLE_INCOMING end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.LONGTITLE end as LONGTITLE,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.THEMEIDS else WORK_RSDVR_SCHEDULE_DEDUP.THEME_IDS_INCOMING end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.THEMEIDS end as THEMEIDS,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.SHORTDESC else WORK_RSDVR_SCHEDULE_DEDUP.SHORT_DESC_INCOMING end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.SHORTDESC end as SHORTDESC,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.LONGDESC else WORK_RSDVR_SCHEDULE_DEDUP.LONG_DESC_INCOMING end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.LONGDESC end as LONGDESC,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.MPAARATING else WORK_RSDVR_SCHEDULE_DEDUP.MPAA_RATING_INCOMING end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.MPAARATING end as MPAARATING,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.TVRATING else WORK_RSDVR_SCHEDULE_DEDUP.TV_RATING_INCOMING end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.TVRATING end as TVRATING,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.STEREO else WORK_RSDVR_SCHEDULE_DEDUP.STEREO_INCOMING end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.STEREO end as STEREO,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.SURROUND else WORK_RSDVR_SCHEDULE_DEDUP.SURROUND_INCOMING end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.SURROUND end as SURROUND,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.SAP else WORK_RSDVR_SCHEDULE_DEDUP.SAP_INCOMING end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.SAP end as SAP,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.CLOSEDCAPTION else WORK_RSDVR_SCHEDULE_DEDUP.CLOSEDCAPTION_INCOMING end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.CLOSEDCAPTION end as CLOSEDCAPTION,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.ANIMATED else WORK_RSDVR_SCHEDULE_DEDUP.ANIMATED_INCOMING end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.ANIMATED end as ANIMATED,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.BLACKWHITE else WORK_RSDVR_SCHEDULE_DEDUP.BLACKWHITE_INCOMING end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.BLACKWHITE end as BLACKWHITE,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.RERUN else WORK_RSDVR_SCHEDULE_DEDUP.RERUN_INCOMING end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.RERUN end as RERUN,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.LIVE else WORK_RSDVR_SCHEDULE_DEDUP.LIVE_INCOMING end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.LIVE end as LIVE,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.ISMOVIE else WORK_RSDVR_SCHEDULE_DEDUP.ISMOVIE_INCOMING end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.ISMOVIE end as ISMOVIE,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.NUDITY else WORK_RSDVR_SCHEDULE_DEDUP.NUDITY_INCOMING end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.NUDITY end as NUDITY,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.ADULTLANG else WORK_RSDVR_SCHEDULE_DEDUP.ADULTLANG_INCOMING end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.ADULTLANG end as ADULTLANG,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.VIOLENCE else WORK_RSDVR_SCHEDULE_DEDUP.VIOLENCE_INCOMING end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.VIOLENCE end as VIOLENCE,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.ADULTTHEME else WORK_RSDVR_SCHEDULE_DEDUP.ADULTTHEME_INCOMING end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.ADULTTHEME end as ADULTTHEME,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.HALFSTARS else WORK_RSDVR_SCHEDULE_DEDUP.HALFSTARS_INCOMING end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.HALFSTARS end as HALFSTARS,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.HDTV else WORK_RSDVR_SCHEDULE_DEDUP.HDTV_INCOMING end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.HDTV end as HDTV,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.CVCCALLSIGN else WORK_RSDVR_SCHEDULE_DEDUP.CVC_CALLSIGN_INCOMING end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.CVCCALLSIGN end as CVCCALLSIGN,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.STARTDATE_STARTTIME else WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_STARTTIME_INCOMING end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.STARTDATE_STARTTIME end as STARTDATE_STARTTIME,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.DS_STARTTIME else WORK_RSDVR_SCHEDULE_DEDUP.DS_STARTTIME_INCOMING end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.DS_STARTTIME end as DS_STARTTIME,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.LAST_UPDATED else WORK_RSDVR_SCHEDULE_DEDUP.LAST_UPDATED_INCOMING end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.LAST_UPDATED end as LAST_UPDATED,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.SHORTTITLE_IND else WORK_RSDVR_SCHEDULE_DEDUP.SHORTTITLE_IND end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.SHORTTITLE_IND end    AS SHORTTITLE_IND,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.LONGTITLE_IND else WORK_RSDVR_SCHEDULE_DEDUP.LONGTITLE_IND end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.LONGTITLE_IND end   AS LONGTITLE_IND,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.THEMEIDS_IND else WORK_RSDVR_SCHEDULE_DEDUP.THEMEIDS_IND end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.THEMEIDS_IND end     AS THEMEIDS_IND,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.SHORTDESC_IND else WORK_RSDVR_SCHEDULE_DEDUP.SHORTDESC_IND end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.SHORTDESC_IND end   AS SHORTDESC_IND,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.LONGDESC_IND else WORK_RSDVR_SCHEDULE_DEDUP.LONGDESC_IND end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.LONGDESC_IND end   AS LONGDESC_IND,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.MPAARATING_IND else WORK_RSDVR_SCHEDULE_DEDUP.MPAARATING_IND end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.MPAARATING_IND end    AS MPAARATING_IND,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.TVRATING_IND else WORK_RSDVR_SCHEDULE_DEDUP.TVRATING_IND end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.TVRATING_IND end    AS TVRATING_IND,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.STEREO_IND else WORK_RSDVR_SCHEDULE_DEDUP.STEREO_IND end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.STEREO_IND end   AS STEREO_IND,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.SURROUND_IND else WORK_RSDVR_SCHEDULE_DEDUP.SURROUND_IND end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.SURROUND_IND end  AS SURROUND_IND,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.SAP_IND else WORK_RSDVR_SCHEDULE_DEDUP.SAP_IND end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.SAP_IND end   AS SAP_IND,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.CLOSEDCAPTION_IND else WORK_RSDVR_SCHEDULE_DEDUP.CLOSEDCAPTION_IND end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.CLOSEDCAPTION_IND end   AS CLOSEDCAPTION_IND,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.ANIMATED_IND else WORK_RSDVR_SCHEDULE_DEDUP.ANIMATED_IND end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.ANIMATED_IND end    AS ANIMATED_IND,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.BLACKWHITE_IND else WORK_RSDVR_SCHEDULE_DEDUP.BLACKWHITE_IND end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.BLACKWHITE_IND end     AS BLACKWHITE_IND,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.RERUN_IND else WORK_RSDVR_SCHEDULE_DEDUP.RERUN_IND end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.RERUN_IND end      AS RERUN_IND,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.LIVE_IND else WORK_RSDVR_SCHEDULE_DEDUP.LIVE_IND end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.LIVE_IND end     AS LIVE_IND,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.ISMOVIE_IND else WORK_RSDVR_SCHEDULE_DEDUP.ISMOVIE_IND end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.ISMOVIE_IND end    AS ISMOVIE_IND,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.NUDITY_IND else WORK_RSDVR_SCHEDULE_DEDUP.NUDITY_IND end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.NUDITY_IND end    AS NUDITY_IND,
	case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.ADULTLANG_IND else WORK_RSDVR_SCHEDULE_DEDUP.ADULTLANG_IND end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.ADULTLANG_IND end   AS ADULTLANG_IND,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.VIOLENCE_IND else WORK_RSDVR_SCHEDULE_DEDUP.VIOLENCE_IND end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.VIOLENCE_IND end    AS VIOLENCE_IND,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.ADULTTHEME_IND else WORK_RSDVR_SCHEDULE_DEDUP.ADULTTHEME_IND end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.ADULTTHEME_IND end    AS ADULTTHEME_IND,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.HALFSTARS_IND else WORK_RSDVR_SCHEDULE_DEDUP.HALFSTARS_IND end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.HALFSTARS_IND end     AS HALFSTARS_IND,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.HDTV_IND else WORK_RSDVR_SCHEDULE_DEDUP.HDTV_IND end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.HDTV_IND end     AS HDTV_IND,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.CVCCALLSIGN_IND else WORK_RSDVR_SCHEDULE_DEDUP.CVCCALLSIGN_IND end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.CVCCALLSIGN_IND end    AS CVCCALLSIGN_IND,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG='TRUE' and WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG='FALSE' then WORK_RSDVR_SCHEDULE_DEDUP.OP_TYPE_U else WORK_RSDVR_SCHEDULE_DEDUP.OP_TYPE_I end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.OP_TYPE end as OP_TYPE,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL  then GOLD_RSDVR_SCHEDULE_LAST_REC.DTM_CREATED else (case when WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG='TRUE' then  WORK_RSDVR_SCHEDULE_DEDUP.DTM_SYSDATE else GOLD_RSDVR_SCHEDULE_LAST_REC.DTM_CREATED end) end )  else GOLD_RSDVR_SCHEDULE_LAST_REC.DTM_CREATED end  as DTM_CREATED,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.RSDVR_SCHEDULE_DELTA_SEQ else WORK_RSDVR_SCHEDULE_DEDUP.RSDVR_SCHEDULE_DELTA_SEQ end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.RSDVR_SCHEDULE_DELTA_SEQ end  AS RSDVR_SCHEDULE_DELTA_SEQ,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.DTM_LAST_MODIFIED else WORK_RSDVR_SCHEDULE_DEDUP.DTM_SYSDATE end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.DTM_LAST_MODIFIED end  as DTM_LAST_MODIFIED,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL  then GOLD_RSDVR_SCHEDULE_LAST_REC.DTM_LAST_UPDATED else (case when WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG !='TRUE' then WORK_RSDVR_SCHEDULE_DEDUP.DTM_SYSDATE end) end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.DTM_LAST_UPDATED end  as DTM_LAST_UPDATED,
    case when WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING is not null and WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING is not null then ( case when WORK_RSDVR_SCHEDULE_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_SCHEDULE_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_SCHEDULE_LAST_REC.LOAD_DATE else WORK_RSDVR_SCHEDULE_DEDUP.LOAD_DATE end ) else GOLD_RSDVR_SCHEDULE_LAST_REC.LOAD_DATE end  as LOAD_DATE
FROM
    ${hivevar:hive_database_name_gold}.${hivevar:gold_rsdvr_schedule_last_rec_tbl} GOLD_RSDVR_SCHEDULE_LAST_REC FULL OUTER JOIN ${hivevar:hive_database_name_work}.${hivevar:work_rsdvr_schedule_dedup_tbl} WORK_RSDVR_SCHEDULE_DEDUP
ON
      ( GOLD_RSDVR_SCHEDULE_LAST_REC.CALLSIGN = WORK_RSDVR_SCHEDULE_DEDUP.CALLSIGN_INCOMING AND
        GOLD_RSDVR_SCHEDULE_LAST_REC.STARTDATE = WORK_RSDVR_SCHEDULE_DEDUP.STARTDATE_INCOMING AND
        GOLD_RSDVR_SCHEDULE_LAST_REC.STARTTIME = WORK_RSDVR_SCHEDULE_DEDUP.STARTTIME_INCOMING AND
        GOLD_RSDVR_SCHEDULE_LAST_REC.DURATION = WORK_RSDVR_SCHEDULE_DEDUP.DURATION_INCOMING )
;

--##############################################################################
--#                                    End                                     #
--##############################################################################