--######################################################################################################################
--#   this source code is the property of:
--#   cablevision systems corporation, inc. (c) 2015
--#   1111 stewart avenue, bethpage, ny 11714
--#   www.cablevision.com
--#   department: am
--#
--#   program name: module-transform.hql
--#   program type: hive query language script
--#   purpose:    : build work_rsdvr_preferences_last_rec_tbl table 
--#   author(s)   : DataMetica Team
--#   usage       : beeline -u  <url> -n <username> -p <password> -hivevar var1=var1 -f module-transform.hql
--#   date        : 09/12/2016
--#   log file    : .../log/mrdvr/${job_name}.log
--#   sql file    : 
--#   error file  : .../log/mrdvr/${job_name}.log
--#   dependency  : 
--#   disclaimer  : 
--#
--#   modification history :
--#   =======================
--#
--#    ver     who                      date             comments
--#   ------   --------------------     ----------       -------------------------------------
--#    1.0     DataMetica Team          12/28/2015       initial version
--#
--#
--#####################################################################################################################

set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;

INSERT OVERWRITE TABLE ${hivevar:hive_database_name_gold}.${hivevar:gold_rsdvr_preferences_last_rec} 

SELECT 
	case when GOLD_RSDVR_PREFERENCES_LAST_REC.HOME_ID is null then WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING else GOLD_RSDVR_PREFERENCES_LAST_REC.HOME_ID end as HOME_ID,
	case when GOLD_RSDVR_PREFERENCES_LAST_REC.MAC_ADDRESS is null then WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING else GOLD_RSDVR_PREFERENCES_LAST_REC.MAC_ADDRESS end as MAC_ADDRESS,
	case when GOLD_RSDVR_PREFERENCES_LAST_REC.SERIAL_NUMBER is null then WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING else GOLD_RSDVR_PREFERENCES_LAST_REC.SERIAL_NUMBER end as SERIAL_NUMBER,
	case when GOLD_RSDVR_PREFERENCES_LAST_REC.SYST is null then WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING else GOLD_RSDVR_PREFERENCES_LAST_REC.SYST end as SYST,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.SORT_OPTION else WORK_RSDVR_PREFERENCES_DEDUP.SORT_OPTION_INCOMING end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.SORT_OPTION end as SORT_OPTION,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.SPACE_ALLOTED else WORK_RSDVR_PREFERENCES_DEDUP.SPACE_ALLOTED_INCOMING end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.SPACE_ALLOTED end as SPACE_ALLOTED,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.SPACE_USED else WORK_RSDVR_PREFERENCES_DEDUP.SPACE_USED_INCOMING end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.SPACE_USED end as SPACE_USED,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.AUTO_ERASE else WORK_RSDVR_PREFERENCES_DEDUP.AUTO_ERASE_INCOMING end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.AUTO_ERASE end as AUTO_ERASE,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.SAVE_DAYS else WORK_RSDVR_PREFERENCES_DEDUP.SAVE_DAYS_INCOMING end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.SAVE_DAYS end as SAVE_DAYS,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.NODE_ID else WORK_RSDVR_PREFERENCES_DEDUP.NODE_ID_INCOMING end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.NODE_ID end as NODE_ID,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.BLOCK_TITLES else WORK_RSDVR_PREFERENCES_DEDUP.BLOCK_TITLES_INCOMING end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.BLOCK_TITLES end as BLOCK_TITLES,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.STATUS else WORK_RSDVR_PREFERENCES_DEDUP.STATUS_INCOMING end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.STATUS end as STATUS,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.CREATE_TIME else WORK_RSDVR_PREFERENCES_DEDUP.CREATE_TIME_INCOMING end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.CREATE_TIME end as CREATE_TIME,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.STATUS_CHANGED else WORK_RSDVR_PREFERENCES_DEDUP.STATUS_CHANGED_INCOMING end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.STATUS_CHANGED end as STATUS_CHANGED,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.INGESTS_ALLOTED else WORK_RSDVR_PREFERENCES_DEDUP.INGESTS_ALLOTED_INCOMING end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.INGESTS_ALLOTED end as INGESTS_ALLOTED,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.VERSION1 else WORK_RSDVR_PREFERENCES_DEDUP.VERSION1_INCOMING end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.VERSION1 end as VERSION1,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.REC_PAST_FOLDERS else WORK_RSDVR_PREFERENCES_DEDUP.REC_PAST_FOLDERS_INCOMING end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.REC_PAST_FOLDERS end as REC_PAST_FOLDERS,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.REC_EPISODE_KEEP else WORK_RSDVR_PREFERENCES_DEDUP.REC_EPISODE_KEEP_INCOMING end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.REC_EPISODE_KEEP end as REC_EPISODE_KEEP,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.REC_EPISODE_QUALITY else WORK_RSDVR_PREFERENCES_DEDUP.REC_EPISODE_QUALITY_INCOMING end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.REC_EPISODE_QUALITY end as REC_EPISODE_QUALITY,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.REC_EPISODE_STOP else WORK_RSDVR_PREFERENCES_DEDUP.REC_EPISODE_STOP_INCOMING end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.REC_EPISODE_STOP end as REC_EPISODE_STOP,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.REC_SERIES_KEEP else WORK_RSDVR_PREFERENCES_DEDUP.REC_SERIES_KEEP_INCOMING end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.REC_SERIES_KEEP end as REC_SERIES_KEEP,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.REC_SERIES_QUALITY else WORK_RSDVR_PREFERENCES_DEDUP.REC_SERIES_QUALITY_INCOMING end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.REC_SERIES_QUALITY end as REC_SERIES_QUALITY,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.REC_SERIES_STOP else WORK_RSDVR_PREFERENCES_DEDUP.REC_SERIES_STOP_INCOMING end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.REC_SERIES_STOP end as REC_SERIES_STOP,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.REC_SERIES_SAVE_NUM_EP else WORK_RSDVR_PREFERENCES_DEDUP.REC_SERIES_SAVE_NUM_EP_INCOMING end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.REC_SERIES_SAVE_NUM_EP end as REC_SERIES_SAVE_NUM_EP,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.REC_SERIES_TYPE else WORK_RSDVR_PREFERENCES_DEDUP.REC_SERIES_TYPE_INCOMING end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.REC_SERIES_TYPE end as REC_SERIES_TYPE,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.RECORDER_ID else WORK_RSDVR_PREFERENCES_DEDUP.RECORDER_ID_INCOMING end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.RECORDER_ID end as RECORDER_ID,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.CREATED_BY else WORK_RSDVR_PREFERENCES_DEDUP.CREATED_BY_INCOMING end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.CREATED_BY end as CREATED_BY,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.MODIFY_TIME else WORK_RSDVR_PREFERENCES_DEDUP.MODIFY_TIME_INCOMING end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.MODIFY_TIME end as MODIFY_TIME,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.MODIFIED_BY else WORK_RSDVR_PREFERENCES_DEDUP.MODIFIED_BY_INCOMING end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.MODIFIED_BY end as MODIFIED_BY,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.LOADTIME else WORK_RSDVR_PREFERENCES_DEDUP.LOADTIME_INCOMING end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.LOADTIME end as LOADTIME,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.LAST_UPDATED else WORK_RSDVR_PREFERENCES_DEDUP.LAST_UPDATED_INCOMING end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.LAST_UPDATED end as LAST_UPDATED,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.SORT_OPTION_IND else WORK_RSDVR_PREFERENCES_DEDUP.SORT_OPTION_IND end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.SORT_OPTION_IND end as SORT_OPTION_IND,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.SPACE_ALLOTED_IND else WORK_RSDVR_PREFERENCES_DEDUP.SPACE_ALLOTED_IND end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.SPACE_ALLOTED_IND end as SPACE_ALLOTED_IND,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.SPACE_USED_IND else WORK_RSDVR_PREFERENCES_DEDUP.SPACE_USED_IND end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.SPACE_USED_IND end as SPACE_USED_IND,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.AUTO_ERASE_IND else WORK_RSDVR_PREFERENCES_DEDUP.AUTO_ERASE_IND end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.AUTO_ERASE_IND end as AUTO_ERASE_IND,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.SAVE_DAYS_IND else WORK_RSDVR_PREFERENCES_DEDUP.SAVE_DAYS_IND end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.SAVE_DAYS_IND end as SAVE_DAYS_IND ,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.NODE_ID_IND else WORK_RSDVR_PREFERENCES_DEDUP.NODE_ID_IND end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.NODE_ID_IND end as NODE_ID_IND,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.BLOCK_TITLES_IND else WORK_RSDVR_PREFERENCES_DEDUP.BLOCK_TITLES_IND end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.BLOCK_TITLES_IND end as BLOCK_TITLES_IND,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.STATUS_IND else WORK_RSDVR_PREFERENCES_DEDUP.STATUS_IND end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.STATUS_IND end as STATUS_IND,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.STATUS_CHANGED_IND else WORK_RSDVR_PREFERENCES_DEDUP.STATUS_CHANGED_IND end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.STATUS_CHANGED_IND end as STATUS_CHANGED_IND,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.INGESTS_ALLOTED_IND else WORK_RSDVR_PREFERENCES_DEDUP.INGESTS_ALLOTED_IND end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.INGESTS_ALLOTED_IND end as INGESTS_ALLOTED_IND,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.VERSION1_IND else WORK_RSDVR_PREFERENCES_DEDUP.VERSION1_IND end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.VERSION1_IND end as VERSION1_IND,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.REC_PAST_FOLDERS_IND else WORK_RSDVR_PREFERENCES_DEDUP.REC_PAST_FOLDERS_IND end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.REC_PAST_FOLDERS_IND end as REC_PAST_FOLDERS_IND,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.REC_EPISODE_KEEP_IND else WORK_RSDVR_PREFERENCES_DEDUP.REC_EPISODE_KEEP_IND end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.REC_EPISODE_KEEP_IND end as REC_EPISODE_KEEP_IND,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.REC_EPISODE_QUALITY_IND else WORK_RSDVR_PREFERENCES_DEDUP.REC_EPISODE_QUALITY_IND end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.REC_EPISODE_QUALITY_IND end as REC_EPISODE_QUALITY_IND,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.REC_EPISODE_STOP_IND else WORK_RSDVR_PREFERENCES_DEDUP.REC_EPISODE_STOP_IND end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.REC_EPISODE_STOP_IND end as REC_EPISODE_STOP_IND ,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.REC_SERIES_KEEP_IND else WORK_RSDVR_PREFERENCES_DEDUP.REC_SERIES_KEEP_IND end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.REC_SERIES_KEEP_IND end as REC_SERIES_KEEP_IND,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.REC_SERIES_QUALITY_IND else WORK_RSDVR_PREFERENCES_DEDUP.REC_SERIES_QUALITY_IND end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.REC_SERIES_QUALITY_IND end as REC_SERIES_QUALITY_IND,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.REC_SERIES_STOP_IND else WORK_RSDVR_PREFERENCES_DEDUP.REC_SERIES_STOP_IND end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.REC_SERIES_STOP_IND end as REC_SERIES_STOP_IND,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.REC_SERIES_SAVE_NUM_EP_IND else WORK_RSDVR_PREFERENCES_DEDUP.REC_SERIES_SAVE_NUM_EP_IND end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.REC_SERIES_SAVE_NUM_EP_IND end as REC_SERIES_SAVE_NUM_EP_IND,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.REC_SERIES_TYPE_IND else WORK_RSDVR_PREFERENCES_DEDUP.REC_SERIES_TYPE_IND end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.REC_SERIES_TYPE_IND end as REC_SERIES_TYPE_IND,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.RECORDER_ID_IND else WORK_RSDVR_PREFERENCES_DEDUP.RECORDER_ID_IND end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.RECORDER_ID_IND end as RECORDER_ID_IND ,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.CREATED_BY_IND else WORK_RSDVR_PREFERENCES_DEDUP.CREATED_BY_IND end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.CREATED_BY_IND end as CREATED_BY_IND,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.MODIFY_TIME_IND else WORK_RSDVR_PREFERENCES_DEDUP.MODIFY_TIME_IND end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.MODIFY_TIME_IND end as MODIFY_TIME_IND,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.MODIFIED_BY_IND else WORK_RSDVR_PREFERENCES_DEDUP.MODIFIED_BY_IND end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.MODIFIED_BY_IND end as MODIFIED_BY_IND,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.LAST_UPDATED_IND else WORK_RSDVR_PREFERENCES_DEDUP.LAST_UPDATED_IND end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.LAST_UPDATED_IND end as LAST_UPDATED_IND,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG='TRUE' AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG='FALSE' then WORK_RSDVR_PREFERENCES_DEDUP.OP_TYPE_U else WORK_RSDVR_PREFERENCES_DEDUP.OP_TYPE_I end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.OP_TYPE end as OP_TYPE,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.DTM_SYSDATE else WORK_RSDVR_PREFERENCES_DEDUP.DTM_SYSDATE end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.DTM_SYSDATE end as DTM_CREATED,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.RSDVR_PREFERENCES_DELTA_SEQ else WORK_RSDVR_PREFERENCES_DEDUP.RSDVR_PREFERENCES_DELTA_SEQ end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.RSDVR_PREFERENCES_DELTA_SEQ end as RSDVR_PREFERENCES_DELTA_SEQ,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.DTM_SYSDATE else WORK_RSDVR_PREFERENCES_DEDUP.DTM_SYSDATE end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.DTM_SYSDATE end as DTM_LAST_MODIFIED,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.DTM_SYSDATE else WORK_RSDVR_PREFERENCES_DEDUP.DTM_SYSDATE end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.DTM_SYSDATE end as DTM_LAST_UPDATED,
	case when WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING IS NOT NULL AND WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING IS NOT NULL then ( case when WORK_RSDVR_PREFERENCES_DEDUP.CHANGEDFLAG IS NULL AND WORK_RSDVR_PREFERENCES_DEDUP.NEWFLAG IS NULL then GOLD_RSDVR_PREFERENCES_LAST_REC.LOAD_DATE else WORK_RSDVR_PREFERENCES_DEDUP.LOAD_DATE end ) else GOLD_RSDVR_PREFERENCES_LAST_REC.LOAD_DATE end as LOAD_DATE
FROM 
	${hivevar:hive_database_name_gold}.${hivevar:gold_rsdvr_preferences_last_rec} GOLD_RSDVR_PREFERENCES_LAST_REC FULL OUTER JOIN ${hivevar:hive_database_name_work}.${hivevar:work_rsdvr_preferences_dedup} WORK_RSDVR_PREFERENCES_DEDUP 
ON
	(GOLD_RSDVR_PREFERENCES_LAST_REC.HOME_ID = WORK_RSDVR_PREFERENCES_DEDUP.HOME_ID_INCOMING AND
	GOLD_RSDVR_PREFERENCES_LAST_REC.MAC_ADDRESS = WORK_RSDVR_PREFERENCES_DEDUP.MAC_ADDRESS_INCOMING AND
	GOLD_RSDVR_PREFERENCES_LAST_REC.SERIAL_NUMBER = WORK_RSDVR_PREFERENCES_DEDUP.SERIAL_NUMBER_INCOMING AND
	GOLD_RSDVR_PREFERENCES_LAST_REC.SYST = WORK_RSDVR_PREFERENCES_DEDUP.SYST_INCOMING)
;

--##############################################################################
--#                                    End                                     #
--##############################################################################