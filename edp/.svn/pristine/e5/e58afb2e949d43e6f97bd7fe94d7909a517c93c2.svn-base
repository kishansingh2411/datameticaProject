--######################################################################################################################
--#   This source code is the property of:
--#   Cablevision Systems Corporation, Inc. (c) 2015
--#   1111 Stewart Avenue, Bethpage, NY 11714
--#   www.cablevision.com
--#   Department: AM
--#
--#   Program name: module-transform.hql
--#   Program type: Hive Query Language script
--#   Purpose:    : Build Gold table from Incoming table
--#   Author(s)   : DataMetica Team
--#   Usage       : beeline -u  <url> -n <username> -p <password> -hivevar var1=var1 -f module-transform.hql
--#   Date        : 12/28/2015
--#   Log File    : .../log/channel_tuning/
--#   SQL File    : 
--#   Error File  : .../log/channel_tuning/
--#   Dependency  : 
--#   Disclaimer  : 
--#
--#   Modification History :
--#   =======================
--#
--#    ver     who                      date             comments
--#   ------   --------------------     ----------       -------------------------------------
--#    1.0     DataMetica Team          12/28/2015       Initial version
--#
--#
--#####################################################################################################################

INSERT OVERWRITE 
   TABLE ${hivevar:target_hive_database}.${hivevar:target_table}
   SELECT
	 res_demographic_id ,
	 household_id ,
	 household_key2 ,
	 individual_id ,
	 as_of_year ,
	 quarter ,
	 global_address_id ,
	 occupancy_score ,
	 hf_status ,
	 person_type ,
	 customer_name ,
	 first_name ,
	 middle_init ,
	 last_name ,
	 suffix ,
	 cleansed_street_address1 ,
	 cleansed_street_address2 ,
	 cleansed_city ,
	 cleansed_state ,
	 cleansed_zip9 ,
	 c_customer_name ,
	 enhanced_est_income_v4 ,
	 fips_state_code ,
	 fips_county_code ,
	 census_tract ,
	 census_block_group ,
	 blockid ,
	 mcd_ccd_code ,
	 cbsa_code ,
	 lat_6_decimals ,
	 long_6_decimals ,
	 lev_lat_long ,
	 curr_est_med_fam ,
	 curr_st_est_fam_inc_indx ,
	 curr_st_est_fam_inc_dec ,
	 birthdate ,
	 combined_age ,
	 gendercode ,
	 firstname ,
	 middle_initial ,
	 suffix2 ,
	 marital_status1 ,
	 ethnic_insight_flag ,
	 ethnic_detail ,
	 language ,
	 religion ,
	 ethnic_groupcode ,
	 e_tech_group ,
	 county_of_origin ,
	 recipient_reliability ,
	 inds_household_stat ,
	 household_composition ,
	 deceased_indicator ,
	 y_owns_home ,
	 probable_homeowner ,
	 y_renter ,
	 y_probable_renter ,
	 dwelling_type ,
	 length_of_residence ,
	 dwelling_unitsize ,
	 confirmed_poc_model ,
	 number_of_children ,
	 poc_0_3_comb_type_gend ,
	 poc_4_6_comb_type_gend ,
	 poc_7_9_comb_type_gend ,
	 poc_10_12_comb_type_gend ,
	 poc_13_18_comb_type_gend ,
	 adults_in_house ,
	 mail_responder_indiv ,
	 multi_co_direct_mail_resp ,
	 multibuyer_mail_551_551 ,
	 gift_gadget_dm_merc_byr ,
	 col_spc_food_dm_merc_byr ,
	 books_dm_merc_byr ,
	 garden_farm_dm_merc_byr ,
	 craft_hobbie_dm_merc_byr ,
	 female_orient_dm_merc_byr ,
	 male_orient_dm_merc_byr ,
	 upscale_dm_merc_byr ,
	 general_dm_merc_byr ,
	 health_fitness_mag_byr ,
	 culinary_interest_mag_byr ,
	 garden_farming_mag_byr ,
	 religious_mag_byr ,
	 male_sport_orient_mag_byr ,
	 female_orient_mag_byr ,
	 family_general_mag_byr ,
	 general_contribtr ,
	 health_inst_contribtr ,
	 political_contribtr ,
	 religious_contribtr ,
	 sweepstakes ,
	 do_it_yourselfers ,
	 news_financial ,
	 photography ,
	 odds_ends_mail_resp ,
	 misc_mail_resp ,
	 occupation ,
	 occupation_group1 ,
	 education_individual1 ,
	 presence_of_childrencode ,
	 poc_0_3_yrs_old_confirm ,
	 poc_0_3_yrs_old_code ,
	 poc_4_6_yrs_old_confirm ,
	 poc_4_6_yrs_old_code ,
	 poc_7_9_yrs_old_confirm ,
	 poc_7_9_yrs_old_code ,
	 poc_10_12_yrs_old_confirm ,
	 poc_10_12_yrs_old_code ,
	 poc_13_18_yrs_old_confirm ,
	 poc_13_18_yrs_old_code ,
	 presence_of_child_age_0_3 ,
	 presence_of_child_age_4_6 ,
	 presence_of_child_age_7_9 ,
	 presence_of_child_age_10_12 ,
	 presence_of_child_age_13_15 ,
	 presence_of_child_age_16_18 ,
	 poc_0_3_yrs_old_gender ,
	 poc_4_6_yrs_old_gender ,
	 poc_7_9_yrs_old_gender ,
	 poc_10_12_yrs_old_gender ,
	 poc_13_15_yrs_old_gender ,
	 poc_16_18_yrs_old_gender ,
	 presence_of_child_age_0_18 ,
	 county_income_perc ,
	 national_income_perc ,
	 mail_pref_indicator ,
	 home_bus_indicator ,
	 bus_owner_flag ,
	 auto_market ,
	 state_est_income_indx ,
	 county_est_income_indx ,
	 est_curr_homevalue ,
	 county_echv_index ,
	 county_echv_perc ,
	 date_warranty_deed ,
	 purchase_amnt_ranges ,
	 type_purchase ,
	 mortgage_amnt_ranges ,
	 mortgage_rate_type ,
	 mortgage_term_months ,
	 mortgage_loan_type ,
	 year_built ,
	 est_equity ,
	 est_loan_value_model ,
	 est_monthly_mortgage_pmt ,
	 est_mortgage_amnt_model ,
	 mosaic_hh_z4 ,
	 mosaic_hh_z4_global ,
	 mosaic_global_z4 ,
	 mosaic_zip4 ,
	 presence_of_creditcard ,
	 interest_crafts ,
	 interest_gourmet_cooking ,
	 computers_peripherals ,
	 hi_tech_owner ,
	 internet_online_sub ,
	 interest_affluent_lifestyle ,
	 active_military ,
	 inactive_military ,
	 interest_golf ,
	 interest_golf_propcode ,
	 contributes_charities ,
	 interest_donor_propcode ,
	 pet_enthusiast ,
	 interest_pets_propcode ,
	 interest_cultural_arts ,  
	 interest_arts_propcode ,
	 purchased_through_mail ,
	 mail_order_buyer_propcode ,
	 interest_fitness ,
	 interest_fitness_propcode ,
	 interest_outdoors ,
	 interest_outdoor_propcode ,
	 interest_travel ,
	 interest_travel_propcode ,
	 investors ,
	 investor_propcode ,
	 presence_automobile ,
	 auto_owner_propcode ,
	 interest_gardening ,
	 interest_garden_propcode ,
	 collectors ,
	 collectors_propcode ,
	 cruise_enthusiasts ,
	 interest_cruise_propcode ,
	 interest_sports ,
	 interest_sports_propcode ,
	 sweepstakes_gambling ,
	 sweepstakes_gamble_propcode ,
	 interest_politics ,
	 interest_politics_propcode ,
	 interest_music ,
	 interest_music_propcode ,
	 interest_reading ,
	 interest_reader_propcode ,
	 child_parent_prod ,
	 child_parent_prod_propcode ,
	 do_it_yourself ,
	 do_it_yourself_propcode ,
	 self_improvement ,
	 self_improvement_propcode ,
	 interest_religion ,
	 interest_religion_propcode ,
	 grandparent ,
	 grandparent_propcode ,
	 interest_clothing ,
	 interest_clothing_propcode ,
	 donates_environment_causes ,
	 environment_cause_propcode ,
	 invests_mutual_funds_annuities ,
	 mut_funds_annuities_propcode ,
	 weight_conscious ,
	 weight_conscious_propcode ,
	 purchase_via_phone ,
	 purchase_via_phone_propcode ,
	 purchase_via_tv ,
	 purchase_via_tv_propcode ,
	 mail_order_multibuyer ,
	 mail_ord_multibuyer_propcode ,
	 pres_platinum_card_propcode ,
	 presence_premium_creditcard ,
	 dog_enthusiasts ,
	 dog_enthusiast_propcode ,
	 cat_enthusiasts ,
	 cat_enthusiast_propcode ,
	 healthy_living ,
	 healthy_living_propcode ,
	 interest_automotive ,
	 interest_auto_propcode ,
	 interest_skiing ,
	 interest_skiing_propcode ,
	 interest_astrology ,
	 interest_astrology_propcode ,
	 interest_boating ,
	 interest_boating_propcode ,
	 cell_phone ,
	 cell_phone_propcode ,
	 communications_connectivity ,
	 comm_connectivity_propcode ,
	 home_decorating_furnishing ,
	 home_decor_furnishing_propcode ,
	 home_entertainment_tv_video ,
	 home_entertain_tv_video_pcode ,
	 kitchen_aids_sm_appliances ,
	 kitchn_aids_sm_appl_propcode ,
	 mail_order_buyer_music_video ,
	 mob_music_video_propcode ,
	 mail_order_buyer_books_mags ,
	 mob_books_mags_propcode ,
	 mail_order_clothing_shoes ,
	 mob_clothing_shoes_propcode ,
	 mail_order_buyer_insur_finance ,
	 mob_insur_finance_propcode ,
	 mail_order_buyer_gifts ,
	 mob_gifts_propcode ,
	 mail_order_buyer_gardening ,
	 mob_gardening_propcode ,
	 mail_order_buyer_jewelery_cosm ,
	 mob_jewelery_cosmetic_propcode ,
	 classical_opera_big_band_music ,
	 class_op_big_band_mus_propcode ,
	 country_music ,
	 country_music_propcode ,
	 christian_music ,
	 christian_music_prop_code ,
	 oldies_music ,
	 oldies_music_propcode ,
	 rock_music ,
	 rock_music_prop_code ,
	 personal_care_beauty_care ,
	 pers_beauty_care_propcode ,
	 interest_in_photography ,
	 interest_in_photo_propcode ,
	 purchase_via_online ,
	 purchase_via_onlne_propcode ,
	 interest_in_tennis ,
	 interest_in_tennis_prop_code ,
	 domestic_traveler ,
	 intrst_domestic_travel_pcode ,
	 foreign_traveler ,
	 interest_foreign_travel_pcode ,
	 interest_in_volunteering ,
	 interest_volunteer_propcode ,
	 interest_in_videos_dvds ,
	 interest_in_vids_dvds_propcode ,
	 active_military_code ,
	 inactive_military_code ,
	 total_enhance_match_type ,
	 census_match_level ,
	 street_match_level ,
	 new_median_match_type ,
	 cen2000_match_level ,
	 dtm_created ,
	 dtm_last_updated ,
	 sourced_from_system ,
	 last_updated_by_system ,
	 home_stories ,
	 building_square_footage ,
	 exterior_wall ,
	 political_affiliation ,
	 political_persona ,
	 buy_american ,
	 show_me_the_money ,
	 go_with_the_flow ,
	 no_time_like_the_present ,
	 never_show_up_empty_handed ,
	 on_the_road_again ,
	 look_at_me_now ,
	 stop_and_smell_the_roses ,
	 work_hard_play_hard ,
	 a_penny_saved_a_penny_earned ,
	 its_all_in_the_name ,
	 direct_mkt_channel_receptivity ,
	 internet_advertis_receptivity ,
	 magazine_advertis_receptivity ,
	 newspaper_advertis_receptivity ,
	 radio_advertis_receptivity ,
	 tv_advertis_receptivity ,
	 auto_in_the_market_new ,
	 auto_in_the_market_used ,
	 consumerview_profitability ,
	 greenaware ,
	 hhld_cnsmr_exp_apparel ,
	 hhld_cnsmr_exp_shoes ,
	 hhld_cnsmr_exp_accessories ,
	 hhld_cnsmr_exp_toys ,
	 hhld_cnsmr_exp_furniture ,
	 hhld_cnsmr_exp_kitchen ,
	 hhld_cnsmr_exp_tabletop_dine ,
	 hhld_cnsmr_exp_food_bev ,
	 hhld_cnsmr_exp_home_office ,
	 hhld_cnsmr_exp_home_decor ,
	 hhld_cnsmr_exp_home_domestic ,
	 hhld_cnsmr_exp_home_maint ,
	 hhld_cnsmr_exp_outdoor_live ,
	 hhld_cnsmr_exp_lawn_garden ,
	 hhld_cnsmr_exp_electron_gadg ,
	 hhld_cnsmr_exp_computers ,
	 hhld_cnsmr_exp_pets ,
	 hhld_cnsmr_exp_hobbies_entain ,
	 hhld_cnsmr_exp_personal_health ,
	 hhld_cnsmr_exp_outdr_sft_good ,
	 hhld_cnsmr_exp_outdr_hrd_good ,
	 hhld_cnsmr_exp_travel ,
	 hhld_cnsmr_exp_seasonal_prod ,
	 hhld_cnsmr_exp_tools_auto ,
	 hhld_cnsmr_exp_general_misc ,
	 active_military_code_nonprop ,
	 inactive_military_code_nonprop ,
	 mosaic_hh ,
	 matched_cablevision_file_flag ,
	 new_original_name_flag ,
	 age_19_20_yrs_m ,
	 age_19_20_yrs_f ,
	 age_19_20_yrs_un ,
	 age_21_25_yrs_m ,
	 age_21_25_yrs_f ,
	 age_21_25_yrs_un ,
	 age_26_30_yrs_m ,
	 age_26_30_yrs_f ,
	 age_26_30_yrs_un ,
	 age_31_35_yrs_m ,
	 age_31_35_yrs_f ,
	 age_31_35_yrs_un ,
	 age_36_40_yrs_m ,
	 age_36_40_yrs_f ,
	 age_36_40_yrs_un ,
	 age_41_45_yrs_m ,
	 age_41_45_yrs_f ,
	 age_41_45_yrs_un ,
	 age_46_50_yrs_m ,
	 age_46_50_yrs_f ,
	 age_46_50_yrs_un ,
	 age_51_55_yrs_m ,
	 age_51_55_yrs_f ,
	 age_51_55_yrs_un ,
	 age_56_60_yrs_m ,
	 age_56_60_yrs_f ,
	 age_56_60_yrs_un ,
	 age_61_65_yrs_m ,
	 age_61_65_yrs_f ,
	 age_61_65_yrs_un ,
	 age_66_70_yrs_m ,
	 age_66_70_yrs_f ,
	 age_66_70_yrs_un ,
	 age_71_75_yrs_m ,
	 age_71_75_yrs_f ,
	 age_71_75_yrs_un ,
	 age_76_80_yrs_m ,
	 age_76_80_yrs_f ,
	 age_76_80_yrs_un ,
	 age_81_85_yrs_m ,
	 age_81_85_yrs_f ,
	 age_81_85_yrs_un ,
	 age_85_plus_yrs_m ,
	 age_85_plus_yrs_f ,
	 age_85_plus_yrs_un ,
	 unknown_age_grp_m ,
	 unknown_age_grp_f ,
	 unknown_age_grp_un ,
	 age_19_20_yrs ,
	 age_21_25_yrs ,
	 age_26_30_yrs ,
	 age_31_35_yrs ,
	 age_36_40_yrs ,
	 age_41_45_yrs ,
	 age_46_50_yrs ,
	 age_51_55_yrs ,
	 age_56_60_yrs ,
	 age_61_65_yrs ,
	 age_66_70_yrs ,
	 age_71_75_yrs ,
	 age_76_80_yrs ,
	 age_81_85_yrs ,
	 age_85_plus_yrs ,
	 unknown_age_grp
FROM 
	 ${hivevar:src_hive_database}.${hivevar:src_table}
;

--##############################################################################
--#                                    End                                     #
--##############################################################################