--######################################################################################################################
--#   This source code is the property of:
--#   Cablevision Systems Corporation, Inc. (c) 2015
--#   1111 Stewart Avenue, Bethpage, NY 11714
--#   www.cablevision.com
--#   Department: AM
--#
--#   Program name: module-transform.pig
--#   Program type: Pig script
--#   Purpose:    : Loading data from incoming_hit_data table to gold_unified_hit_data table
--#   Author(s)   : DataMetica Team
--#   Usage       : pig -p var1=var1 -useHCatalog module-transform.pig
--#   Date        : 12/28/2015
--#   Log File    : .../log/${suite_name}/${job_name}.log
--#   SQL File    : 
--#   Error File  : .../log/${suite_name}/${job_name}.log
--#   Dependency  : 
--#   Disclaimer  : 
--#
--#   Modification History :
--#   =======================
--#
--#    ver     who                      date             comments
--#   ------   --------------------     ----------       -------------------------------------
--#    1.0     DataMetica Team          12/28/2015       Initial version
--#
--#
--#####################################################################################################################
--#                                   Load                                     #
--##############################################################################

register ${udf_jar_path}/pig-udf-bank-${version}.jar;
define ResolvePluginId com.cablevision.edh.udf.ResolvePluginId();
define AssignHouseNumber com.cablevision.edh.udf.AssignHouseNumber();
set default_parallel 15;

incoming_hit_data = 
	LOAD '${hive_database_name_incoming}.${incoming_hit_data_tbl}' 
	USING org.apache.hive.hcatalog.pig.HCatLoader()
;
	   
incoming_browser = 
	LOAD '${hive_database_name_incoming}.${incoming_browser_tbl}' 
	USING org.apache.hive.hcatalog.pig.HCatLoader()
;
	
incoming_connection_type = 
	LOAD '${hive_database_name_incoming}.${incoming_connection_type_tbl}' 
	USING org.apache.hive.hcatalog.pig.HCatLoader()
;
	
incoming_country = 
	LOAD '${hive_database_name_incoming}.${incoming_country_tbl}' 
	USING org.apache.hive.hcatalog.pig.HCatLoader()
;
	
incoming_javascript_version = 
	LOAD '${hive_database_name_incoming}.${incoming_javascript_version_tbl}' 
	USING org.apache.hive.hcatalog.pig.HCatLoader()
;
	
incoming_languages = 
	LOAD '${hive_database_name_incoming}.${incoming_languages_tbl}' 
	USING org.apache.hive.hcatalog.pig.HCatLoader()
;
	
incoming_operating_systems = 
	LOAD '${hive_database_name_incoming}.${incoming_operating_systems_tbl}' 
	USING org.apache.hive.hcatalog.pig.HCatLoader()
;
	
incoming_plugins = 
	LOAD '${hive_database_name_incoming}.${incoming_plugins_tbl}' 
	USING org.apache.hive.hcatalog.pig.HCatLoader()
;
	
incoming_referrer_type = 
	LOAD '${hive_database_name_incoming}.${incoming_referrer_type_tbl}' 
	USING org.apache.hive.hcatalog.pig.HCatLoader()
;
	
incoming_search_engines = 
	LOAD '${hive_database_name_incoming}.${incoming_search_engines_tbl}' 
	USING org.apache.hive.hcatalog.pig.HCatLoader()
;

incoming_optimum_isp = 
    LOAD '${hive_database_name_incoming}.${incoming_optimum_isp_tbl}'
	USING org.apache.hive.hcatalog.pig.HCatLoader()
;
					
incoming_optimum_pagenames = 
    LOAD '${hive_database_name_incoming}.${incoming_optimum_pagenames_tbl}'
	USING org.apache.hive.hcatalog.pig.HCatLoader()
;
					
incoming_optimum_site_section = 
    LOAD '${hive_database_name_incoming}.${incoming_optimum_site_sections_tbl}'
	USING org.apache.hive.hcatalog.pig.HCatLoader()
;
   
incoming_optimum_error_message = 
    LOAD '${hive_database_name_incoming}.${incoming_optimum_error_message_tbl}'
	USING org.apache.hive.hcatalog.pig.HCatLoader()
;

incoming_ecr9_shopping_cart = 
	LOAD '${hive_database_name_incoming_ods}.${incoming_ecr9_shopping_cart_tbl}'
	USING org.apache.hive.hcatalog.pig.HCatLoader()
;

--##############################################################################
--#                                 Filter                                     #
--##############################################################################

incoming_hit_data_filter = 
	FILTER incoming_hit_data 
    BY (suite_name=='$suite_name' AND source_date == '$source_date' )
;
    
--Filter lookup data by suite_id   
incoming_browser_filter = 
	FILTER incoming_browser 
	BY  (suite_id=='$suite_id')
;
	
incoming_connection_type_filter = 
	FILTER incoming_connection_type 
	BY (suite_id=='$suite_id')
;
	
incoming_country_filter = 
	FILTER incoming_country
	BY (suite_id=='$suite_id')
;
	
incoming_javascript_version_filter = 
	FILTER incoming_javascript_version 
	BY (suite_id=='$suite_id')
;
	
incoming_languages_filter = 
	FILTER incoming_languages 
	BY (suite_id=='$suite_id')
;
	
incoming_operating_systems_filter = 
	FILTER incoming_operating_systems 
	BY (suite_id=='$suite_id')
;
	
incoming_plugins_filter = 
	FILTER incoming_plugins 
	BY (suite_id=='$suite_id')
;
	
incoming_referrer_type_filter = 
	FILTER incoming_referrer_type 
	BY (suite_id=='$suite_id')
;
	
incoming_search_engines_filter = 
	FILTER incoming_search_engines 
	BY (suite_id=='$suite_id')
;
	
incoming_optimum_isp_filter = 
	FILTER incoming_optimum_isp 
	BY (suite_id=='$suite_id')
;
	
incoming_optimum_pagenames_filter = 
	FILTER incoming_optimum_pagenames 
	BY (suite_id=='$suite_id')
;
	
incoming_optimum_site_section_filter  = 
	FILTER incoming_optimum_site_section 
	BY (suite_id=='$suite_id')
;  

incoming_optimum_error_message_filter  = 
	FILTER incoming_optimum_error_message 
	BY (suite_id=='$suite_id')
;

--##############################################################################
--#                                 Transform                                  #
--##############################################################################

SPLIT incoming_hit_data_filter 
	INTO hit_data_with_mandatory_records
   	IF (
   		browser is not null  
   		AND connection_type is not null  
   		AND date_time is not null 
   		AND TRIM(domain) is not null AND TRIM(domain) !='' 
        AND mobile_id is not null 
        AND os is not null  
        AND TRIM(page_url) is not null AND TRIM(page_url) !=''  
        AND TRIM(post_visid_high) is not null AND TRIM(post_visid_high) !='' 
        AND TRIM(post_visid_low) is not null AND TRIM(post_visid_low) !='' 
        AND ref_type is not null 
        AND search_engine is not null         
        AND visit_num is not null 
        AND visit_page_num is not null 
        ),
	hit_data_missing_mandatory_records OTHERWISE
;

-- commented part be uncommented when the cutoff date logic is fixed and we will get correct data with evar39 !=null
 
-- SPLIT hit_data_with_mandatory_records
--   INTO hit_data_business_records
--   IF(
--     source_date > '$cutoff_date'
--   ),
--   hit_data_other_resi_records OTHERWISE
-- ;

-- SPLIT hit_data_business_records
--   INTO hit_data_business_records_mandatory_records 
--      IF (
--       TRIM(evar39) is not null AND TRIM(evar39) !=''
--       AND TRIM(prop44) is not null AND TRIM(prop44) !=''
--       ),
-- hit_data_missing_business_mandatory_records OTHERWISE
-- ;

-- hit_data_missing_business_mandatory_records_fields =
--     FOREACH hit_data_missing_business_mandatory_records 
--     GENERATE 'Mandatory field missing' as error_description,
--	accept_language..
-- ;

 hit_data_invalid_records_mandatory_records = 
	FOREACH hit_data_missing_mandatory_records 
	GENERATE 'Mandatory field missing' as error_description,
	accept_language..
;
	
-- hit_data_invalid_records_mandatory_field = 	
--          UNION ONSCHEMA hit_data_invalid_records_mandatory_records,
--          hit_data_missing_business_mandatory_records_fields
-- ;
	
-- union_hit_data_resi_smb = 
--              UNION ONSCHEMA hit_data_business_records_mandatory_records,
--            hit_data_other_resi_records;
                                
-- SPLIT union_hit_data_resi_smb				  				
SPLIT hit_data_with_mandatory_records 
	INTO hit_data_valid_records
    IF (
    	(long)browser_height is not null 
        AND (long)browser_width is not null  
        AND (long)click_action_type is not null 
        AND (long)click_context_type is not null 
        AND (long)click_sourceid is not null 
        AND (long)color is not null 
        AND (biginteger)post_visid_high is not null 
        AND (biginteger)post_visid_low is not null
		),
	hit_data_invalid_records OTHERWISE
;
					      
hit_data_invalid_non_numeric_records = 
	FOREACH hit_data_invalid_records 
	GENERATE 'Contain non-numeric value' as  error_description,
	accept_language..
;
						         						         
-- union_error_records = 
--	UNION ONSCHEMA hit_data_invalid_records_mandatory_field,
--	hit_data_invalid_non_numeric_records
-- ;

union_error_records = 
	UNION ONSCHEMA hit_data_invalid_records_mandatory_records,
	hit_data_invalid_non_numeric_records
;

--##############################################################################
--#                                 Decrypt Data                               #
--##############################################################################	
	
hit_data_records = 
	FOREACH hit_data_valid_records 
	GENERATE
	   ..duplicate_purchase,
	   (pagename is null  OR TRIM(pagename) == '' ? evar1 : pagename )    AS evar1_pagename,
	   evar2..
;
	
--##############################################################################
--#         			Join with look-up                                      #
--##############################################################################
	
hit_data_records_join_browser = 
	JOIN hit_data_records BY browser LEFT, 
    incoming_browser_filter BY browser_id
    USING 'replicated'
;

hit_data_records_join_connection_type = 
	JOIN hit_data_records_join_browser BY connection_type LEFT, 
	incoming_connection_type_filter BY connection_type_id
	USING 'replicated'
;
									
hit_data_records_join_country = 
	JOIN hit_data_records_join_connection_type BY country LEFT,
    incoming_country_filter BY country_id
    USING 'replicated'
;
						
hit_data_records_join_javascript_version = 
	JOIN hit_data_records_join_country BY javascript LEFT,
    incoming_javascript_version_filter BY javascript_version_id
    USING 'replicated'
;
							   
hit_data_records_join_languages = 
	JOIN hit_data_records_join_javascript_version BY language LEFT,
    incoming_languages_filter BY language_id
    USING 'replicated'
;
						
hit_data_records_join_operating_systems = 
	JOIN hit_data_records_join_languages BY os LEFT,
	incoming_operating_systems_filter BY operating_system_id
	USING 'replicated'
;
						
hit_data_records_join_referrer_type = 
	JOIN hit_data_records_join_operating_systems BY ref_type LEFT,
    incoming_referrer_type_filter BY referrer_type_id
    USING 'replicated'
;	
						   
hit_data_records_join_search_engines = 
	JOIN hit_data_records_join_referrer_type BY search_engine LEFT,
	incoming_search_engines_filter BY search_engine_id
	USING 'replicated'
;

hit_data_records_join_isp = 
	JOIN hit_data_records_join_search_engines BY domain LEFT,
	incoming_optimum_isp_filter BY isp_name
	USING 'replicated'
;
	
hit_data_records_join_pagenames = 
	JOIN hit_data_records_join_isp BY evar1_pagename LEFT,
    incoming_optimum_pagenames_filter BY pagename
    USING 'replicated'
;
		
hit_data_records_join_site_section = 
	JOIN hit_data_records_join_pagenames BY channel LEFT,
	incoming_optimum_site_section_filter BY site_section_name
	USING 'replicated'
;

hit_data_records_join_error_message = 
	JOIN hit_data_records_join_site_section BY prop35 LEFT,
	incoming_optimum_error_message_filter BY opt_err_msg_desc
	USING 'replicated'
;
	
	
incoming_plugins_tuples = 
   FOREACH incoming_plugins_filter 
   GENERATE TOTUPLE(*) AS (plugin_recs:tuple())
;

incoming_plugins_tbl_filter_all = 
   GROUP incoming_plugins_tuples ALL
;

incoming_plugins_generate = 
   FOREACH incoming_plugins_tbl_filter_all 
   GENERATE TOBAG(*) AS plugin_rec_bag
;

hit_data_records_join_plugins = 
   FOREACH hit_data_records_join_error_message 
   GENERATE ..persistent_cookie,
              ResolvePluginId(plugins, incoming_plugins_generate.plugin_rec_bag) AS plugin_name,
              plugins..
;
	
generated_records = 
	FOREACH hit_data_records_join_plugins 
	GENERATE
        accept_language         AS accept_language,
		browser_height          AS browser_height,
        browser                 AS browser_id,
        hit_data_records_join_pagenames::hit_data_records_join_isp::hit_data_records_join_search_engines::hit_data_records_join_referrer_type::hit_data_records_join_operating_systems::hit_data_records_join_languages::hit_data_records_join_javascript_version::hit_data_records_join_country::hit_data_records_join_connection_type::hit_data_records_join_browser::incoming_browser_filter::browser_name AS browser_name,
		browser_width           AS browser_width,	
		c_color                 AS c_color,
		campaign                AS campaign,		
		click_action            AS click_action,
		click_action_type       AS click_action_type,
		click_context           AS click_context,
		click_context_type      AS click_context_type,
		click_sourceid          AS click_sourceid,
		click_tag               AS click_tag,
		code_ver                AS code_ver,
		color                   AS color,
		hit_data_records_join_pagenames::hit_data_records_join_isp::hit_data_records_join_search_engines::hit_data_records_join_referrer_type::hit_data_records_join_operating_systems::hit_data_records_join_languages::hit_data_records_join_javascript_version::hit_data_records_join_country::hit_data_records_join_connection_type::incoming_connection_type_filter::connection_type AS connection_type,
		hit_data_records_join_referrer_type::hit_data_records_join_operating_systems::hit_data_records_join_languages::hit_data_records_join_javascript_version::hit_data_records_join_country::hit_data_records_join_connection_type::hit_data_records_join_browser::hit_data_records::connection_type AS connection_type_id,
		cookies 				AS cookies,			
		country                 AS country_id,
		hit_data_records_join_pagenames::hit_data_records_join_isp::hit_data_records_join_search_engines::hit_data_records_join_referrer_type::hit_data_records_join_operating_systems::hit_data_records_join_languages::hit_data_records_join_javascript_version::hit_data_records_join_country::incoming_country_filter::country_name AS country_name,
		ct_connect_type         AS ct_connect_type,
		curr_factor             AS curr_factor,
		curr_rate               AS curr_rate,
		currency                AS currency,        
		cust_hit_time_gmt       AS cust_hit_time_gmt,
		cust_visid              AS cust_visid,				
		daily_visitor           AS daily_visitor,
		CurrentTime()           AS dtm_created,	
		duplicate_events        AS duplicate_events,
		duplicate_purchase      AS duplicate_purchase,		
		duplicated_from         AS duplicated_from,		
		evar1_pagename          AS evar1_pagename,
		evar10                  AS evar10_optimum_link,
		evar11                  AS evar11,
		evar12                  AS evar12_live_chat_click,
		evar13         			AS evar13,
		evar14         			AS evar14,
		evar15         			AS evar15,
		evar16         			AS evar16,  
		evar17         			AS evar17,
		evar18         			AS evar18,
		evar19         			AS evar19_site_language,
		evar2                   AS evar2_page_type,
		evar20         			AS evar20,
		evar21         			AS evar21,
		evar22         			AS evar22_form_id,
		evar23                  AS evar23,
		evar24                  AS evar24,
		evar25                  AS evar25,
		evar26                  AS evar26_external_campaign,
		evar27                  AS evar27,
		evar28         			AS evar28_live_call,
		(purchaseid is null OR TRIM(purchaseid) == '' ? evar29 : purchaseid)         AS evar29_purchaseid,		
		evar3                   AS evar3_campaign_stacking,
		evar30         			AS evar30,
		evar31         			AS evar31_lead_form_id,
		evar32         			AS evar32_order_flow_id,
		evar33         			AS evar33_checkout_id,
		evar34         			AS evar34,
		evar35         			AS evar35,
		(transactionid is null OR TRIM(transactionid) == '' ? evar36 : transactionid )           AS evar36_transactionid,
		evar37         			AS evar37,
		evar38         			AS evar38,
		evar39         			AS evar39_site_type,
		evar4                   AS evar4,
		evar40         			AS evar40,
		evar41         			AS evar41,
		evar42                  AS evar42,
		evar43                  AS evar43,
        evar44                  AS evar44,
        evar45         			AS evar45,
		evar46         			AS evar46,
		evar47         			AS evar47,
		evar48         			AS evar48,
		evar49         			AS evar49,
		evar5                   AS evar5,
		evar50         			AS evar50,
		evar51         			AS evar51,
		evar52        			AS evar52,
		evar53         			AS evar53,
		evar54         			AS evar54,
		evar55        			AS evar55,
		evar56         			AS evar56,
		evar57         			AS evar57,
		evar58         			AS evar58,
		evar59         			AS evar59,		
		evar6                   AS evar6,
		evar60         			AS evar60,
		evar61         			AS evar61,
		evar62         			AS evar62,
		evar63         			AS evar63,
		evar64         			AS evar64,
		evar65         			AS evar65,
		evar66         			AS evar66,
		evar67         			AS evar67,
		evar68         			AS evar68,
		evar69         			AS evar69,
		evar7                   AS evar7,
		evar70         			AS evar70,
		evar71         			AS evar71,
		evar72         			AS evar72,
		evar73         			AS evar73,
		evar74         			AS evar74,
		evar75         			AS evar75,
		evar8                   AS evar8_visitor_type,
		evar9                   AS evar9,
		event_list         		AS event_list,
		exclude_hit         	AS exclude_hit,
		first_hit_page_url      AS first_hit_page_url,
		first_hit_pagename      AS first_hit_pagename,		
		first_hit_referrer      AS first_hit_referrer,
		first_hit_time_gmt      AS first_hit_time_gmt,
		geo_city         		AS geo_city,
		geo_country         	AS geo_country,
		geo_dma                 AS geo_dma,
		geo_region              AS geo_region,
		geo_zip                 AS geo_zip,
		hier1                   AS hier1,
		hier2         			AS hier2,
		hier3         			AS hier3,
		hier4         			AS hier4,
		hier5         			AS hier5,
		hit_source              AS hit_source,
		hit_time_gmt         	AS hit_time_gmt,		
		hitid_high         		AS hitid_high,
		hitid_low         		AS hitid_low,		
		homepage         		AS homepage,
		hourly_visitor          AS hourly_visitor,		
		ip         				AS ip,          			
		ip2         			AS ip2,    
		hit_data_records_join_pagenames::hit_data_records_join_isp::incoming_optimum_isp_filter::isp_id AS isp_id,
		domain                  AS isp_name,
		j_jscript               AS j_jscript,
		java_enabled         	AS java_enabled,
		hit_data_records_join_pagenames::hit_data_records_join_isp::hit_data_records_join_search_engines::hit_data_records_join_referrer_type::hit_data_records_join_operating_systems::hit_data_records_join_languages::hit_data_records_join_javascript_version::incoming_javascript_version_filter::javascript_version AS javascript_version,
		javascript              AS javascript_version_id,		
		language                AS language_id,
		hit_data_records_join_pagenames::hit_data_records_join_isp::hit_data_records_join_search_engines::hit_data_records_join_referrer_type::hit_data_records_join_operating_systems::hit_data_records_join_languages::incoming_languages_filter::language_name AS language_name,		
		last_hit_time_gmt       AS last_hit_time_gmt,
		last_purchase_num       AS last_purchase_num,       
		last_purchase_time_gmt  AS last_purchase_time_gmt, 
		mobile_id         		AS mobile_id,
		monthly_visitor         AS monthly_visitor,
		mvvar1         			AS mvvar1,
		mvvar2         			AS mvvar2,          		
		mvvar3         			AS mvvar3,          		
		namespace         		AS namespace,
		new_visit               AS new_visit,
		os                      AS operating_system_id,
		hit_data_records_join_pagenames::hit_data_records_join_isp::hit_data_records_join_search_engines::hit_data_records_join_referrer_type::hit_data_records_join_operating_systems::incoming_operating_systems_filter::operating_system_name AS operating_system_name,		
		incoming_optimum_error_message_filter::opt_err_msg_id AS opt_err_msg_id,		
		p_plugins               AS p_plugins,
		page_event              AS page_event,
		page_event_var1         AS page_event_var1,         
		page_event_var2         AS page_event_var2,         
		page_event_var3         AS page_event_var3,		
		hit_data_records_join_pagenames::incoming_optimum_pagenames_filter::page_name_id AS page_name_id,
		page_type         		AS page_type,          	
		page_url         		AS page_url,       
		hit_data_records_join_site_section::hit_data_records_join_pagenames::hit_data_records_join_isp::hit_data_records_join_search_engines::hit_data_records_join_referrer_type::hit_data_records_join_operating_systems::hit_data_records_join_languages::hit_data_records_join_javascript_version::hit_data_records_join_country::hit_data_records_join_connection_type::hit_data_records_join_browser::hit_data_records::pagename AS pagename,   							
		paid_search         	AS paid_search,          
		partner_plugins         AS partner_plugins,         
		persistent_cookie       AS persistent_cookie,   
		plugin_name             AS plugin_name,
		plugins         		AS plugins,          	
		post_browser_height     AS post_browser_height,     
		post_browser_width      AS post_browser_width,      
		post_campaign         	AS 	post_campaign ,         
		post_channel         	AS 	post_channel,          
		post_cookies         	AS 	post_cookies,          
		post_currency         	AS 	post_currency,          
		post_cust_hit_time_gmt  AS post_cust_hit_time_gmt,  
		post_cust_visid         AS post_cust_visid,         
		post_evar1         		AS post_evar1,          	
		post_evar10         	AS post_evar10,          
		post_evar11         	AS post_evar11,          
		post_evar12         	AS post_evar12,          
		post_evar13         	AS post_evar13,          
		post_evar14         	AS post_evar14,          
		post_evar15         	AS post_evar15,          
		post_evar16         	AS post_evar16,          
		post_evar17         	AS post_evar17,          
		post_evar18         	AS post_evar18,          
		post_evar19         	AS post_evar19,
		post_evar2         		AS post_evar2, 
        post_evar20         	AS post_evar20,          
		post_evar21         	AS post_evar21,          
		post_evar22         	AS post_evar22,          
		post_evar23         	AS post_evar23,          
		post_evar24         	AS post_evar24,          
		post_evar25         	AS post_evar25,          
		post_evar26         	AS post_evar26,          
		post_evar27         	AS post_evar27,          
		post_evar28         	AS post_evar28,          
		post_evar29         	AS post_evar29,		
		post_evar3         		AS post_evar3,  
        post_evar30         	AS post_evar30,          
		post_evar31         	AS post_evar31,          
		post_evar32         	AS post_evar32,          
		post_evar33         	AS post_evar33,          
		post_evar34         	AS post_evar34,          
		post_evar35         	AS post_evar35,          
		post_evar36         	AS post_evar36,          
		post_evar37         	AS post_evar37,          
		post_evar38         	AS post_evar38,          
		post_evar39         	AS post_evar39,          		
		post_evar4         		AS post_evar4,
        post_evar40         	AS post_evar40,          
		post_evar41         	AS post_evar41,          
		post_evar42         	AS post_evar42,          
		post_evar43         	AS post_evar43,          
		post_evar44         	AS post_evar44,          
		post_evar45         	AS post_evar45,          
		post_evar46         	AS post_evar46,         
		post_evar47         	AS post_evar47,         
		post_evar48         	AS post_evar48,         
		post_evar49         	AS post_evar49,		
		post_evar5         		AS post_evar5,          	
		post_evar50         	AS post_evar50,         
		post_evar51         	AS post_evar51,         
		post_evar52         	AS post_evar52,         
		post_evar53         	AS post_evar53,         
		post_evar54         	AS post_evar54,         
		post_evar55         	AS post_evar55,         
		post_evar56         	AS post_evar56,         
		post_evar57         	AS post_evar57,         
		post_evar58         	AS post_evar58,         
		post_evar59        		AS post_evar59,     
		post_evar6         		AS post_evar6,          	
		post_evar60         	AS post_evar60,         
		post_evar61         	AS post_evar61,         
		post_evar62         	AS post_evar62,         
		post_evar63         	AS post_evar63,         
		post_evar64         	AS post_evar64,         
		post_evar65         	AS post_evar65,         
		post_evar66         	AS post_evar66,         
		post_evar67         	AS post_evar67,         
		post_evar68         	AS post_evar68,         
		post_evar69         	AS post_evar69,         
		post_evar7         		AS post_evar7,          	
		post_evar70         	AS post_evar70,         
		post_evar71         	AS post_evar71,         
		post_evar72        	 	AS post_evar72,         
		post_evar73         	AS post_evar73,         
		post_evar74         	AS post_evar74,         
		post_evar75         	AS post_evar75,         
		post_evar8         		AS post_evar8,          	
		post_evar9         		AS post_evar9,          	
		post_event_list         AS post_event_list,
		post_hier1         		AS post_hier1,
		post_hier2         		AS post_hier2,
		post_hier3         		AS post_hier3,
		post_hier4         		AS post_hier4,
		post_hier5         		AS post_hier5,
		post_java_enabled       AS post_java_enabled,
		post_keywords           AS post_keywords,
		post_mvvar1             AS post_mvvar1,
		post_mvvar2             AS post_mvvar2,
		post_mvvar3             AS post_mvvar3,
		post_page_event         AS post_page_event,
		post_page_event_var1    AS post_page_event_var1,
		post_page_event_var2    AS post_page_event_var2,
		post_page_event_var3    AS post_page_event_var3,
		post_page_type          AS post_page_type,
		post_page_url           AS post_page_url,
		post_pagename           AS post_pagename,
		post_pagename_no_url    AS post_pagename_no_url,		
		post_partner_plugins    AS post_partner_plugins,
		post_persistent_cookie  AS post_persistent_cookie,
		post_product_list       AS post_product_list,
		post_prop1         		AS post_prop1,
		post_prop10	         	AS post_prop10,
		post_prop11         	AS post_prop11,        
		post_prop12         	AS post_prop12,        
		post_prop13         	AS post_prop13,        
		post_prop14         	AS post_prop14,        
		post_prop15         	AS post_prop15,        
		post_prop16         	AS post_prop16,        
		post_prop17         	AS post_prop17,        
		post_prop18         	AS post_prop18,        
		post_prop19         	AS post_prop19,       
		post_prop2         		AS post_prop2,
		post_prop20         	AS post_prop20,        
		post_prop21         	AS post_prop21,        
		post_prop22         	AS post_prop22,        
		post_prop23         	AS post_prop23,        
		post_prop24         	AS post_prop24,        
		post_prop25         	AS post_prop25,        
		post_prop26         	AS post_prop26,        
		post_prop27         	AS post_prop27,        
		post_prop28         	AS post_prop28,        
		post_prop29         	AS post_prop29,        
		post_prop3         		AS post_prop3,
		post_prop30         	AS post_prop30,        
		post_prop31         	AS post_prop31,       
		post_prop32         	AS post_prop32,        
		post_prop33         	AS post_prop33,        
		post_prop34         	AS post_prop34,        
		post_prop35         	AS post_prop35,        
		post_prop36         	AS post_prop36,        
		post_prop37         	AS post_prop37,        
		post_prop38         	AS post_prop38,        
		post_prop39         	AS post_prop39,        
		post_prop4         		AS post_prop4,
		post_prop40         	AS post_prop40,        
		post_prop41         	AS post_prop41,        
		post_prop42         	AS post_prop42,        
		post_prop43         	AS post_prop43,        
		post_prop44         	AS post_prop44,        
		post_prop45         	AS post_prop45,        
		post_prop46         	AS post_prop46,        
		post_prop47         	AS post_prop47,        
		post_prop48         	AS post_prop48,        
		post_prop49         	AS post_prop49,        
		post_prop5         		AS post_prop5,
		post_prop50         	AS post_prop50,        
		post_prop51         	AS post_prop51,        
		post_prop52         	AS post_prop52,        
		post_prop53         	AS post_prop53,        
		post_prop54         	AS post_prop54,        
		post_prop55         	AS post_prop55,        
		post_prop56         	AS post_prop56,        
		post_prop57         	AS post_prop57,        
		post_prop58         	AS post_prop58,        
		post_prop59         	AS post_prop59,        
		post_prop6         		AS post_prop6,
		post_prop60         	AS post_prop60,        
		post_prop61         	AS post_prop61,        
		post_prop62         	AS post_prop62,        
		post_prop63         	AS post_prop63,        
		post_prop64         	AS post_prop64,       
		post_prop65         	AS post_prop65,        
		post_prop66        		AS post_prop66,    
		post_prop67         	AS post_prop67,        
		post_prop68         	AS post_prop68,        
		post_prop69         	AS post_prop69,
		post_prop7         		AS post_prop7,
		post_prop70         	AS post_prop70,        
		post_prop71         	AS post_prop71,        
		post_prop72         	AS post_prop72,        
		post_prop73         	AS post_prop73,        
		post_prop74         	AS post_prop74,        
		post_prop75         	AS post_prop75,        
		post_prop8        		AS post_prop8,
		post_prop9         		AS post_prop9,
		post_purchaseid         AS post_purchaseid,
		post_referrer         	AS post_referrer,
		post_search_engine      AS post_search_engine,      
		post_state         		AS post_state,      
		post_survey         	AS post_survey,
		post_t_time_info        AS post_t_time_info,
		post_tnt         		AS post_tnt,        
		post_transactionid      AS post_transactionid,      		        
		post_visid_high   		as post_visid_high ,
		post_visid_low  		as post_visid_low ,
		post_visid_type         AS post_visid_type,         
		post_zip         		AS post_zip,         		        
		prev_page         		AS prev_page,        
		product_list         	AS product_list,     
		product_merchandising   AS product_merchandising,
		prop1         			AS prop1,		
		prop10                  AS prop10_custom_link,
		prop11                  AS prop11,
		prop12         			AS prop12,
		prop13         			AS prop13,
		prop14         			AS prop14,
		prop15         			AS prop15,
		prop16         			AS prop16,
		prop17         			AS prop17,
		prop18         			AS prop18,
		prop19         			AS prop19,
		prop2         			AS prop2,
		prop20         			AS prop20,
		prop21         			AS prop21,
		prop22        			AS prop22,
		prop23        			AS prop23,
		prop24        			AS prop24,
		prop25                  AS prop25,
		prop26                  AS prop26,
		prop27        			AS prop27,
		prop28        			AS prop28,
		prop29        			AS prop29,
		prop3         			AS prop3,
		prop30        			AS prop30,
		prop31        			AS prop31,
		prop32        			AS prop32,
		prop33        			AS prop33,
		prop34        			AS prop34,		
		prop35                  AS prop35_opt_err_msg_desc,
		prop36                  AS prop36,
		prop37        			AS prop37,
		prop38        			AS prop38,
		prop39        			AS prop39,
		prop4         			AS prop4,
		prop40        			AS prop40,
		prop41        			AS prop41_lead_form_field,
		prop42        			AS prop42_order_form_field,
		prop43        			AS prop43_checkout_form_field,
		prop44        			AS prop44_site_type,
		prop45        			AS prop45_page_type,
		prop46        			AS prop46,
		prop47        			AS prop47,
		prop48        			AS prop48,
		prop49        			AS prop49,
		prop5         			AS prop5,
		prop50        			AS prop50,
		prop51        			AS prop51,
		prop52        			AS prop52,
		prop53        			AS prop53,
		prop54        			AS prop54,
		prop55        			AS prop55,
		prop56        			AS prop56,
		prop57        			AS prop57,
		prop58        			AS prop58,
		prop59        			AS prop59,
		prop6                   AS prop6,
		prop60        			AS prop60,
		prop61        			AS prop61,
		prop62        			AS prop62,
		prop63        			AS prop63,
		prop64        			AS prop64,
		prop65        			AS prop65,
		prop66        			AS prop66,
		prop67        			AS prop67,
		prop68        			AS prop68,
		prop69        			AS prop69,
		prop7                   AS prop7,
		prop70        			AS prop70,
		prop71        			AS prop71,
		prop72        			AS prop72,
		prop73        			AS prop73,
		prop74        			AS prop74,
		prop75        			AS prop75,
		prop8                   AS prop8,
		prop9         			AS prop9,				
		quarterly_visitor       AS quarterly_visitor,       
		ref_domain	            AS ref_domain,
		referrer                AS referrer,
		hit_data_records_join_pagenames::hit_data_records_join_isp::hit_data_records_join_search_engines::hit_data_records_join_referrer_type::incoming_referrer_type_filter::referrer_type_fullname AS   referrer_type_fullname,
		ref_type                AS referrer_type_id,
		hit_data_records_join_pagenames::hit_data_records_join_isp::hit_data_records_join_search_engines::hit_data_records_join_referrer_type::incoming_referrer_type_filter::referrer_type_shortname AS referrer_type_shortname,
        resolution              AS resolution,
		s_resolution         	AS s_resolution, 
		sampled_hit             AS sampled_hit,
		search_engine           AS search_engine_id,
		hit_data_records_join_pagenames::hit_data_records_join_isp::hit_data_records_join_search_engines::incoming_search_engines_filter::search_engine_name AS search_engine_name,
		search_page_num         AS search_page_num,
		secondary_hit  			AS secondary_hit,
		service         		AS service,         
		incoming_optimum_site_section_filter::site_section_id AS site_section_id, 
		channel                 AS site_section_name,
		'omniture'              AS sourced_from_system,
		sourceid         		AS sourceid,     		
		state         			AS state,        
		stats_server         	AS stats_server, 
		(int)${suite_id}               AS suite_id,
		t_time_info       		AS t_time_info,
		tnt         			AS tnt,
		tnt_post_vista          AS tnt_post_vista,          		           
		truncated_hit           AS truncated_hit,          		
		ua_color    			AS ua_color,
		ua_os         			AS ua_os,
		ua_pixels         		AS ua_pixels,
		user_agent         		AS user_agent,
		user_hash         		AS user_hash,
		user_server         	AS user_server,
		userid         			AS userid,
		username         		AS username,		
		va_closer_detail        AS va_closer_detail,
		va_closer_id            AS va_closer_id,
		va_finder_detail        AS va_finder_detail,
		va_finder_id            AS va_finder_id,
		va_instance_event       AS va_instance_event,
		va_new_engagement       AS va_new_engagement,
		visid_high         		AS visid_high,
		visid_low         		AS visid_low,
		visid_new         		AS visid_new,
		visid_timestamp	        AS visid_timestamp,
		visid_type         		AS visid_type,
		date_time               AS visit_date,
		visit_keywords          AS visit_keywords,
		visit_num         		AS visit_num,
		visit_page_num          AS visit_page_num,
		visit_referrer          AS visit_referrer,
		visit_search_engine     AS visit_search_engine,		
		visit_start_page_url    AS visit_start_page_url,
		visit_start_pagename    AS visit_start_pagename,
		visit_start_time_gmt    AS visit_start_time_gmt,
		weekly_visitor          AS weekly_visitor,
		yearly_visitor          AS yearly_visitor,
		zip         			AS zip
	    
;
   
SPLIT  generated_records
   INTO generated_records_evar1_pagename 
   IF ((evar39_site_type is null OR TRIM(evar39_site_type) == '') AND  (prop44_site_type is null OR TRIM(prop44_site_type) == '')),
   generated_records_evar39_prop44 OTHERWISE;
   
generated_records_evar39_prop44_records = FOREACH generated_records_evar39_prop44
                                       GENERATE ..zip,
                                       (evar39_site_type is null OR TRIM(evar39_site_type) == '' ? prop44_site_type : evar39_site_type)  AS  site_type
                                       ;
                                       
 generated_records_evar1_pagename_records = FOREACH generated_records_evar1_pagename 
                                         GENERATE ..zip,
                                         ( (evar1_pagename is not null and (evar1_pagename matches '.*business.*') ) ? 'SMB' : 'RESI') as site_type;
                                         
union_generate_records = UNION ONSCHEMA generated_records_evar39_prop44_records,
                          generated_records_evar1_pagename_records
                          ;         


split union_generate_records into
        hit_data_with_cart_id_records
		IF (evar36_transactionid is not null and evar36_transactionid != ''),
        hit_data_without_cart_id_records OTHERWISE;

incoming_shopping_cart_records = foreach incoming_ecr9_shopping_cart generate cart_id, corp, dwelling_nbr;

hit_data_join_shopping_cart_records = foreach (join incoming_shopping_cart_records by cart_id right outer, hit_data_with_cart_id_records by 
                                 SUBSTRING((chararray)evar36_transactionid, INDEXOF((chararray)evar36_transactionid, '_') + 1, 
                                 (int)SIZE(evar36_transactionid))) generate accept_language..site_type, SUBSTRING((chararray)evar36_transactionid, 
                                 INDEXOF((chararray)evar36_transactionid, '_') + 1, (int)SIZE(evar36_transactionid)) as cart_id, (corp is not null ? corp : '-1') as corp,
                                 (dwelling_nbr is not null ? dwelling_nbr : '-1') as dwelling_nbr;


split hit_data_join_shopping_cart_records into
	hit_data_found_corp_house_records
    IF (corp != '-1' and dwelling_nbr != '-1'),
    hit_data_missing_corp_house_records OTHERWISE;

hit_data_having_corp_house_records = foreach hit_data_found_corp_house_records generate
		hit_data_with_cart_id_records::accept_language         AS accept_language,
		  hit_data_with_cart_id_records::browser_height          AS browser_height,
		  hit_data_with_cart_id_records::browser_id                 AS browser_id,
		  hit_data_with_cart_id_records::browser_name AS browser_name,
		  hit_data_with_cart_id_records::browser_width           AS browser_width, 
		  hit_data_with_cart_id_records::c_color                 AS c_color,
		  hit_data_with_cart_id_records::campaign                AS campaign,  
		  hit_data_with_cart_id_records::click_action            AS click_action,
		  hit_data_with_cart_id_records::click_action_type       AS click_action_type,
		  hit_data_with_cart_id_records::click_context           AS click_context,
		  hit_data_with_cart_id_records::click_context_type      AS click_context_type,
		  hit_data_with_cart_id_records::click_sourceid          AS click_sourceid,
		  hit_data_with_cart_id_records::click_tag               AS click_tag,
		  hit_data_with_cart_id_records::code_ver                AS code_ver,
		  hit_data_with_cart_id_records::color                   AS color,
		  hit_data_with_cart_id_records::connection_type AS connection_type,
		  hit_data_with_cart_id_records::connection_type_id AS connection_type_id,
		  hit_data_with_cart_id_records::cookies     AS cookies,  
		  hit_data_with_cart_id_records::country_id                 AS country_id,
		  hit_data_with_cart_id_records::country_name AS country_name,
		  hit_data_with_cart_id_records::ct_connect_type         AS ct_connect_type,
		  hit_data_with_cart_id_records::curr_factor             AS curr_factor,
		  hit_data_with_cart_id_records::curr_rate               AS curr_rate,
		  hit_data_with_cart_id_records::currency                AS currency,        
		  hit_data_with_cart_id_records::cust_hit_time_gmt       AS cust_hit_time_gmt,
		  hit_data_with_cart_id_records::cust_visid              AS cust_visid,    
		  hit_data_with_cart_id_records::daily_visitor           AS daily_visitor,
		  hit_data_with_cart_id_records::dtm_created         AS dtm_created, 
		  hit_data_with_cart_id_records::duplicate_events        AS duplicate_events,
		  hit_data_with_cart_id_records::duplicate_purchase      AS duplicate_purchase,  
		  hit_data_with_cart_id_records::duplicated_from         AS duplicated_from,   
		  hit_data_with_cart_id_records::evar1_pagename          AS evar1_pagename,
		  hit_data_with_cart_id_records::evar10_optimum_link                  AS evar10_optimum_link,
		  hit_data_with_cart_id_records::evar11                  AS evar11,
		  hit_data_with_cart_id_records::evar12_live_chat_click                  AS evar12_live_chat_click,
		  hit_data_with_cart_id_records::evar13            AS evar13,
		  hit_data_with_cart_id_records::evar14            AS evar14,
		  hit_data_with_cart_id_records::evar15            AS evar15,
		  hit_data_with_cart_id_records::evar16            AS evar16,  
		  hit_data_with_cart_id_records::evar17            AS evar17,
		  hit_data_with_cart_id_records::evar18            AS evar18,
		  hit_data_with_cart_id_records::evar19_site_language            AS evar19_site_language,
		  hit_data_with_cart_id_records::evar2_page_type                   AS evar2_page_type,
		  hit_data_with_cart_id_records::evar20            AS evar20,
		  hit_data_with_cart_id_records::evar21            AS evar21,
		  hit_data_with_cart_id_records::evar22_form_id            AS evar22_form_id,
		  hit_data_with_cart_id_records::evar23                  AS evar23,
		  hit_data_with_cart_id_records::evar24                  AS evar24,
		  hit_data_with_cart_id_records::evar25                  AS evar25,
		  hit_data_with_cart_id_records::evar26_external_campaign                  AS evar26_external_campaign,
		  hit_data_with_cart_id_records::evar27                  AS evar27,
		  hit_data_with_cart_id_records::evar28_live_call            AS evar28_live_call,
		  hit_data_with_cart_id_records::evar29_purchaseid         AS evar29_purchaseid,  
		  hit_data_with_cart_id_records::evar3_campaign_stacking                   AS evar3_campaign_stacking,
		  hit_data_with_cart_id_records::evar30            AS evar30,
		  hit_data_with_cart_id_records::evar31_lead_form_id            AS evar31_lead_form_id,
		  hit_data_with_cart_id_records::evar32_order_flow_id            AS evar32_order_flow_id,
		  hit_data_with_cart_id_records::evar33_checkout_id            AS evar33_checkout_id,
		  hit_data_with_cart_id_records::evar34            AS evar34,
		  hit_data_with_cart_id_records::evar35            AS evar35,
		  hit_data_with_cart_id_records::evar36_transactionid          AS evar36_transactionid,
		  hit_data_with_cart_id_records::evar37            AS evar37,
		  hit_data_with_cart_id_records::evar38            AS evar38,
		  hit_data_with_cart_id_records::evar39_site_type            AS evar39_site_type,
		  hit_data_with_cart_id_records::evar4                   AS evar4,
		  hit_data_with_cart_id_records::evar40            AS evar40,
		  hit_data_with_cart_id_records::evar41            AS evar41,
		  hit_data_with_cart_id_records::evar42                  AS evar42,
		  hit_data_with_cart_id_records::evar43                  AS evar43,
		  hit_data_with_cart_id_records::evar44                  AS evar44,
		  hit_data_with_cart_id_records::evar45            AS evar45,
		  hit_data_with_cart_id_records::evar46            AS evar46,
		  hit_data_with_cart_id_records::evar47            AS evar47,
		  hit_data_with_cart_id_records::evar48            AS evar48,
		  hit_data_with_cart_id_records::evar49            AS evar49,
		  hit_data_with_cart_id_records::evar5                   AS evar5,
		  hit_data_with_cart_id_records::evar50            AS evar50,
		  hit_data_with_cart_id_records::evar51            AS evar51,
		  hit_data_with_cart_id_records::evar52           AS evar52,
		  hit_data_with_cart_id_records::evar53            AS evar53,
		  hit_data_with_cart_id_records::evar54            AS evar54,
		  hit_data_with_cart_id_records::evar55           AS evar55,
		  hit_data_with_cart_id_records::evar56            AS evar56,
		  hit_data_with_cart_id_records::evar57            AS evar57,
		  hit_data_with_cart_id_records::evar58            AS evar58,
		  hit_data_with_cart_id_records::evar59            AS evar59,  
		  hit_data_with_cart_id_records::evar6                   AS evar6,
		  hit_data_with_cart_id_records::evar60            AS evar60,
		  hit_data_with_cart_id_records::evar61            AS evar61,
		  hit_data_with_cart_id_records::evar62            AS evar62,
		  hit_data_with_cart_id_records::evar63            AS evar63,
		  hit_data_with_cart_id_records::evar64            AS evar64,
		  hit_data_with_cart_id_records::evar65            AS evar65,
		  hit_data_with_cart_id_records::evar66            AS evar66,
		  hit_data_with_cart_id_records::evar67            AS evar67,
		  hit_data_with_cart_id_records::evar68            AS evar68,
		  hit_data_with_cart_id_records::evar69            AS evar69,
		  hit_data_with_cart_id_records::evar7                   AS evar7,
		  hit_data_with_cart_id_records::evar70            AS evar70,
		  hit_data_with_cart_id_records::evar71            AS evar71,
		  hit_data_with_cart_id_records::evar72            AS evar72,
		  hit_data_with_cart_id_records::evar73            AS evar73,
		  hit_data_with_cart_id_records::evar74            AS evar74,
		  hit_data_with_cart_id_records::evar75            AS evar75,
		  hit_data_with_cart_id_records::evar8_visitor_type                   AS evar8_visitor_type,
		  hit_data_with_cart_id_records::evar9                   AS evar9,
		  hit_data_with_cart_id_records::event_list           AS event_list,
		  hit_data_with_cart_id_records::exclude_hit          AS exclude_hit,
		  hit_data_with_cart_id_records::first_hit_page_url      AS first_hit_page_url,
		  hit_data_with_cart_id_records::first_hit_pagename      AS first_hit_pagename,  
		  hit_data_with_cart_id_records::first_hit_referrer      AS first_hit_referrer,
		  hit_data_with_cart_id_records::first_hit_time_gmt      AS first_hit_time_gmt,
		  hit_data_with_cart_id_records::geo_city           AS geo_city,
		  hit_data_with_cart_id_records::geo_country          AS geo_country,
		  hit_data_with_cart_id_records::geo_dma                 AS geo_dma,
		  hit_data_with_cart_id_records::geo_region              AS geo_region,
		  hit_data_with_cart_id_records::geo_zip                 AS geo_zip,
		  hit_data_with_cart_id_records::hier1                   AS hier1,
		  hit_data_with_cart_id_records::hier2            AS hier2,
		  hit_data_with_cart_id_records::hier3            AS hier3,
		  hit_data_with_cart_id_records::hier4            AS hier4,
		  hit_data_with_cart_id_records::hier5            AS hier5,
		  hit_data_with_cart_id_records::hit_source              AS hit_source,
		  hit_data_with_cart_id_records::hit_time_gmt          AS hit_time_gmt,  
		  hit_data_with_cart_id_records::hitid_high           AS hitid_high,
		  hit_data_with_cart_id_records::hitid_low           AS hitid_low,  
		  hit_data_with_cart_id_records::homepage           AS homepage,
		  hit_data_with_cart_id_records::hourly_visitor          AS hourly_visitor,  
		  hit_data_with_cart_id_records::ip             AS ip,             
		  hit_data_with_cart_id_records::ip2            AS ip2,    
		  hit_data_with_cart_id_records::isp_id    AS isp_id,
		  hit_data_with_cart_id_records::isp_name                  AS isp_name,
		  hit_data_with_cart_id_records::j_jscript               AS j_jscript,
		  hit_data_with_cart_id_records::java_enabled          AS java_enabled,
		  hit_data_with_cart_id_records::javascript_version  AS javascript_version,
		  hit_data_with_cart_id_records::javascript_version_id              AS javascript_version_id,  
		  hit_data_with_cart_id_records::language_id                AS language_id,
		  hit_data_with_cart_id_records::language_name   AS language_name,  
		  hit_data_with_cart_id_records::last_hit_time_gmt       AS last_hit_time_gmt,
		  hit_data_with_cart_id_records::last_purchase_num       AS last_purchase_num,       
		  hit_data_with_cart_id_records::last_purchase_time_gmt  AS last_purchase_time_gmt, 
		  hit_data_with_cart_id_records::mobile_id           AS mobile_id,
		  hit_data_with_cart_id_records::monthly_visitor         AS monthly_visitor,
		  hit_data_with_cart_id_records::mvvar1            AS mvvar1,
		  hit_data_with_cart_id_records::mvvar2            AS mvvar2,            
		  hit_data_with_cart_id_records::mvvar3            AS mvvar3,            
		  hit_data_with_cart_id_records::namespace           AS namespace,
		  hit_data_with_cart_id_records::new_visit               AS new_visit,
		  hit_data_with_cart_id_records::operating_system_id                      AS operating_system_id,
		  hit_data_with_cart_id_records::operating_system_name AS operating_system_name,  
		  hit_data_with_cart_id_records::opt_err_msg_id         AS opt_err_msg_id,  
		  hit_data_with_cart_id_records::p_plugins               AS p_plugins,
		  hit_data_with_cart_id_records::page_event              AS page_event,
		  hit_data_with_cart_id_records::page_event_var1         AS page_event_var1,         
		  hit_data_with_cart_id_records::page_event_var2         AS page_event_var2,         
		  hit_data_with_cart_id_records::page_event_var3         AS page_event_var3,  
		  hit_data_with_cart_id_records::page_name_id   AS page_name_id,
		  hit_data_with_cart_id_records::page_type           AS page_type,           
		  hit_data_with_cart_id_records::page_url           AS page_url,       
		  hit_data_with_cart_id_records::pagename    AS pagename,          
		  hit_data_with_cart_id_records::paid_search          AS paid_search,          
		  hit_data_with_cart_id_records::partner_plugins         AS partner_plugins,         
		  hit_data_with_cart_id_records::persistent_cookie       AS persistent_cookie,   
		  hit_data_with_cart_id_records::plugin_name             AS plugin_name,
		  hit_data_with_cart_id_records::plugins           AS plugins,           
		  hit_data_with_cart_id_records::post_browser_height     AS post_browser_height,     
		  hit_data_with_cart_id_records::post_browser_width      AS post_browser_width,      
		  hit_data_with_cart_id_records::post_campaign          AS  post_campaign ,         
		  hit_data_with_cart_id_records::post_channel          AS  post_channel,          
		  hit_data_with_cart_id_records::post_cookies          AS  post_cookies,          
		  hit_data_with_cart_id_records::post_currency          AS  post_currency,          
		  hit_data_with_cart_id_records::post_cust_hit_time_gmt  AS post_cust_hit_time_gmt,  
		  hit_data_with_cart_id_records::post_cust_visid         AS post_cust_visid,         
		  hit_data_with_cart_id_records::post_evar1           AS post_evar1,           
		  hit_data_with_cart_id_records::post_evar10          AS post_evar10,          
		  hit_data_with_cart_id_records::post_evar11          AS post_evar11,          
		  hit_data_with_cart_id_records::post_evar12          AS post_evar12,          
		  hit_data_with_cart_id_records::post_evar13          AS post_evar13,          
		  hit_data_with_cart_id_records::post_evar14          AS post_evar14,          
		  hit_data_with_cart_id_records::post_evar15          AS post_evar15,          
		  hit_data_with_cart_id_records::post_evar16          AS post_evar16,          
		  hit_data_with_cart_id_records::post_evar17          AS post_evar17,          
		  hit_data_with_cart_id_records::post_evar18          AS post_evar18,          
		  hit_data_with_cart_id_records::post_evar19          AS post_evar19,
		  hit_data_with_cart_id_records::post_evar2           AS post_evar2, 
		  hit_data_with_cart_id_records::post_evar20          AS post_evar20,          
		  hit_data_with_cart_id_records::post_evar21          AS post_evar21,          
		  hit_data_with_cart_id_records::post_evar22          AS post_evar22,          
		  hit_data_with_cart_id_records::post_evar23          AS post_evar23,          
		  hit_data_with_cart_id_records::post_evar24          AS post_evar24,          
		  hit_data_with_cart_id_records::post_evar25          AS post_evar25,          
		  hit_data_with_cart_id_records::post_evar26          AS post_evar26,          
		  hit_data_with_cart_id_records::post_evar27          AS post_evar27,          
		  hit_data_with_cart_id_records::post_evar28          AS post_evar28,          
		  hit_data_with_cart_id_records::post_evar29          AS post_evar29,  
		  hit_data_with_cart_id_records::post_evar3           AS post_evar3,  
		          hit_data_with_cart_id_records::post_evar30          AS post_evar30,          
		  hit_data_with_cart_id_records::post_evar31          AS post_evar31,          
		  hit_data_with_cart_id_records::post_evar32          AS post_evar32,          
		  hit_data_with_cart_id_records::post_evar33          AS post_evar33,          
		  hit_data_with_cart_id_records::post_evar34          AS post_evar34,          
		  hit_data_with_cart_id_records::post_evar35          AS post_evar35,          
		  hit_data_with_cart_id_records::post_evar36          AS post_evar36,          
		  hit_data_with_cart_id_records::post_evar37          AS post_evar37,          
		  hit_data_with_cart_id_records::post_evar38          AS post_evar38,          
		  hit_data_with_cart_id_records::post_evar39          AS post_evar39,            
		  hit_data_with_cart_id_records::post_evar4           AS post_evar4,
		         hit_data_with_cart_id_records::post_evar40          AS post_evar40,          
		  hit_data_with_cart_id_records::post_evar41          AS post_evar41,          
		  hit_data_with_cart_id_records::post_evar42          AS post_evar42,          
		  hit_data_with_cart_id_records::post_evar43          AS post_evar43,          
		  hit_data_with_cart_id_records::post_evar44          AS post_evar44,          
		  hit_data_with_cart_id_records::post_evar45          AS post_evar45,          
		  hit_data_with_cart_id_records::post_evar46          AS post_evar46,         
		  hit_data_with_cart_id_records::post_evar47          AS post_evar47,         
		  hit_data_with_cart_id_records::post_evar48          AS post_evar48,         
		  hit_data_with_cart_id_records::post_evar49          AS post_evar49,  
		  hit_data_with_cart_id_records::post_evar5           AS post_evar5,           
		  hit_data_with_cart_id_records::post_evar50          AS post_evar50,         
		  hit_data_with_cart_id_records::post_evar51          AS post_evar51,         
		  hit_data_with_cart_id_records::post_evar52          AS post_evar52,         
		  hit_data_with_cart_id_records::post_evar53          AS post_evar53,         
		  hit_data_with_cart_id_records::post_evar54          AS post_evar54,         
		  hit_data_with_cart_id_records::post_evar55          AS post_evar55,         
		  hit_data_with_cart_id_records::post_evar56          AS post_evar56,         
		  hit_data_with_cart_id_records::post_evar57          AS post_evar57,         
		  hit_data_with_cart_id_records::post_evar58          AS post_evar58,         
		  hit_data_with_cart_id_records::post_evar59          AS post_evar59,     
		  hit_data_with_cart_id_records::post_evar6           AS post_evar6,           
		  hit_data_with_cart_id_records::post_evar60          AS post_evar60,         
		  hit_data_with_cart_id_records::post_evar61          AS post_evar61,         
		  hit_data_with_cart_id_records::post_evar62          AS post_evar62,         
		  hit_data_with_cart_id_records::post_evar63          AS post_evar63,         
		  hit_data_with_cart_id_records::post_evar64          AS post_evar64,         
		  hit_data_with_cart_id_records::post_evar65          AS post_evar65,         
		  hit_data_with_cart_id_records::post_evar66          AS post_evar66,         
		  hit_data_with_cart_id_records::post_evar67          AS post_evar67,         
		  hit_data_with_cart_id_records::post_evar68          AS post_evar68,         
		  hit_data_with_cart_id_records::post_evar69          AS post_evar69,         
		  hit_data_with_cart_id_records::post_evar7           AS post_evar7,           
		  hit_data_with_cart_id_records::post_evar70          AS post_evar70,         
		  hit_data_with_cart_id_records::post_evar71          AS post_evar71,         
		  hit_data_with_cart_id_records::post_evar72           AS post_evar72,         
		  hit_data_with_cart_id_records::post_evar73          AS post_evar73,         
		  hit_data_with_cart_id_records::post_evar74          AS post_evar74,         
		  hit_data_with_cart_id_records::post_evar75          AS post_evar75,         
		  hit_data_with_cart_id_records::post_evar8           AS post_evar8,           
		  hit_data_with_cart_id_records::post_evar9           AS post_evar9,           
		  hit_data_with_cart_id_records::post_event_list         AS post_event_list,
		  hit_data_with_cart_id_records::post_hier1           AS post_hier1,
		  hit_data_with_cart_id_records::post_hier2           AS post_hier2,
		  hit_data_with_cart_id_records::post_hier3           AS post_hier3,
		  hit_data_with_cart_id_records::post_hier4           AS post_hier4,
		  hit_data_with_cart_id_records::post_hier5           AS post_hier5,
		  hit_data_with_cart_id_records::post_java_enabled       AS post_java_enabled,
		  hit_data_with_cart_id_records::post_keywords           AS post_keywords,
		  hit_data_with_cart_id_records::post_mvvar1             AS post_mvvar1,
		  hit_data_with_cart_id_records::post_mvvar2             AS post_mvvar2,
		  hit_data_with_cart_id_records::post_mvvar3             AS post_mvvar3,
		  hit_data_with_cart_id_records::post_page_event         AS post_page_event,
		  hit_data_with_cart_id_records::post_page_event_var1    AS post_page_event_var1,
		  hit_data_with_cart_id_records::post_page_event_var2    AS post_page_event_var2,
		  hit_data_with_cart_id_records::post_page_event_var3    AS post_page_event_var3,
		  hit_data_with_cart_id_records::post_page_type          AS post_page_type,
		  hit_data_with_cart_id_records::post_page_url           AS post_page_url,
		  hit_data_with_cart_id_records::post_pagename           AS post_pagename,
		  hit_data_with_cart_id_records::post_pagename_no_url    AS post_pagename_no_url,  
		  hit_data_with_cart_id_records::post_partner_plugins    AS post_partner_plugins,
		  hit_data_with_cart_id_records::post_persistent_cookie  AS post_persistent_cookie,
		  hit_data_with_cart_id_records::post_product_list       AS post_product_list,
		  hit_data_with_cart_id_records::post_prop1           AS post_prop1,
		  hit_data_with_cart_id_records::post_prop10           AS post_prop10,
		  hit_data_with_cart_id_records::post_prop11          AS post_prop11,        
		  hit_data_with_cart_id_records::post_prop12          AS post_prop12,        
		  hit_data_with_cart_id_records::post_prop13          AS post_prop13,        
		  hit_data_with_cart_id_records::post_prop14          AS post_prop14,        
		  hit_data_with_cart_id_records::post_prop15          AS post_prop15,        
		  hit_data_with_cart_id_records::post_prop16          AS post_prop16,        
		  hit_data_with_cart_id_records::post_prop17          AS post_prop17,        
		  hit_data_with_cart_id_records::post_prop18          AS post_prop18,        
		  hit_data_with_cart_id_records::post_prop19          AS post_prop19,       
		  hit_data_with_cart_id_records::post_prop2           AS post_prop2,
		  hit_data_with_cart_id_records::post_prop20          AS post_prop20,        
		  hit_data_with_cart_id_records::post_prop21          AS post_prop21,        
		  hit_data_with_cart_id_records::post_prop22          AS post_prop22,        
		  hit_data_with_cart_id_records::post_prop23          AS post_prop23,        
		  hit_data_with_cart_id_records::post_prop24          AS post_prop24,        
		  hit_data_with_cart_id_records::post_prop25          AS post_prop25,        
		  hit_data_with_cart_id_records::post_prop26          AS post_prop26,        
		  hit_data_with_cart_id_records::post_prop27          AS post_prop27,        
		  hit_data_with_cart_id_records::post_prop28          AS post_prop28,        
		  hit_data_with_cart_id_records::post_prop29          AS post_prop29,        
		  hit_data_with_cart_id_records::post_prop3           AS post_prop3,
		  hit_data_with_cart_id_records::post_prop30          AS post_prop30,        
		  hit_data_with_cart_id_records::post_prop31          AS post_prop31,       
		  hit_data_with_cart_id_records::post_prop32          AS post_prop32,        
		  hit_data_with_cart_id_records::post_prop33          AS post_prop33,        
		  hit_data_with_cart_id_records::post_prop34          AS post_prop34,        
		  hit_data_with_cart_id_records::post_prop35          AS post_prop35,        
		  hit_data_with_cart_id_records::post_prop36          AS post_prop36,        
		  hit_data_with_cart_id_records::post_prop37          AS post_prop37,        
		  hit_data_with_cart_id_records::post_prop38          AS post_prop38,        
		  hit_data_with_cart_id_records::post_prop39          AS post_prop39,        
		  hit_data_with_cart_id_records::post_prop4           AS post_prop4,
		  hit_data_with_cart_id_records::post_prop40          AS post_prop40,        
		  hit_data_with_cart_id_records::post_prop41          AS post_prop41,        
		  hit_data_with_cart_id_records::post_prop42          AS post_prop42,        
		  hit_data_with_cart_id_records::post_prop43          AS post_prop43,        
		  hit_data_with_cart_id_records::post_prop44          AS post_prop44,        
		  hit_data_with_cart_id_records::post_prop45          AS post_prop45,        
		  hit_data_with_cart_id_records::post_prop46          AS post_prop46,        
		  hit_data_with_cart_id_records::post_prop47          AS post_prop47,        
		  hit_data_with_cart_id_records::post_prop48          AS post_prop48,        
		  hit_data_with_cart_id_records::post_prop49          AS post_prop49,        
		  hit_data_with_cart_id_records::post_prop5           AS post_prop5,
		  hit_data_with_cart_id_records::post_prop50          AS post_prop50,        
		  hit_data_with_cart_id_records::post_prop51          AS post_prop51,        
		  hit_data_with_cart_id_records::post_prop52          AS post_prop52,        
		  hit_data_with_cart_id_records::post_prop53          AS post_prop53,        
		  hit_data_with_cart_id_records::post_prop54          AS post_prop54,        
		  hit_data_with_cart_id_records::post_prop55          AS post_prop55,        
		  hit_data_with_cart_id_records::post_prop56          AS post_prop56,        
		  hit_data_with_cart_id_records::post_prop57          AS post_prop57,        
		  hit_data_with_cart_id_records::post_prop58          AS post_prop58,        
		  hit_data_with_cart_id_records::post_prop59          AS post_prop59,        
		  hit_data_with_cart_id_records::post_prop6           AS post_prop6,
		  hit_data_with_cart_id_records::post_prop60          AS post_prop60,        
		  hit_data_with_cart_id_records::post_prop61          AS post_prop61,        
		  hit_data_with_cart_id_records::post_prop62          AS post_prop62,        
		  hit_data_with_cart_id_records::post_prop63          AS post_prop63,        
		  hit_data_with_cart_id_records::post_prop64          AS post_prop64,       
		  hit_data_with_cart_id_records::post_prop65          AS post_prop65,        
		  hit_data_with_cart_id_records::post_prop66          AS post_prop66,    
		  hit_data_with_cart_id_records::post_prop67          AS post_prop67,        
		  hit_data_with_cart_id_records::post_prop68          AS post_prop68,        
		  hit_data_with_cart_id_records::post_prop69          AS post_prop69,
		  hit_data_with_cart_id_records::post_prop7           AS post_prop7,
		  hit_data_with_cart_id_records::post_prop70          AS post_prop70,        
		  hit_data_with_cart_id_records::post_prop71          AS post_prop71,        
		  hit_data_with_cart_id_records::post_prop72          AS post_prop72,        
		  hit_data_with_cart_id_records::post_prop73          AS post_prop73,        
		  hit_data_with_cart_id_records::post_prop74          AS post_prop74,        
		  hit_data_with_cart_id_records::post_prop75          AS post_prop75,        
		  hit_data_with_cart_id_records::post_prop8          AS post_prop8,
		  hit_data_with_cart_id_records::post_prop9           AS post_prop9,
		  hit_data_with_cart_id_records::post_purchaseid         AS post_purchaseid,
		  hit_data_with_cart_id_records::post_referrer          AS post_referrer,
		  hit_data_with_cart_id_records::post_search_engine      AS post_search_engine,      
		  hit_data_with_cart_id_records::post_state           AS post_state,      
		  hit_data_with_cart_id_records::post_survey          AS post_survey,
		  hit_data_with_cart_id_records::post_t_time_info        AS post_t_time_info,
		  hit_data_with_cart_id_records::post_tnt           AS post_tnt,        
		  hit_data_with_cart_id_records::post_transactionid      AS post_transactionid,                
		  hit_data_with_cart_id_records::post_visid_high     as post_visid_high ,
		  hit_data_with_cart_id_records::post_visid_low    as post_visid_low ,
		  hit_data_with_cart_id_records::post_visid_type         AS post_visid_type,         
		  hit_data_with_cart_id_records::post_zip           AS post_zip,                   
		  hit_data_with_cart_id_records::prev_page           AS prev_page,        
		  hit_data_with_cart_id_records::product_list          AS product_list,     
		  hit_data_with_cart_id_records::product_merchandising   AS product_merchandising,
		  hit_data_with_cart_id_records::prop1            AS prop1,  
		  hit_data_with_cart_id_records::prop10_custom_link                  AS prop10_custom_link,
		  hit_data_with_cart_id_records::prop11                  AS prop11,
		  hit_data_with_cart_id_records::prop12            AS prop12,
		  hit_data_with_cart_id_records::prop13            AS prop13,
		  hit_data_with_cart_id_records::prop14            AS prop14,
		  hit_data_with_cart_id_records::prop15            AS prop15,
		  hit_data_with_cart_id_records::prop16            AS prop16,
		  hit_data_with_cart_id_records::prop17            AS prop17,
		  hit_data_with_cart_id_records::prop18            AS prop18,
		  hit_data_with_cart_id_records::prop19            AS prop19,
		  hit_data_with_cart_id_records::prop2            AS prop2,
		  hit_data_with_cart_id_records::prop20            AS prop20,
		  hit_data_with_cart_id_records::prop21            AS prop21,
		  hit_data_with_cart_id_records::prop22           AS prop22,
		  hit_data_with_cart_id_records::prop23           AS prop23,
		  hit_data_with_cart_id_records::prop24           AS prop24,
		  hit_data_with_cart_id_records::prop25                  AS prop25,
		  hit_data_with_cart_id_records::prop26                  AS prop26,
		  hit_data_with_cart_id_records::prop27           AS prop27,
		  hit_data_with_cart_id_records::prop28           AS prop28,
		  hit_data_with_cart_id_records::prop29           AS prop29,
		  hit_data_with_cart_id_records::prop3            AS prop3,
		  hit_data_with_cart_id_records::prop30           AS prop30,
		  hit_data_with_cart_id_records::prop31           AS prop31,
		  hit_data_with_cart_id_records::prop32           AS prop32,
		  hit_data_with_cart_id_records::prop33           AS prop33,
		  hit_data_with_cart_id_records::prop34           AS prop34,  
		  hit_data_with_cart_id_records::prop35_opt_err_msg_desc                  AS prop35_opt_err_msg_desc,
		  hit_data_with_cart_id_records::prop36                  AS prop36,
		  hit_data_with_cart_id_records::prop37           AS prop37,
		  hit_data_with_cart_id_records::prop38           AS prop38,
		  hit_data_with_cart_id_records::prop39           AS prop39,
		  hit_data_with_cart_id_records::prop4            AS prop4,
		  hit_data_with_cart_id_records::prop40           AS prop40,
		hit_data_with_cart_id_records::prop41_lead_form_field      AS prop41_lead_form_field,
		hit_data_with_cart_id_records::prop42_order_form_field      AS prop42_order_form_field,
		hit_data_with_cart_id_records::prop43_checkout_form_field      AS prop43_checkout_form_field,
		 hit_data_with_cart_id_records::prop44_site_type      AS prop44_site_type,
		 hit_data_with_cart_id_records::prop45_page_type      AS prop45_page_type,
		  hit_data_with_cart_id_records::prop46           AS prop46,
		  hit_data_with_cart_id_records::prop47           AS prop47,
		  hit_data_with_cart_id_records::prop48           AS prop48,
		  hit_data_with_cart_id_records::prop49           AS prop49,
		  hit_data_with_cart_id_records::prop5            AS prop5,
		  hit_data_with_cart_id_records::prop50           AS prop50,
		  hit_data_with_cart_id_records::prop51           AS prop51,
		  hit_data_with_cart_id_records::prop52           AS prop52,
		  hit_data_with_cart_id_records::prop53           AS prop53,
		  hit_data_with_cart_id_records::prop54           AS prop54,
		  hit_data_with_cart_id_records::prop55           AS prop55,
		  hit_data_with_cart_id_records::prop56           AS prop56,
		  hit_data_with_cart_id_records::prop57           AS prop57,
		  hit_data_with_cart_id_records::prop58           AS prop58,
		  hit_data_with_cart_id_records::prop59           AS prop59,
		  hit_data_with_cart_id_records::prop6                     AS prop6,
		  hit_data_with_cart_id_records::prop60           AS prop60,
		  hit_data_with_cart_id_records::prop61           AS prop61,
		  hit_data_with_cart_id_records::prop62           AS prop62,
		  hit_data_with_cart_id_records::prop63           AS prop63,
		  hit_data_with_cart_id_records::prop64           AS prop64,
		  hit_data_with_cart_id_records::prop65           AS prop65,
		  hit_data_with_cart_id_records::prop66           AS prop66,
		  hit_data_with_cart_id_records::prop67           AS prop67,
		  hit_data_with_cart_id_records::prop68           AS prop68,
		  hit_data_with_cart_id_records::prop69           AS prop69,
		  hit_data_with_cart_id_records::prop7                     AS prop7,
		  hit_data_with_cart_id_records::prop70           AS prop70,
		  hit_data_with_cart_id_records::prop71           AS prop71,
		  hit_data_with_cart_id_records::prop72           AS prop72,
		  hit_data_with_cart_id_records::prop73           AS prop73,
		  hit_data_with_cart_id_records::prop74           AS prop74,
		  hit_data_with_cart_id_records::prop75           AS prop75,
		  hit_data_with_cart_id_records::prop8                    AS prop8,
		  hit_data_with_cart_id_records::prop9            AS prop9,    
		  hit_data_with_cart_id_records::quarterly_visitor       AS quarterly_visitor,       
		  hit_data_with_cart_id_records::ref_domain             AS ref_domain,
		  hit_data_with_cart_id_records::referrer                AS referrer,
		  hit_data_with_cart_id_records::referrer_type_fullname      AS   referrer_type_fullname,
		  hit_data_with_cart_id_records::referrer_type_id               AS referrer_type_id,
		  hit_data_with_cart_id_records::referrer_type_shortname     AS referrer_type_shortname,
		         hit_data_with_cart_id_records::resolution              AS resolution,
		  hit_data_with_cart_id_records::s_resolution          AS s_resolution, 
		  hit_data_with_cart_id_records::sampled_hit             AS sampled_hit,
		  hit_data_with_cart_id_records::search_engine_id           AS search_engine_id,
		  hit_data_with_cart_id_records::search_engine_name      AS search_engine_name,
		  hit_data_with_cart_id_records::search_page_num         AS search_page_num,
		  hit_data_with_cart_id_records::secondary_hit     AS secondary_hit,
		  hit_data_with_cart_id_records::service           AS service,         
		  hit_data_with_cart_id_records::site_section_id AS site_section_id, 
		  hit_data_with_cart_id_records::site_section_name                 AS site_section_name,
		  'omniture'              AS sourced_from_system,
		  hit_data_with_cart_id_records::sourceid           AS sourceid,       
		  hit_data_with_cart_id_records::state            AS state,        
		  hit_data_with_cart_id_records::stats_server          AS stats_server, 
		  hit_data_with_cart_id_records::suite_id                   AS suite_id,
		  hit_data_with_cart_id_records::t_time_info         AS t_time_info,
		  hit_data_with_cart_id_records::tnt            AS tnt,
		  hit_data_with_cart_id_records::tnt_post_vista          AS tnt_post_vista,                       
		  hit_data_with_cart_id_records::truncated_hit           AS truncated_hit,            
		  hit_data_with_cart_id_records::ua_color       AS ua_color,
		  hit_data_with_cart_id_records::ua_os            AS ua_os,
		  hit_data_with_cart_id_records::ua_pixels           AS ua_pixels,
		  hit_data_with_cart_id_records::user_agent           AS user_agent,
		  hit_data_with_cart_id_records::user_hash           AS user_hash,
		  hit_data_with_cart_id_records::user_server          AS user_server,
		  hit_data_with_cart_id_records::userid            AS userid,
		  hit_data_with_cart_id_records::username           AS username,  
		  hit_data_with_cart_id_records::va_closer_detail        AS va_closer_detail,
		  hit_data_with_cart_id_records::va_closer_id            AS va_closer_id,
		  hit_data_with_cart_id_records::va_finder_detail        AS va_finder_detail,
		  hit_data_with_cart_id_records::va_finder_id            AS va_finder_id,
		  hit_data_with_cart_id_records::va_instance_event       AS va_instance_event,
		  hit_data_with_cart_id_records::va_new_engagement       AS va_new_engagement,
		  hit_data_with_cart_id_records::visid_high           AS visid_high,
		  hit_data_with_cart_id_records::visid_low           AS visid_low,
		  hit_data_with_cart_id_records::visid_new           AS visid_new,
		  hit_data_with_cart_id_records::visid_timestamp         AS visid_timestamp,
		  hit_data_with_cart_id_records::visid_type           AS visid_type,
		  hit_data_with_cart_id_records::visit_date              AS visit_date,
		  hit_data_with_cart_id_records::visit_keywords          AS visit_keywords,
		  hit_data_with_cart_id_records::visit_num           AS visit_num,
		  hit_data_with_cart_id_records::visit_page_num          AS visit_page_num,
		  hit_data_with_cart_id_records::visit_referrer          AS visit_referrer,
		  hit_data_with_cart_id_records::visit_search_engine     AS visit_search_engine,  
		  hit_data_with_cart_id_records::visit_start_page_url    AS visit_start_page_url,
		  hit_data_with_cart_id_records::visit_start_pagename    AS visit_start_pagename,
		  hit_data_with_cart_id_records::visit_start_time_gmt    AS visit_start_time_gmt,
		  hit_data_with_cart_id_records::weekly_visitor          AS weekly_visitor,
		  hit_data_with_cart_id_records::yearly_visitor          AS yearly_visitor,
		  hit_data_with_cart_id_records::zip           AS zip,
		  hit_data_with_cart_id_records::site_type  AS site_type,
		  cart_id as cart_id,
		  (int) corp as corp,
		  dwelling_nbr as dwelling_nbr;


corp_house_count_visid_high_low_ip_records = foreach (group hit_data_having_corp_house_records by (post_visid_high, post_visid_low, ip)) {
	distinct_dwelling_nbr = distinct hit_data_having_corp_house_records.dwelling_nbr;		
	generate flatten(group) as (post_visid_high, post_visid_low, ip), COUNT(distinct_dwelling_nbr) as dwelling_nbr_count;
}

SPLIT corp_house_count_visid_high_low_ip_records into
				single_corp_house_visid_high_low_ip_records 
				IF (dwelling_nbr_count < 2),
				multiple_corp_house_visid_high_low_ip_records OTHERWISE;
				
single_corp_house_present_records = foreach (join hit_data_having_corp_house_records by (post_visid_high, post_visid_low, ip), single_corp_house_visid_high_low_ip_records by 
					(post_visid_high, post_visid_low, ip))
				 generate corp as corp, dwelling_nbr as dwelling_nbr, hit_data_having_corp_house_records::post_visid_high as post_visid_high, hit_data_having_corp_house_records::post_visid_low as  post_visid_low, hit_data_having_corp_house_records::ip as ip;

multiple_corp_house_records = foreach (join hit_data_having_corp_house_records by (post_visid_high, post_visid_low, ip), multiple_corp_house_visid_high_low_ip_records 			
	by (post_visid_high, post_visid_low, ip))
				 generate hit_data_having_corp_house_records::post_visid_high as post_visid_high, hit_data_having_corp_house_records::post_visid_low as post_visid_low, hit_data_having_corp_house_records::ip as ip;

-- dump multiple_corp_house_records;
                                  
distinct_single_corp_house_visid_high_low_ip_records = distinct single_corp_house_present_records;

distinct_visid_high_low_ip_multiple_house_records = distinct multiple_corp_house_records;

-- dump distinct_visid_high_low_ip_multiple_house_records;

joined_hit_data_with_corp_house = join hit_data_having_corp_house_records by (post_visid_high, post_visid_low, ip) left outer, distinct_visid_high_low_ip_multiple_house_records by 
		(post_visid_high, post_visid_low, ip);

split joined_hit_data_with_corp_house into
	hit_data_having_multiple_corp_house 
	IF (distinct_visid_high_low_ip_multiple_house_records::post_visid_high is not null),
  	hit_data_having_single_corp_house OTHERWISE;
	

hit_data_with_corp_house_single_records = foreach hit_data_having_single_corp_house generate 
hit_data_having_corp_house_records::accept_language         AS accept_language,
hit_data_having_corp_house_records::browser_height          AS browser_height,
hit_data_having_corp_house_records::browser_id                 AS browser_id,
hit_data_having_corp_house_records::browser_name AS browser_name,
hit_data_having_corp_house_records::browser_width           AS browser_width, 
hit_data_having_corp_house_records::c_color                 AS c_color,
hit_data_having_corp_house_records::campaign                AS campaign,  
hit_data_having_corp_house_records::click_action            AS click_action,
hit_data_having_corp_house_records::click_action_type       AS click_action_type,
hit_data_having_corp_house_records::click_context           AS click_context,
hit_data_having_corp_house_records::click_context_type      AS click_context_type,
hit_data_having_corp_house_records::click_sourceid          AS click_sourceid,
hit_data_having_corp_house_records::click_tag               AS click_tag,
hit_data_having_corp_house_records::code_ver                AS code_ver,
hit_data_having_corp_house_records::color                   AS color,
hit_data_having_corp_house_records::connection_type AS connection_type,
hit_data_having_corp_house_records::connection_type_id AS connection_type_id,
hit_data_having_corp_house_records::cookies     AS cookies,  
hit_data_having_corp_house_records::country_id                 AS country_id,
hit_data_having_corp_house_records::country_name AS country_name,
hit_data_having_corp_house_records::ct_connect_type         AS ct_connect_type,
hit_data_having_corp_house_records::curr_factor             AS curr_factor,
hit_data_having_corp_house_records::curr_rate               AS curr_rate,
hit_data_having_corp_house_records::currency                AS currency,        
hit_data_having_corp_house_records::cust_hit_time_gmt       AS cust_hit_time_gmt,
hit_data_having_corp_house_records::cust_visid              AS cust_visid,    
hit_data_having_corp_house_records::daily_visitor           AS daily_visitor,
hit_data_having_corp_house_records::dtm_created         AS dtm_created, 
hit_data_having_corp_house_records::duplicate_events        AS duplicate_events,
hit_data_having_corp_house_records::duplicate_purchase      AS duplicate_purchase,  
hit_data_having_corp_house_records::duplicated_from         AS duplicated_from,   
hit_data_having_corp_house_records::evar1_pagename          AS evar1_pagename,
hit_data_having_corp_house_records::evar10_optimum_link                  AS evar10_optimum_link,
hit_data_having_corp_house_records::evar11                  AS evar11,
hit_data_having_corp_house_records::evar12_live_chat_click                  AS evar12_live_chat_click,
hit_data_having_corp_house_records::evar13            AS evar13,
hit_data_having_corp_house_records::evar14            AS evar14,
hit_data_having_corp_house_records::evar15            AS evar15,
hit_data_having_corp_house_records::evar16            AS evar16,  
hit_data_having_corp_house_records::evar17            AS evar17,
hit_data_having_corp_house_records::evar18            AS evar18,
hit_data_having_corp_house_records::evar19_site_language            AS evar19_site_language,
hit_data_having_corp_house_records::evar2_page_type                   AS evar2_page_type,
hit_data_having_corp_house_records::evar20            AS evar20,
hit_data_having_corp_house_records::evar21            AS evar21,
hit_data_having_corp_house_records::evar22_form_id            AS evar22_form_id,
hit_data_having_corp_house_records::evar23                  AS evar23,
hit_data_having_corp_house_records::evar24                  AS evar24,
hit_data_having_corp_house_records::evar25                  AS evar25,
hit_data_having_corp_house_records::evar26_external_campaign                  AS evar26_external_campaign,
hit_data_having_corp_house_records::evar27                  AS evar27,
hit_data_having_corp_house_records::evar28_live_call            AS evar28_live_call,
hit_data_having_corp_house_records::evar29_purchaseid         AS evar29_purchaseid,  
hit_data_having_corp_house_records::evar3_campaign_stacking                   AS evar3_campaign_stacking,
hit_data_having_corp_house_records::evar30            AS evar30,
hit_data_having_corp_house_records::evar31_lead_form_id            AS evar31_lead_form_id,
hit_data_having_corp_house_records::evar32_order_flow_id            AS evar32_order_flow_id,
hit_data_having_corp_house_records::evar33_checkout_id            AS evar33_checkout_id,
hit_data_having_corp_house_records::evar34            AS evar34,
hit_data_having_corp_house_records::evar35            AS evar35,
hit_data_having_corp_house_records::evar36_transactionid          AS evar36_transactionid,
hit_data_having_corp_house_records::evar37            AS evar37,
hit_data_having_corp_house_records::evar38            AS evar38,
hit_data_having_corp_house_records::evar39_site_type            AS evar39_site_type,
hit_data_having_corp_house_records::evar4                   AS evar4,
hit_data_having_corp_house_records::evar40            AS evar40,
hit_data_having_corp_house_records::evar41            AS evar41,
hit_data_having_corp_house_records::evar42                  AS evar42,
hit_data_having_corp_house_records::evar43                  AS evar43,
hit_data_having_corp_house_records::evar44                  AS evar44,
hit_data_having_corp_house_records::evar45            AS evar45,
hit_data_having_corp_house_records::evar46            AS evar46,
hit_data_having_corp_house_records::evar47            AS evar47,
hit_data_having_corp_house_records::evar48            AS evar48,
hit_data_having_corp_house_records::evar49            AS evar49,
hit_data_having_corp_house_records::evar5                   AS evar5,
hit_data_having_corp_house_records::evar50            AS evar50,
hit_data_having_corp_house_records::evar51            AS evar51,
hit_data_having_corp_house_records::evar52           AS evar52,
hit_data_having_corp_house_records::evar53            AS evar53,
hit_data_having_corp_house_records::evar54            AS evar54,
hit_data_having_corp_house_records::evar55           AS evar55,
hit_data_having_corp_house_records::evar56            AS evar56,
hit_data_having_corp_house_records::evar57            AS evar57,
hit_data_having_corp_house_records::evar58            AS evar58,
hit_data_having_corp_house_records::evar59            AS evar59,  
hit_data_having_corp_house_records::evar6                   AS evar6,
hit_data_having_corp_house_records::evar60            AS evar60,
hit_data_having_corp_house_records::evar61            AS evar61,
hit_data_having_corp_house_records::evar62            AS evar62,
hit_data_having_corp_house_records::evar63            AS evar63,
hit_data_having_corp_house_records::evar64            AS evar64,
hit_data_having_corp_house_records::evar65            AS evar65,
hit_data_having_corp_house_records::evar66            AS evar66,
hit_data_having_corp_house_records::evar67            AS evar67,
hit_data_having_corp_house_records::evar68            AS evar68,
hit_data_having_corp_house_records::evar69            AS evar69,
hit_data_having_corp_house_records::evar7                   AS evar7,
hit_data_having_corp_house_records::evar70            AS evar70,
hit_data_having_corp_house_records::evar71            AS evar71,
hit_data_having_corp_house_records::evar72            AS evar72,
hit_data_having_corp_house_records::evar73            AS evar73,
hit_data_having_corp_house_records::evar74            AS evar74,
hit_data_having_corp_house_records::evar75            AS evar75,
hit_data_having_corp_house_records::evar8_visitor_type                   AS evar8_visitor_type,
hit_data_having_corp_house_records::evar9                   AS evar9,
hit_data_having_corp_house_records::event_list           AS event_list,
hit_data_having_corp_house_records::exclude_hit          AS exclude_hit,
hit_data_having_corp_house_records::first_hit_page_url      AS first_hit_page_url,
hit_data_having_corp_house_records::first_hit_pagename      AS first_hit_pagename,  
hit_data_having_corp_house_records::first_hit_referrer      AS first_hit_referrer,
hit_data_having_corp_house_records::first_hit_time_gmt      AS first_hit_time_gmt,
hit_data_having_corp_house_records::geo_city           AS geo_city,
hit_data_having_corp_house_records::geo_country          AS geo_country,
hit_data_having_corp_house_records::geo_dma                 AS geo_dma,
hit_data_having_corp_house_records::geo_region              AS geo_region,
hit_data_having_corp_house_records::geo_zip                 AS geo_zip,
hit_data_having_corp_house_records::hier1                   AS hier1,
hit_data_having_corp_house_records::hier2            AS hier2,
hit_data_having_corp_house_records::hier3            AS hier3,
hit_data_having_corp_house_records::hier4            AS hier4,
hit_data_having_corp_house_records::hier5            AS hier5,
hit_data_having_corp_house_records::hit_source              AS hit_source,
hit_data_having_corp_house_records::hit_time_gmt          AS hit_time_gmt,  
hit_data_having_corp_house_records::hitid_high           AS hitid_high,
hit_data_having_corp_house_records::hitid_low           AS hitid_low,  
hit_data_having_corp_house_records::homepage           AS homepage,
hit_data_having_corp_house_records::hourly_visitor          AS hourly_visitor,  
hit_data_having_corp_house_records::ip             AS ip,             
hit_data_having_corp_house_records::ip2            AS ip2,    
hit_data_having_corp_house_records::isp_id    AS isp_id,
hit_data_having_corp_house_records::isp_name                  AS isp_name,
hit_data_having_corp_house_records::j_jscript               AS j_jscript,
hit_data_having_corp_house_records::java_enabled          AS java_enabled,
hit_data_having_corp_house_records::javascript_version  AS javascript_version,
hit_data_having_corp_house_records::javascript_version_id              AS javascript_version_id,  
hit_data_having_corp_house_records::language_id                AS language_id,
hit_data_having_corp_house_records::language_name   AS language_name,  
hit_data_having_corp_house_records::last_hit_time_gmt       AS last_hit_time_gmt,
hit_data_having_corp_house_records::last_purchase_num       AS last_purchase_num,       
hit_data_having_corp_house_records::last_purchase_time_gmt  AS last_purchase_time_gmt, 
hit_data_having_corp_house_records::mobile_id           AS mobile_id,
hit_data_having_corp_house_records::monthly_visitor         AS monthly_visitor,
hit_data_having_corp_house_records::mvvar1            AS mvvar1,
hit_data_having_corp_house_records::mvvar2            AS mvvar2,            
hit_data_having_corp_house_records::mvvar3            AS mvvar3,            
hit_data_having_corp_house_records::namespace           AS namespace,
hit_data_having_corp_house_records::new_visit               AS new_visit,
hit_data_having_corp_house_records::operating_system_id                      AS operating_system_id,
hit_data_having_corp_house_records::operating_system_name AS operating_system_name,  
hit_data_having_corp_house_records::opt_err_msg_id         AS opt_err_msg_id,  
hit_data_having_corp_house_records::p_plugins               AS p_plugins,
hit_data_having_corp_house_records::page_event              AS page_event,
hit_data_having_corp_house_records::page_event_var1         AS page_event_var1,         
hit_data_having_corp_house_records::page_event_var2         AS page_event_var2,         
hit_data_having_corp_house_records::page_event_var3         AS page_event_var3,  
hit_data_having_corp_house_records::page_name_id   AS page_name_id,
hit_data_having_corp_house_records::page_type           AS page_type,           
hit_data_having_corp_house_records::page_url           AS page_url,       
hit_data_having_corp_house_records::pagename    AS pagename,          
hit_data_having_corp_house_records::paid_search          AS paid_search,          
hit_data_having_corp_house_records::partner_plugins         AS partner_plugins,         
hit_data_having_corp_house_records::persistent_cookie       AS persistent_cookie,   
hit_data_having_corp_house_records::plugin_name             AS plugin_name,
hit_data_having_corp_house_records::plugins           AS plugins,           
hit_data_having_corp_house_records::post_browser_height     AS post_browser_height,     
hit_data_having_corp_house_records::post_browser_width      AS post_browser_width,      
hit_data_having_corp_house_records::post_campaign          AS  post_campaign ,         
hit_data_having_corp_house_records::post_channel          AS  post_channel,          
hit_data_having_corp_house_records::post_cookies          AS  post_cookies,          
hit_data_having_corp_house_records::post_currency          AS  post_currency,          
hit_data_having_corp_house_records::post_cust_hit_time_gmt  AS post_cust_hit_time_gmt,  
hit_data_having_corp_house_records::post_cust_visid         AS post_cust_visid,         
hit_data_having_corp_house_records::post_evar1           AS post_evar1,           
hit_data_having_corp_house_records::post_evar10          AS post_evar10,          
hit_data_having_corp_house_records::post_evar11          AS post_evar11,          
hit_data_having_corp_house_records::post_evar12          AS post_evar12,          
hit_data_having_corp_house_records::post_evar13          AS post_evar13,          
hit_data_having_corp_house_records::post_evar14          AS post_evar14,          
hit_data_having_corp_house_records::post_evar15          AS post_evar15,          
hit_data_having_corp_house_records::post_evar16          AS post_evar16,          
hit_data_having_corp_house_records::post_evar17          AS post_evar17,          
hit_data_having_corp_house_records::post_evar18          AS post_evar18,          
hit_data_having_corp_house_records::post_evar19          AS post_evar19,
hit_data_having_corp_house_records::post_evar2           AS post_evar2, 
hit_data_having_corp_house_records::post_evar20          AS post_evar20,          
hit_data_having_corp_house_records::post_evar21          AS post_evar21,          
hit_data_having_corp_house_records::post_evar22          AS post_evar22,          
hit_data_having_corp_house_records::post_evar23          AS post_evar23,          
hit_data_having_corp_house_records::post_evar24          AS post_evar24,          
hit_data_having_corp_house_records::post_evar25          AS post_evar25,          
hit_data_having_corp_house_records::post_evar26          AS post_evar26,          
hit_data_having_corp_house_records::post_evar27          AS post_evar27,          
hit_data_having_corp_house_records::post_evar28          AS post_evar28,          
hit_data_having_corp_house_records::post_evar29          AS post_evar29,  
hit_data_having_corp_house_records::post_evar3           AS post_evar3,  
hit_data_having_corp_house_records::post_evar30          AS post_evar30,          
hit_data_having_corp_house_records::post_evar31          AS post_evar31,          
hit_data_having_corp_house_records::post_evar32          AS post_evar32,          
hit_data_having_corp_house_records::post_evar33          AS post_evar33,          
hit_data_having_corp_house_records::post_evar34          AS post_evar34,          
hit_data_having_corp_house_records::post_evar35          AS post_evar35,          
hit_data_having_corp_house_records::post_evar36          AS post_evar36,          
hit_data_having_corp_house_records::post_evar37          AS post_evar37,          
hit_data_having_corp_house_records::post_evar38          AS post_evar38,          
hit_data_having_corp_house_records::post_evar39          AS post_evar39,            
hit_data_having_corp_house_records::post_evar4           AS post_evar4,
hit_data_having_corp_house_records::post_evar40          AS post_evar40,          
hit_data_having_corp_house_records::post_evar41          AS post_evar41,          
hit_data_having_corp_house_records::post_evar42          AS post_evar42,          
hit_data_having_corp_house_records::post_evar43          AS post_evar43,          
hit_data_having_corp_house_records::post_evar44          AS post_evar44,          
hit_data_having_corp_house_records::post_evar45          AS post_evar45,          
hit_data_having_corp_house_records::post_evar46          AS post_evar46,         
hit_data_having_corp_house_records::post_evar47          AS post_evar47,         
hit_data_having_corp_house_records::post_evar48          AS post_evar48,         
hit_data_having_corp_house_records::post_evar49          AS post_evar49,  
hit_data_having_corp_house_records::post_evar5           AS post_evar5,           
hit_data_having_corp_house_records::post_evar50          AS post_evar50,         
hit_data_having_corp_house_records::post_evar51          AS post_evar51,         
hit_data_having_corp_house_records::post_evar52          AS post_evar52,         
hit_data_having_corp_house_records::post_evar53          AS post_evar53,         
hit_data_having_corp_house_records::post_evar54          AS post_evar54,         
hit_data_having_corp_house_records::post_evar55          AS post_evar55,         
hit_data_having_corp_house_records::post_evar56          AS post_evar56,         
hit_data_having_corp_house_records::post_evar57          AS post_evar57,         
hit_data_having_corp_house_records::post_evar58          AS post_evar58,         
hit_data_having_corp_house_records::post_evar59          AS post_evar59,     
hit_data_having_corp_house_records::post_evar6           AS post_evar6,           
hit_data_having_corp_house_records::post_evar60          AS post_evar60,         
hit_data_having_corp_house_records::post_evar61          AS post_evar61,         
hit_data_having_corp_house_records::post_evar62          AS post_evar62,         
hit_data_having_corp_house_records::post_evar63          AS post_evar63,         
hit_data_having_corp_house_records::post_evar64          AS post_evar64,         
hit_data_having_corp_house_records::post_evar65          AS post_evar65,         
hit_data_having_corp_house_records::post_evar66          AS post_evar66,         
hit_data_having_corp_house_records::post_evar67          AS post_evar67,         
hit_data_having_corp_house_records::post_evar68          AS post_evar68,         
hit_data_having_corp_house_records::post_evar69          AS post_evar69,         
hit_data_having_corp_house_records::post_evar7           AS post_evar7,           
hit_data_having_corp_house_records::post_evar70          AS post_evar70,         
hit_data_having_corp_house_records::post_evar71          AS post_evar71,         
hit_data_having_corp_house_records::post_evar72           AS post_evar72,         
hit_data_having_corp_house_records::post_evar73          AS post_evar73,         
hit_data_having_corp_house_records::post_evar74          AS post_evar74,         
hit_data_having_corp_house_records::post_evar75          AS post_evar75,         
hit_data_having_corp_house_records::post_evar8           AS post_evar8,           
hit_data_having_corp_house_records::post_evar9           AS post_evar9,           
hit_data_having_corp_house_records::post_event_list         AS post_event_list,
hit_data_having_corp_house_records::post_hier1           AS post_hier1,
hit_data_having_corp_house_records::post_hier2           AS post_hier2,
hit_data_having_corp_house_records::post_hier3           AS post_hier3,
hit_data_having_corp_house_records::post_hier4           AS post_hier4,
hit_data_having_corp_house_records::post_hier5           AS post_hier5,
hit_data_having_corp_house_records::post_java_enabled       AS post_java_enabled,
hit_data_having_corp_house_records::post_keywords           AS post_keywords,
hit_data_having_corp_house_records::post_mvvar1             AS post_mvvar1,
hit_data_having_corp_house_records::post_mvvar2             AS post_mvvar2,
hit_data_having_corp_house_records::post_mvvar3             AS post_mvvar3,
hit_data_having_corp_house_records::post_page_event         AS post_page_event,
hit_data_having_corp_house_records::post_page_event_var1    AS post_page_event_var1,
hit_data_having_corp_house_records::post_page_event_var2    AS post_page_event_var2,
hit_data_having_corp_house_records::post_page_event_var3    AS post_page_event_var3,
hit_data_having_corp_house_records::post_page_type          AS post_page_type,
hit_data_having_corp_house_records::post_page_url           AS post_page_url,
hit_data_having_corp_house_records::post_pagename           AS post_pagename,
hit_data_having_corp_house_records::post_pagename_no_url    AS post_pagename_no_url,  
hit_data_having_corp_house_records::post_partner_plugins    AS post_partner_plugins,
hit_data_having_corp_house_records::post_persistent_cookie  AS post_persistent_cookie,
hit_data_having_corp_house_records::post_product_list       AS post_product_list,
hit_data_having_corp_house_records::post_prop1           AS post_prop1,
hit_data_having_corp_house_records::post_prop10           AS post_prop10,
hit_data_having_corp_house_records::post_prop11          AS post_prop11,        
hit_data_having_corp_house_records::post_prop12          AS post_prop12,        
hit_data_having_corp_house_records::post_prop13          AS post_prop13,        
hit_data_having_corp_house_records::post_prop14          AS post_prop14,        
hit_data_having_corp_house_records::post_prop15          AS post_prop15,        
hit_data_having_corp_house_records::post_prop16          AS post_prop16,        
hit_data_having_corp_house_records::post_prop17          AS post_prop17,        
hit_data_having_corp_house_records::post_prop18          AS post_prop18,        
hit_data_having_corp_house_records::post_prop19          AS post_prop19,       
hit_data_having_corp_house_records::post_prop2           AS post_prop2,
hit_data_having_corp_house_records::post_prop20          AS post_prop20,        
hit_data_having_corp_house_records::post_prop21          AS post_prop21,        
hit_data_having_corp_house_records::post_prop22          AS post_prop22,        
hit_data_having_corp_house_records::post_prop23          AS post_prop23,        
hit_data_having_corp_house_records::post_prop24          AS post_prop24,        
hit_data_having_corp_house_records::post_prop25          AS post_prop25,        
hit_data_having_corp_house_records::post_prop26          AS post_prop26,        
hit_data_having_corp_house_records::post_prop27          AS post_prop27,        
hit_data_having_corp_house_records::post_prop28          AS post_prop28,        
hit_data_having_corp_house_records::post_prop29          AS post_prop29,        
hit_data_having_corp_house_records::post_prop3           AS post_prop3,
hit_data_having_corp_house_records::post_prop30          AS post_prop30,        
hit_data_having_corp_house_records::post_prop31          AS post_prop31,       
hit_data_having_corp_house_records::post_prop32          AS post_prop32,        
hit_data_having_corp_house_records::post_prop33          AS post_prop33,        
hit_data_having_corp_house_records::post_prop34          AS post_prop34,        
hit_data_having_corp_house_records::post_prop35          AS post_prop35,        
hit_data_having_corp_house_records::post_prop36          AS post_prop36,        
hit_data_having_corp_house_records::post_prop37          AS post_prop37,        
hit_data_having_corp_house_records::post_prop38          AS post_prop38,        
hit_data_having_corp_house_records::post_prop39          AS post_prop39,        
hit_data_having_corp_house_records::post_prop4           AS post_prop4,
hit_data_having_corp_house_records::post_prop40          AS post_prop40,        
hit_data_having_corp_house_records::post_prop41          AS post_prop41,        
hit_data_having_corp_house_records::post_prop42          AS post_prop42,        
hit_data_having_corp_house_records::post_prop43          AS post_prop43,        
hit_data_having_corp_house_records::post_prop44          AS post_prop44,        
hit_data_having_corp_house_records::post_prop45          AS post_prop45,        
hit_data_having_corp_house_records::post_prop46          AS post_prop46,        
hit_data_having_corp_house_records::post_prop47          AS post_prop47,        
hit_data_having_corp_house_records::post_prop48          AS post_prop48,        
hit_data_having_corp_house_records::post_prop49          AS post_prop49,        
hit_data_having_corp_house_records::post_prop5           AS post_prop5,
hit_data_having_corp_house_records::post_prop50          AS post_prop50,        
hit_data_having_corp_house_records::post_prop51          AS post_prop51,        
hit_data_having_corp_house_records::post_prop52          AS post_prop52,        
hit_data_having_corp_house_records::post_prop53          AS post_prop53,        
hit_data_having_corp_house_records::post_prop54          AS post_prop54,        
hit_data_having_corp_house_records::post_prop55          AS post_prop55,        
hit_data_having_corp_house_records::post_prop56          AS post_prop56,        
hit_data_having_corp_house_records::post_prop57          AS post_prop57,        
hit_data_having_corp_house_records::post_prop58          AS post_prop58,        
hit_data_having_corp_house_records::post_prop59          AS post_prop59,        
hit_data_having_corp_house_records::post_prop6           AS post_prop6,
hit_data_having_corp_house_records::post_prop60          AS post_prop60,        
hit_data_having_corp_house_records::post_prop61          AS post_prop61,        
hit_data_having_corp_house_records::post_prop62          AS post_prop62,        
hit_data_having_corp_house_records::post_prop63          AS post_prop63,        
hit_data_having_corp_house_records::post_prop64          AS post_prop64,       
hit_data_having_corp_house_records::post_prop65          AS post_prop65,        
hit_data_having_corp_house_records::post_prop66          AS post_prop66,    
hit_data_having_corp_house_records::post_prop67          AS post_prop67,        
hit_data_having_corp_house_records::post_prop68          AS post_prop68,        
hit_data_having_corp_house_records::post_prop69          AS post_prop69,
hit_data_having_corp_house_records::post_prop7           AS post_prop7,
hit_data_having_corp_house_records::post_prop70          AS post_prop70,        
hit_data_having_corp_house_records::post_prop71          AS post_prop71,        
hit_data_having_corp_house_records::post_prop72          AS post_prop72,        
hit_data_having_corp_house_records::post_prop73          AS post_prop73,        
hit_data_having_corp_house_records::post_prop74          AS post_prop74,        
hit_data_having_corp_house_records::post_prop75          AS post_prop75,        
hit_data_having_corp_house_records::post_prop8          AS post_prop8,
hit_data_having_corp_house_records::post_prop9           AS post_prop9,
hit_data_having_corp_house_records::post_purchaseid         AS post_purchaseid,
hit_data_having_corp_house_records::post_referrer          AS post_referrer,
hit_data_having_corp_house_records::post_search_engine      AS post_search_engine,      
hit_data_having_corp_house_records::post_state           AS post_state,      
hit_data_having_corp_house_records::post_survey          AS post_survey,
hit_data_having_corp_house_records::post_t_time_info        AS post_t_time_info,
hit_data_having_corp_house_records::post_tnt           AS post_tnt,        
hit_data_having_corp_house_records::post_transactionid      AS post_transactionid,                
hit_data_having_corp_house_records::post_visid_high     as post_visid_high ,
hit_data_having_corp_house_records::post_visid_low    as post_visid_low ,
hit_data_having_corp_house_records::post_visid_type         AS post_visid_type,         
hit_data_having_corp_house_records::post_zip           AS post_zip,                   
hit_data_having_corp_house_records::prev_page           AS prev_page,        
hit_data_having_corp_house_records::product_list          AS product_list,     
hit_data_having_corp_house_records::product_merchandising   AS product_merchandising,
hit_data_having_corp_house_records::prop1            AS prop1,  
hit_data_having_corp_house_records::prop10_custom_link                  AS prop10_custom_link,
hit_data_having_corp_house_records::prop11                  AS prop11,
hit_data_having_corp_house_records::prop12            AS prop12,
hit_data_having_corp_house_records::prop13            AS prop13,
hit_data_having_corp_house_records::prop14            AS prop14,
hit_data_having_corp_house_records::prop15            AS prop15,
hit_data_having_corp_house_records::prop16            AS prop16,
hit_data_having_corp_house_records::prop17            AS prop17,
hit_data_having_corp_house_records::prop18            AS prop18,
hit_data_having_corp_house_records::prop19            AS prop19,
hit_data_having_corp_house_records::prop2            AS prop2,
hit_data_having_corp_house_records::prop20            AS prop20,
hit_data_having_corp_house_records::prop21            AS prop21,
hit_data_having_corp_house_records::prop22           AS prop22,
hit_data_having_corp_house_records::prop23           AS prop23,
hit_data_having_corp_house_records::prop24           AS prop24,
hit_data_having_corp_house_records::prop25                  AS prop25,
hit_data_having_corp_house_records::prop26                  AS prop26,
hit_data_having_corp_house_records::prop27           AS prop27,
hit_data_having_corp_house_records::prop28           AS prop28,
hit_data_having_corp_house_records::prop29           AS prop29,
hit_data_having_corp_house_records::prop3            AS prop3,
hit_data_having_corp_house_records::prop30           AS prop30,
hit_data_having_corp_house_records::prop31           AS prop31,
hit_data_having_corp_house_records::prop32           AS prop32,
hit_data_having_corp_house_records::prop33           AS prop33,
hit_data_having_corp_house_records::prop34           AS prop34,  
hit_data_having_corp_house_records::prop35_opt_err_msg_desc                  AS prop35_opt_err_msg_desc,
hit_data_having_corp_house_records::prop36                  AS prop36,
hit_data_having_corp_house_records::prop37           AS prop37,
hit_data_having_corp_house_records::prop38           AS prop38,
hit_data_having_corp_house_records::prop39           AS prop39,
hit_data_having_corp_house_records::prop4            AS prop4,
hit_data_having_corp_house_records::prop40           AS prop40,
hit_data_having_corp_house_records::prop41_lead_form_field      AS prop41_lead_form_field,
hit_data_having_corp_house_records::prop42_order_form_field      AS prop42_order_form_field,
hit_data_having_corp_house_records::prop43_checkout_form_field      AS prop43_checkout_form_field,
hit_data_having_corp_house_records::prop44_site_type      AS prop44_site_type,
hit_data_having_corp_house_records::prop45_page_type      AS prop45_page_type,
hit_data_having_corp_house_records::prop46           AS prop46,
hit_data_having_corp_house_records::prop47           AS prop47,
hit_data_having_corp_house_records::prop48           AS prop48,
hit_data_having_corp_house_records::prop49           AS prop49,
hit_data_having_corp_house_records::prop5            AS prop5,
hit_data_having_corp_house_records::prop50           AS prop50,
hit_data_having_corp_house_records::prop51           AS prop51,
hit_data_having_corp_house_records::prop52           AS prop52,
hit_data_having_corp_house_records::prop53           AS prop53,
hit_data_having_corp_house_records::prop54           AS prop54,
hit_data_having_corp_house_records::prop55           AS prop55,
hit_data_having_corp_house_records::prop56           AS prop56,
hit_data_having_corp_house_records::prop57           AS prop57,
hit_data_having_corp_house_records::prop58           AS prop58,
hit_data_having_corp_house_records::prop59           AS prop59,
hit_data_having_corp_house_records::prop6                     AS prop6,
hit_data_having_corp_house_records::prop60           AS prop60,
hit_data_having_corp_house_records::prop61           AS prop61,
hit_data_having_corp_house_records::prop62           AS prop62,
hit_data_having_corp_house_records::prop63           AS prop63,
hit_data_having_corp_house_records::prop64           AS prop64,
hit_data_having_corp_house_records::prop65           AS prop65,
hit_data_having_corp_house_records::prop66           AS prop66,
hit_data_having_corp_house_records::prop67           AS prop67,
hit_data_having_corp_house_records::prop68           AS prop68,
hit_data_having_corp_house_records::prop69           AS prop69,
hit_data_having_corp_house_records::prop7                     AS prop7,
hit_data_having_corp_house_records::prop70           AS prop70,
hit_data_having_corp_house_records::prop71           AS prop71,
hit_data_having_corp_house_records::prop72           AS prop72,
hit_data_having_corp_house_records::prop73           AS prop73,
hit_data_having_corp_house_records::prop74           AS prop74,
hit_data_having_corp_house_records::prop75           AS prop75,
hit_data_having_corp_house_records::prop8                    AS prop8,
hit_data_having_corp_house_records::prop9            AS prop9,    
hit_data_having_corp_house_records::quarterly_visitor       AS quarterly_visitor,       
hit_data_having_corp_house_records::ref_domain             AS ref_domain,
hit_data_having_corp_house_records::referrer                AS referrer,
hit_data_having_corp_house_records::referrer_type_fullname      AS   referrer_type_fullname,
hit_data_having_corp_house_records::referrer_type_id               AS referrer_type_id,
hit_data_having_corp_house_records::referrer_type_shortname     AS referrer_type_shortname,
hit_data_having_corp_house_records::resolution              AS resolution,
hit_data_having_corp_house_records::s_resolution          AS s_resolution, 
hit_data_having_corp_house_records::sampled_hit             AS sampled_hit,
hit_data_having_corp_house_records::search_engine_id           AS search_engine_id,
hit_data_having_corp_house_records::search_engine_name      AS search_engine_name,
hit_data_having_corp_house_records::search_page_num         AS search_page_num,
hit_data_having_corp_house_records::secondary_hit     AS secondary_hit,
hit_data_having_corp_house_records::service           AS service,         
hit_data_having_corp_house_records::site_section_id AS site_section_id, 
hit_data_having_corp_house_records::site_section_name                 AS site_section_name,
'omniture'              AS sourced_from_system,
hit_data_having_corp_house_records::sourceid           AS sourceid,       
hit_data_having_corp_house_records::state            AS state,        
hit_data_having_corp_house_records::stats_server          AS stats_server, 
hit_data_having_corp_house_records::suite_id                   AS suite_id,
hit_data_having_corp_house_records::t_time_info         AS t_time_info,
hit_data_having_corp_house_records::tnt            AS tnt,
hit_data_having_corp_house_records::tnt_post_vista          AS tnt_post_vista,                       
hit_data_having_corp_house_records::truncated_hit           AS truncated_hit,            
hit_data_having_corp_house_records::ua_color       AS ua_color,
hit_data_having_corp_house_records::ua_os            AS ua_os,
hit_data_having_corp_house_records::ua_pixels           AS ua_pixels,
hit_data_having_corp_house_records::user_agent           AS user_agent,
hit_data_having_corp_house_records::user_hash           AS user_hash,
hit_data_having_corp_house_records::user_server          AS user_server,
hit_data_having_corp_house_records::userid            AS userid,
hit_data_having_corp_house_records::username           AS username,  
hit_data_having_corp_house_records::va_closer_detail        AS va_closer_detail,
hit_data_having_corp_house_records::va_closer_id            AS va_closer_id,
hit_data_having_corp_house_records::va_finder_detail        AS va_finder_detail,
hit_data_having_corp_house_records::va_finder_id            AS va_finder_id,
hit_data_having_corp_house_records::va_instance_event       AS va_instance_event,
hit_data_having_corp_house_records::va_new_engagement       AS va_new_engagement,
hit_data_having_corp_house_records::visid_high           AS visid_high,
hit_data_having_corp_house_records::visid_low           AS visid_low,
hit_data_having_corp_house_records::visid_new           AS visid_new,
hit_data_having_corp_house_records::visid_timestamp         AS visid_timestamp,
hit_data_having_corp_house_records::visid_type           AS visid_type,
hit_data_having_corp_house_records::visit_date              AS visit_date,
hit_data_having_corp_house_records::visit_keywords          AS visit_keywords,
hit_data_having_corp_house_records::visit_num           AS visit_num,
hit_data_having_corp_house_records::visit_page_num          AS visit_page_num,
hit_data_having_corp_house_records::visit_referrer          AS visit_referrer,
hit_data_having_corp_house_records::visit_search_engine     AS visit_search_engine,  
hit_data_having_corp_house_records::visit_start_page_url    AS visit_start_page_url,
hit_data_having_corp_house_records::visit_start_pagename    AS visit_start_pagename,
hit_data_having_corp_house_records::visit_start_time_gmt    AS visit_start_time_gmt,
hit_data_having_corp_house_records::weekly_visitor          AS weekly_visitor,
hit_data_having_corp_house_records::yearly_visitor          AS yearly_visitor,
hit_data_having_corp_house_records::zip           AS zip,
hit_data_having_corp_house_records::site_type  AS site_type,
hit_data_having_corp_house_records::cart_id as cart_id,
(int) hit_data_having_corp_house_records::corp as corp,
hit_data_having_corp_house_records::dwelling_nbr as dwelling_nbr;

hit_data_with_corp_house_multiple_records = foreach hit_data_having_multiple_corp_house generate
		hit_data_having_corp_house_records::accept_language         AS accept_language,
hit_data_having_corp_house_records::browser_height          AS browser_height,
hit_data_having_corp_house_records::browser_id                 AS browser_id,
hit_data_having_corp_house_records::browser_name AS browser_name,
hit_data_having_corp_house_records::browser_width           AS browser_width, 
hit_data_having_corp_house_records::c_color                 AS c_color,
hit_data_having_corp_house_records::campaign                AS campaign,  
hit_data_having_corp_house_records::click_action            AS click_action,
hit_data_having_corp_house_records::click_action_type       AS click_action_type,
hit_data_having_corp_house_records::click_context           AS click_context,
hit_data_having_corp_house_records::click_context_type      AS click_context_type,
hit_data_having_corp_house_records::click_sourceid          AS click_sourceid,
hit_data_having_corp_house_records::click_tag               AS click_tag,
hit_data_having_corp_house_records::code_ver                AS code_ver,
hit_data_having_corp_house_records::color                   AS color,
hit_data_having_corp_house_records::connection_type AS connection_type,
hit_data_having_corp_house_records::connection_type_id AS connection_type_id,
hit_data_having_corp_house_records::cookies     AS cookies,  
hit_data_having_corp_house_records::country_id                 AS country_id,
hit_data_having_corp_house_records::country_name AS country_name,
hit_data_having_corp_house_records::ct_connect_type         AS ct_connect_type,
hit_data_having_corp_house_records::curr_factor             AS curr_factor,
hit_data_having_corp_house_records::curr_rate               AS curr_rate,
hit_data_having_corp_house_records::currency                AS currency,        
hit_data_having_corp_house_records::cust_hit_time_gmt       AS cust_hit_time_gmt,
hit_data_having_corp_house_records::cust_visid              AS cust_visid,    
hit_data_having_corp_house_records::daily_visitor           AS daily_visitor,
hit_data_having_corp_house_records::dtm_created         AS dtm_created, 
hit_data_having_corp_house_records::duplicate_events        AS duplicate_events,
hit_data_having_corp_house_records::duplicate_purchase      AS duplicate_purchase,  
hit_data_having_corp_house_records::duplicated_from         AS duplicated_from,   
hit_data_having_corp_house_records::evar1_pagename          AS evar1_pagename,
hit_data_having_corp_house_records::evar10_optimum_link                  AS evar10_optimum_link,
hit_data_having_corp_house_records::evar11                  AS evar11,
hit_data_having_corp_house_records::evar12_live_chat_click                  AS evar12_live_chat_click,
hit_data_having_corp_house_records::evar13            AS evar13,
hit_data_having_corp_house_records::evar14            AS evar14,
hit_data_having_corp_house_records::evar15            AS evar15,
hit_data_having_corp_house_records::evar16            AS evar16,  
hit_data_having_corp_house_records::evar17            AS evar17,
hit_data_having_corp_house_records::evar18            AS evar18,
hit_data_having_corp_house_records::evar19_site_language            AS evar19_site_language,
hit_data_having_corp_house_records::evar2_page_type                   AS evar2_page_type,
hit_data_having_corp_house_records::evar20            AS evar20,
hit_data_having_corp_house_records::evar21            AS evar21,
hit_data_having_corp_house_records::evar22_form_id            AS evar22_form_id,
hit_data_having_corp_house_records::evar23                  AS evar23,
hit_data_having_corp_house_records::evar24                  AS evar24,
hit_data_having_corp_house_records::evar25                  AS evar25,
hit_data_having_corp_house_records::evar26_external_campaign                  AS evar26_external_campaign,
hit_data_having_corp_house_records::evar27                  AS evar27,
hit_data_having_corp_house_records::evar28_live_call            AS evar28_live_call,
hit_data_having_corp_house_records::evar29_purchaseid         AS evar29_purchaseid,  
hit_data_having_corp_house_records::evar3_campaign_stacking                   AS evar3_campaign_stacking,
hit_data_having_corp_house_records::evar30            AS evar30,
hit_data_having_corp_house_records::evar31_lead_form_id            AS evar31_lead_form_id,
hit_data_having_corp_house_records::evar32_order_flow_id            AS evar32_order_flow_id,
hit_data_having_corp_house_records::evar33_checkout_id            AS evar33_checkout_id,
hit_data_having_corp_house_records::evar34            AS evar34,
hit_data_having_corp_house_records::evar35            AS evar35,
hit_data_having_corp_house_records::evar36_transactionid          AS evar36_transactionid,
hit_data_having_corp_house_records::evar37            AS evar37,
hit_data_having_corp_house_records::evar38            AS evar38,
hit_data_having_corp_house_records::evar39_site_type            AS evar39_site_type,
hit_data_having_corp_house_records::evar4                   AS evar4,
hit_data_having_corp_house_records::evar40            AS evar40,
hit_data_having_corp_house_records::evar41            AS evar41,
hit_data_having_corp_house_records::evar42                  AS evar42,
hit_data_having_corp_house_records::evar43                  AS evar43,
hit_data_having_corp_house_records::evar44                  AS evar44,
hit_data_having_corp_house_records::evar45            AS evar45,
hit_data_having_corp_house_records::evar46            AS evar46,
hit_data_having_corp_house_records::evar47            AS evar47,
hit_data_having_corp_house_records::evar48            AS evar48,
hit_data_having_corp_house_records::evar49            AS evar49,
hit_data_having_corp_house_records::evar5                   AS evar5,
hit_data_having_corp_house_records::evar50            AS evar50,
hit_data_having_corp_house_records::evar51            AS evar51,
hit_data_having_corp_house_records::evar52           AS evar52,
hit_data_having_corp_house_records::evar53            AS evar53,
hit_data_having_corp_house_records::evar54            AS evar54,
hit_data_having_corp_house_records::evar55           AS evar55,
hit_data_having_corp_house_records::evar56            AS evar56,
hit_data_having_corp_house_records::evar57            AS evar57,
hit_data_having_corp_house_records::evar58            AS evar58,
hit_data_having_corp_house_records::evar59            AS evar59,  
hit_data_having_corp_house_records::evar6                   AS evar6,
hit_data_having_corp_house_records::evar60            AS evar60,
hit_data_having_corp_house_records::evar61            AS evar61,
hit_data_having_corp_house_records::evar62            AS evar62,
hit_data_having_corp_house_records::evar63            AS evar63,
hit_data_having_corp_house_records::evar64            AS evar64,
hit_data_having_corp_house_records::evar65            AS evar65,
hit_data_having_corp_house_records::evar66            AS evar66,
hit_data_having_corp_house_records::evar67            AS evar67,
hit_data_having_corp_house_records::evar68            AS evar68,
hit_data_having_corp_house_records::evar69            AS evar69,
hit_data_having_corp_house_records::evar7                   AS evar7,
hit_data_having_corp_house_records::evar70            AS evar70,
hit_data_having_corp_house_records::evar71            AS evar71,
hit_data_having_corp_house_records::evar72            AS evar72,
hit_data_having_corp_house_records::evar73            AS evar73,
hit_data_having_corp_house_records::evar74            AS evar74,
hit_data_having_corp_house_records::evar75            AS evar75,
hit_data_having_corp_house_records::evar8_visitor_type                   AS evar8_visitor_type,
hit_data_having_corp_house_records::evar9                   AS evar9,
hit_data_having_corp_house_records::event_list           AS event_list,
hit_data_having_corp_house_records::exclude_hit          AS exclude_hit,
hit_data_having_corp_house_records::first_hit_page_url      AS first_hit_page_url,
hit_data_having_corp_house_records::first_hit_pagename      AS first_hit_pagename,  
hit_data_having_corp_house_records::first_hit_referrer      AS first_hit_referrer,
hit_data_having_corp_house_records::first_hit_time_gmt      AS first_hit_time_gmt,
hit_data_having_corp_house_records::geo_city           AS geo_city,
hit_data_having_corp_house_records::geo_country          AS geo_country,
hit_data_having_corp_house_records::geo_dma                 AS geo_dma,
hit_data_having_corp_house_records::geo_region              AS geo_region,
hit_data_having_corp_house_records::geo_zip                 AS geo_zip,
hit_data_having_corp_house_records::hier1                   AS hier1,
hit_data_having_corp_house_records::hier2            AS hier2,
hit_data_having_corp_house_records::hier3            AS hier3,
hit_data_having_corp_house_records::hier4            AS hier4,
hit_data_having_corp_house_records::hier5            AS hier5,
hit_data_having_corp_house_records::hit_source              AS hit_source,
hit_data_having_corp_house_records::hit_time_gmt          AS hit_time_gmt,  
hit_data_having_corp_house_records::hitid_high           AS hitid_high,
hit_data_having_corp_house_records::hitid_low           AS hitid_low,  
hit_data_having_corp_house_records::homepage           AS homepage,
hit_data_having_corp_house_records::hourly_visitor          AS hourly_visitor,  
hit_data_having_corp_house_records::ip             AS ip,             
hit_data_having_corp_house_records::ip2            AS ip2,    
hit_data_having_corp_house_records::isp_id    AS isp_id,
hit_data_having_corp_house_records::isp_name                  AS isp_name,
hit_data_having_corp_house_records::j_jscript               AS j_jscript,
hit_data_having_corp_house_records::java_enabled          AS java_enabled,
hit_data_having_corp_house_records::javascript_version  AS javascript_version,
hit_data_having_corp_house_records::javascript_version_id              AS javascript_version_id,  
hit_data_having_corp_house_records::language_id                AS language_id,
hit_data_having_corp_house_records::language_name   AS language_name,  
hit_data_having_corp_house_records::last_hit_time_gmt       AS last_hit_time_gmt,
hit_data_having_corp_house_records::last_purchase_num       AS last_purchase_num,       
hit_data_having_corp_house_records::last_purchase_time_gmt  AS last_purchase_time_gmt, 
hit_data_having_corp_house_records::mobile_id           AS mobile_id,
hit_data_having_corp_house_records::monthly_visitor         AS monthly_visitor,
hit_data_having_corp_house_records::mvvar1            AS mvvar1,
hit_data_having_corp_house_records::mvvar2            AS mvvar2,            
hit_data_having_corp_house_records::mvvar3            AS mvvar3,            
hit_data_having_corp_house_records::namespace           AS namespace,
hit_data_having_corp_house_records::new_visit               AS new_visit,
hit_data_having_corp_house_records::operating_system_id                      AS operating_system_id,
hit_data_having_corp_house_records::operating_system_name AS operating_system_name,  
hit_data_having_corp_house_records::opt_err_msg_id         AS opt_err_msg_id,  
hit_data_having_corp_house_records::p_plugins               AS p_plugins,
hit_data_having_corp_house_records::page_event              AS page_event,
hit_data_having_corp_house_records::page_event_var1         AS page_event_var1,         
hit_data_having_corp_house_records::page_event_var2         AS page_event_var2,         
hit_data_having_corp_house_records::page_event_var3         AS page_event_var3,  
hit_data_having_corp_house_records::page_name_id   AS page_name_id,
hit_data_having_corp_house_records::page_type           AS page_type,           
hit_data_having_corp_house_records::page_url           AS page_url,       
hit_data_having_corp_house_records::pagename    AS pagename,          
hit_data_having_corp_house_records::paid_search          AS paid_search,          
hit_data_having_corp_house_records::partner_plugins         AS partner_plugins,         
hit_data_having_corp_house_records::persistent_cookie       AS persistent_cookie,   
hit_data_having_corp_house_records::plugin_name             AS plugin_name,
hit_data_having_corp_house_records::plugins           AS plugins,           
hit_data_having_corp_house_records::post_browser_height     AS post_browser_height,     
hit_data_having_corp_house_records::post_browser_width      AS post_browser_width,      
hit_data_having_corp_house_records::post_campaign          AS  post_campaign ,         
hit_data_having_corp_house_records::post_channel          AS  post_channel,          
hit_data_having_corp_house_records::post_cookies          AS  post_cookies,          
hit_data_having_corp_house_records::post_currency          AS  post_currency,          
hit_data_having_corp_house_records::post_cust_hit_time_gmt  AS post_cust_hit_time_gmt,  
hit_data_having_corp_house_records::post_cust_visid         AS post_cust_visid,         
hit_data_having_corp_house_records::post_evar1           AS post_evar1,           
hit_data_having_corp_house_records::post_evar10          AS post_evar10,          
hit_data_having_corp_house_records::post_evar11          AS post_evar11,          
hit_data_having_corp_house_records::post_evar12          AS post_evar12,          
hit_data_having_corp_house_records::post_evar13          AS post_evar13,          
hit_data_having_corp_house_records::post_evar14          AS post_evar14,          
hit_data_having_corp_house_records::post_evar15          AS post_evar15,          
hit_data_having_corp_house_records::post_evar16          AS post_evar16,          
hit_data_having_corp_house_records::post_evar17          AS post_evar17,          
hit_data_having_corp_house_records::post_evar18          AS post_evar18,          
hit_data_having_corp_house_records::post_evar19          AS post_evar19,
hit_data_having_corp_house_records::post_evar2           AS post_evar2, 
hit_data_having_corp_house_records::post_evar20          AS post_evar20,          
hit_data_having_corp_house_records::post_evar21          AS post_evar21,          
hit_data_having_corp_house_records::post_evar22          AS post_evar22,          
hit_data_having_corp_house_records::post_evar23          AS post_evar23,          
hit_data_having_corp_house_records::post_evar24          AS post_evar24,          
hit_data_having_corp_house_records::post_evar25          AS post_evar25,          
hit_data_having_corp_house_records::post_evar26          AS post_evar26,          
hit_data_having_corp_house_records::post_evar27          AS post_evar27,          
hit_data_having_corp_house_records::post_evar28          AS post_evar28,          
hit_data_having_corp_house_records::post_evar29          AS post_evar29,  
hit_data_having_corp_house_records::post_evar3           AS post_evar3,  
hit_data_having_corp_house_records::post_evar30          AS post_evar30,          
hit_data_having_corp_house_records::post_evar31          AS post_evar31,          
hit_data_having_corp_house_records::post_evar32          AS post_evar32,          
hit_data_having_corp_house_records::post_evar33          AS post_evar33,          
hit_data_having_corp_house_records::post_evar34          AS post_evar34,          
hit_data_having_corp_house_records::post_evar35          AS post_evar35,          
hit_data_having_corp_house_records::post_evar36          AS post_evar36,          
hit_data_having_corp_house_records::post_evar37          AS post_evar37,          
hit_data_having_corp_house_records::post_evar38          AS post_evar38,          
hit_data_having_corp_house_records::post_evar39          AS post_evar39,            
hit_data_having_corp_house_records::post_evar4           AS post_evar4,
hit_data_having_corp_house_records::post_evar40          AS post_evar40,          
hit_data_having_corp_house_records::post_evar41          AS post_evar41,          
hit_data_having_corp_house_records::post_evar42          AS post_evar42,          
hit_data_having_corp_house_records::post_evar43          AS post_evar43,          
hit_data_having_corp_house_records::post_evar44          AS post_evar44,          
hit_data_having_corp_house_records::post_evar45          AS post_evar45,          
hit_data_having_corp_house_records::post_evar46          AS post_evar46,         
hit_data_having_corp_house_records::post_evar47          AS post_evar47,         
hit_data_having_corp_house_records::post_evar48          AS post_evar48,         
hit_data_having_corp_house_records::post_evar49          AS post_evar49,  
hit_data_having_corp_house_records::post_evar5           AS post_evar5,           
hit_data_having_corp_house_records::post_evar50          AS post_evar50,         
hit_data_having_corp_house_records::post_evar51          AS post_evar51,         
hit_data_having_corp_house_records::post_evar52          AS post_evar52,         
hit_data_having_corp_house_records::post_evar53          AS post_evar53,         
hit_data_having_corp_house_records::post_evar54          AS post_evar54,         
hit_data_having_corp_house_records::post_evar55          AS post_evar55,         
hit_data_having_corp_house_records::post_evar56          AS post_evar56,         
hit_data_having_corp_house_records::post_evar57          AS post_evar57,         
hit_data_having_corp_house_records::post_evar58          AS post_evar58,         
hit_data_having_corp_house_records::post_evar59          AS post_evar59,     
hit_data_having_corp_house_records::post_evar6           AS post_evar6,           
hit_data_having_corp_house_records::post_evar60          AS post_evar60,         
hit_data_having_corp_house_records::post_evar61          AS post_evar61,         
hit_data_having_corp_house_records::post_evar62          AS post_evar62,         
hit_data_having_corp_house_records::post_evar63          AS post_evar63,         
hit_data_having_corp_house_records::post_evar64          AS post_evar64,         
hit_data_having_corp_house_records::post_evar65          AS post_evar65,         
hit_data_having_corp_house_records::post_evar66          AS post_evar66,         
hit_data_having_corp_house_records::post_evar67          AS post_evar67,         
hit_data_having_corp_house_records::post_evar68          AS post_evar68,         
hit_data_having_corp_house_records::post_evar69          AS post_evar69,         
hit_data_having_corp_house_records::post_evar7           AS post_evar7,           
hit_data_having_corp_house_records::post_evar70          AS post_evar70,         
hit_data_having_corp_house_records::post_evar71          AS post_evar71,         
hit_data_having_corp_house_records::post_evar72           AS post_evar72,         
hit_data_having_corp_house_records::post_evar73          AS post_evar73,         
hit_data_having_corp_house_records::post_evar74          AS post_evar74,         
hit_data_having_corp_house_records::post_evar75          AS post_evar75,         
hit_data_having_corp_house_records::post_evar8           AS post_evar8,           
hit_data_having_corp_house_records::post_evar9           AS post_evar9,           
hit_data_having_corp_house_records::post_event_list         AS post_event_list,
hit_data_having_corp_house_records::post_hier1           AS post_hier1,
hit_data_having_corp_house_records::post_hier2           AS post_hier2,
hit_data_having_corp_house_records::post_hier3           AS post_hier3,
hit_data_having_corp_house_records::post_hier4           AS post_hier4,
hit_data_having_corp_house_records::post_hier5           AS post_hier5,
hit_data_having_corp_house_records::post_java_enabled       AS post_java_enabled,
hit_data_having_corp_house_records::post_keywords           AS post_keywords,
hit_data_having_corp_house_records::post_mvvar1             AS post_mvvar1,
hit_data_having_corp_house_records::post_mvvar2             AS post_mvvar2,
hit_data_having_corp_house_records::post_mvvar3             AS post_mvvar3,
hit_data_having_corp_house_records::post_page_event         AS post_page_event,
hit_data_having_corp_house_records::post_page_event_var1    AS post_page_event_var1,
hit_data_having_corp_house_records::post_page_event_var2    AS post_page_event_var2,
hit_data_having_corp_house_records::post_page_event_var3    AS post_page_event_var3,
hit_data_having_corp_house_records::post_page_type          AS post_page_type,
hit_data_having_corp_house_records::post_page_url           AS post_page_url,
hit_data_having_corp_house_records::post_pagename           AS post_pagename,
hit_data_having_corp_house_records::post_pagename_no_url    AS post_pagename_no_url,  
hit_data_having_corp_house_records::post_partner_plugins    AS post_partner_plugins,
hit_data_having_corp_house_records::post_persistent_cookie  AS post_persistent_cookie,
hit_data_having_corp_house_records::post_product_list       AS post_product_list,
hit_data_having_corp_house_records::post_prop1           AS post_prop1,
hit_data_having_corp_house_records::post_prop10           AS post_prop10,
hit_data_having_corp_house_records::post_prop11          AS post_prop11,        
hit_data_having_corp_house_records::post_prop12          AS post_prop12,        
hit_data_having_corp_house_records::post_prop13          AS post_prop13,        
hit_data_having_corp_house_records::post_prop14          AS post_prop14,        
hit_data_having_corp_house_records::post_prop15          AS post_prop15,        
hit_data_having_corp_house_records::post_prop16          AS post_prop16,        
hit_data_having_corp_house_records::post_prop17          AS post_prop17,        
hit_data_having_corp_house_records::post_prop18          AS post_prop18,        
hit_data_having_corp_house_records::post_prop19          AS post_prop19,       
hit_data_having_corp_house_records::post_prop2           AS post_prop2,
hit_data_having_corp_house_records::post_prop20          AS post_prop20,        
hit_data_having_corp_house_records::post_prop21          AS post_prop21,        
hit_data_having_corp_house_records::post_prop22          AS post_prop22,        
hit_data_having_corp_house_records::post_prop23          AS post_prop23,        
hit_data_having_corp_house_records::post_prop24          AS post_prop24,        
hit_data_having_corp_house_records::post_prop25          AS post_prop25,        
hit_data_having_corp_house_records::post_prop26          AS post_prop26,        
hit_data_having_corp_house_records::post_prop27          AS post_prop27,        
hit_data_having_corp_house_records::post_prop28          AS post_prop28,        
hit_data_having_corp_house_records::post_prop29          AS post_prop29,        
hit_data_having_corp_house_records::post_prop3           AS post_prop3,
hit_data_having_corp_house_records::post_prop30          AS post_prop30,        
hit_data_having_corp_house_records::post_prop31          AS post_prop31,       
hit_data_having_corp_house_records::post_prop32          AS post_prop32,        
hit_data_having_corp_house_records::post_prop33          AS post_prop33,        
hit_data_having_corp_house_records::post_prop34          AS post_prop34,        
hit_data_having_corp_house_records::post_prop35          AS post_prop35,        
hit_data_having_corp_house_records::post_prop36          AS post_prop36,        
hit_data_having_corp_house_records::post_prop37          AS post_prop37,        
hit_data_having_corp_house_records::post_prop38          AS post_prop38,        
hit_data_having_corp_house_records::post_prop39          AS post_prop39,        
hit_data_having_corp_house_records::post_prop4           AS post_prop4,
hit_data_having_corp_house_records::post_prop40          AS post_prop40,        
hit_data_having_corp_house_records::post_prop41          AS post_prop41,        
hit_data_having_corp_house_records::post_prop42          AS post_prop42,        
hit_data_having_corp_house_records::post_prop43          AS post_prop43,        
hit_data_having_corp_house_records::post_prop44          AS post_prop44,        
hit_data_having_corp_house_records::post_prop45          AS post_prop45,        
hit_data_having_corp_house_records::post_prop46          AS post_prop46,        
hit_data_having_corp_house_records::post_prop47          AS post_prop47,        
hit_data_having_corp_house_records::post_prop48          AS post_prop48,        
hit_data_having_corp_house_records::post_prop49          AS post_prop49,        
hit_data_having_corp_house_records::post_prop5           AS post_prop5,
hit_data_having_corp_house_records::post_prop50          AS post_prop50,        
hit_data_having_corp_house_records::post_prop51          AS post_prop51,        
hit_data_having_corp_house_records::post_prop52          AS post_prop52,        
hit_data_having_corp_house_records::post_prop53          AS post_prop53,        
hit_data_having_corp_house_records::post_prop54          AS post_prop54,        
hit_data_having_corp_house_records::post_prop55          AS post_prop55,        
hit_data_having_corp_house_records::post_prop56          AS post_prop56,        
hit_data_having_corp_house_records::post_prop57          AS post_prop57,        
hit_data_having_corp_house_records::post_prop58          AS post_prop58,        
hit_data_having_corp_house_records::post_prop59          AS post_prop59,        
hit_data_having_corp_house_records::post_prop6           AS post_prop6,
hit_data_having_corp_house_records::post_prop60          AS post_prop60,        
hit_data_having_corp_house_records::post_prop61          AS post_prop61,        
hit_data_having_corp_house_records::post_prop62          AS post_prop62,        
hit_data_having_corp_house_records::post_prop63          AS post_prop63,        
hit_data_having_corp_house_records::post_prop64          AS post_prop64,       
hit_data_having_corp_house_records::post_prop65          AS post_prop65,        
hit_data_having_corp_house_records::post_prop66          AS post_prop66,    
hit_data_having_corp_house_records::post_prop67          AS post_prop67,        
hit_data_having_corp_house_records::post_prop68          AS post_prop68,        
hit_data_having_corp_house_records::post_prop69          AS post_prop69,
hit_data_having_corp_house_records::post_prop7           AS post_prop7,
hit_data_having_corp_house_records::post_prop70          AS post_prop70,        
hit_data_having_corp_house_records::post_prop71          AS post_prop71,        
hit_data_having_corp_house_records::post_prop72          AS post_prop72,        
hit_data_having_corp_house_records::post_prop73          AS post_prop73,        
hit_data_having_corp_house_records::post_prop74          AS post_prop74,        
hit_data_having_corp_house_records::post_prop75          AS post_prop75,        
hit_data_having_corp_house_records::post_prop8          AS post_prop8,
hit_data_having_corp_house_records::post_prop9           AS post_prop9,
hit_data_having_corp_house_records::post_purchaseid         AS post_purchaseid,
hit_data_having_corp_house_records::post_referrer          AS post_referrer,
hit_data_having_corp_house_records::post_search_engine      AS post_search_engine,      
hit_data_having_corp_house_records::post_state           AS post_state,      
hit_data_having_corp_house_records::post_survey          AS post_survey,
hit_data_having_corp_house_records::post_t_time_info        AS post_t_time_info,
hit_data_having_corp_house_records::post_tnt           AS post_tnt,        
hit_data_having_corp_house_records::post_transactionid      AS post_transactionid,                
hit_data_having_corp_house_records::post_visid_high     as post_visid_high ,
hit_data_having_corp_house_records::post_visid_low    as post_visid_low ,
hit_data_having_corp_house_records::post_visid_type         AS post_visid_type,         
hit_data_having_corp_house_records::post_zip           AS post_zip,                   
hit_data_having_corp_house_records::prev_page           AS prev_page,        
hit_data_having_corp_house_records::product_list          AS product_list,     
hit_data_having_corp_house_records::product_merchandising   AS product_merchandising,
hit_data_having_corp_house_records::prop1            AS prop1,  
hit_data_having_corp_house_records::prop10_custom_link                  AS prop10_custom_link,
hit_data_having_corp_house_records::prop11                  AS prop11,
hit_data_having_corp_house_records::prop12            AS prop12,
hit_data_having_corp_house_records::prop13            AS prop13,
hit_data_having_corp_house_records::prop14            AS prop14,
hit_data_having_corp_house_records::prop15            AS prop15,
hit_data_having_corp_house_records::prop16            AS prop16,
hit_data_having_corp_house_records::prop17            AS prop17,
hit_data_having_corp_house_records::prop18            AS prop18,
hit_data_having_corp_house_records::prop19            AS prop19,
hit_data_having_corp_house_records::prop2            AS prop2,
hit_data_having_corp_house_records::prop20            AS prop20,
hit_data_having_corp_house_records::prop21            AS prop21,
hit_data_having_corp_house_records::prop22           AS prop22,
hit_data_having_corp_house_records::prop23           AS prop23,
hit_data_having_corp_house_records::prop24           AS prop24,
hit_data_having_corp_house_records::prop25                  AS prop25,
hit_data_having_corp_house_records::prop26                  AS prop26,
hit_data_having_corp_house_records::prop27           AS prop27,
hit_data_having_corp_house_records::prop28           AS prop28,
hit_data_having_corp_house_records::prop29           AS prop29,
hit_data_having_corp_house_records::prop3            AS prop3,
hit_data_having_corp_house_records::prop30           AS prop30,
hit_data_having_corp_house_records::prop31           AS prop31,
hit_data_having_corp_house_records::prop32           AS prop32,
hit_data_having_corp_house_records::prop33           AS prop33,
hit_data_having_corp_house_records::prop34           AS prop34,  
hit_data_having_corp_house_records::prop35_opt_err_msg_desc                  AS prop35_opt_err_msg_desc,
hit_data_having_corp_house_records::prop36                  AS prop36,
hit_data_having_corp_house_records::prop37           AS prop37,
hit_data_having_corp_house_records::prop38           AS prop38,
hit_data_having_corp_house_records::prop39           AS prop39,
hit_data_having_corp_house_records::prop4            AS prop4,
hit_data_having_corp_house_records::prop40           AS prop40,
hit_data_having_corp_house_records::prop41_lead_form_field      AS prop41_lead_form_field,
hit_data_having_corp_house_records::prop42_order_form_field      AS prop42_order_form_field,
hit_data_having_corp_house_records::prop43_checkout_form_field      AS prop43_checkout_form_field,
hit_data_having_corp_house_records::prop44_site_type      AS prop44_site_type,
hit_data_having_corp_house_records::prop45_page_type      AS prop45_page_type,
hit_data_having_corp_house_records::prop46           AS prop46,
hit_data_having_corp_house_records::prop47           AS prop47,
hit_data_having_corp_house_records::prop48           AS prop48,
hit_data_having_corp_house_records::prop49           AS prop49,
hit_data_having_corp_house_records::prop5            AS prop5,
hit_data_having_corp_house_records::prop50           AS prop50,
hit_data_having_corp_house_records::prop51           AS prop51,
hit_data_having_corp_house_records::prop52           AS prop52,
hit_data_having_corp_house_records::prop53           AS prop53,
hit_data_having_corp_house_records::prop54           AS prop54,
hit_data_having_corp_house_records::prop55           AS prop55,
hit_data_having_corp_house_records::prop56           AS prop56,
hit_data_having_corp_house_records::prop57           AS prop57,
hit_data_having_corp_house_records::prop58           AS prop58,
hit_data_having_corp_house_records::prop59           AS prop59,
hit_data_having_corp_house_records::prop6                     AS prop6,
hit_data_having_corp_house_records::prop60           AS prop60,
hit_data_having_corp_house_records::prop61           AS prop61,
hit_data_having_corp_house_records::prop62           AS prop62,
hit_data_having_corp_house_records::prop63           AS prop63,
hit_data_having_corp_house_records::prop64           AS prop64,
hit_data_having_corp_house_records::prop65           AS prop65,
hit_data_having_corp_house_records::prop66           AS prop66,
hit_data_having_corp_house_records::prop67           AS prop67,
hit_data_having_corp_house_records::prop68           AS prop68,
hit_data_having_corp_house_records::prop69           AS prop69,
hit_data_having_corp_house_records::prop7                     AS prop7,
hit_data_having_corp_house_records::prop70           AS prop70,
hit_data_having_corp_house_records::prop71           AS prop71,
hit_data_having_corp_house_records::prop72           AS prop72,
hit_data_having_corp_house_records::prop73           AS prop73,
hit_data_having_corp_house_records::prop74           AS prop74,
hit_data_having_corp_house_records::prop75           AS prop75,
hit_data_having_corp_house_records::prop8                    AS prop8,
hit_data_having_corp_house_records::prop9            AS prop9,    
hit_data_having_corp_house_records::quarterly_visitor       AS quarterly_visitor,       
hit_data_having_corp_house_records::ref_domain             AS ref_domain,
hit_data_having_corp_house_records::referrer                AS referrer,
hit_data_having_corp_house_records::referrer_type_fullname      AS   referrer_type_fullname,
hit_data_having_corp_house_records::referrer_type_id               AS referrer_type_id,
hit_data_having_corp_house_records::referrer_type_shortname     AS referrer_type_shortname,
hit_data_having_corp_house_records::resolution              AS resolution,
hit_data_having_corp_house_records::s_resolution          AS s_resolution, 
hit_data_having_corp_house_records::sampled_hit             AS sampled_hit,
hit_data_having_corp_house_records::search_engine_id           AS search_engine_id,
hit_data_having_corp_house_records::search_engine_name      AS search_engine_name,
hit_data_having_corp_house_records::search_page_num         AS search_page_num,
hit_data_having_corp_house_records::secondary_hit     AS secondary_hit,
hit_data_having_corp_house_records::service           AS service,         
hit_data_having_corp_house_records::site_section_id AS site_section_id, 
hit_data_having_corp_house_records::site_section_name                 AS site_section_name,
'omniture'              AS sourced_from_system,
hit_data_having_corp_house_records::sourceid           AS sourceid,       
hit_data_having_corp_house_records::state            AS state,        
hit_data_having_corp_house_records::stats_server          AS stats_server, 
hit_data_having_corp_house_records::suite_id                   AS suite_id,
hit_data_having_corp_house_records::t_time_info         AS t_time_info,
hit_data_having_corp_house_records::tnt            AS tnt,
hit_data_having_corp_house_records::tnt_post_vista          AS tnt_post_vista,                       
hit_data_having_corp_house_records::truncated_hit           AS truncated_hit,            
hit_data_having_corp_house_records::ua_color       AS ua_color,
hit_data_having_corp_house_records::ua_os            AS ua_os,
hit_data_having_corp_house_records::ua_pixels           AS ua_pixels,
hit_data_having_corp_house_records::user_agent           AS user_agent,
hit_data_having_corp_house_records::user_hash           AS user_hash,
hit_data_having_corp_house_records::user_server          AS user_server,
hit_data_having_corp_house_records::userid            AS userid,
hit_data_having_corp_house_records::username           AS username,  
hit_data_having_corp_house_records::va_closer_detail        AS va_closer_detail,
hit_data_having_corp_house_records::va_closer_id            AS va_closer_id,
hit_data_having_corp_house_records::va_finder_detail        AS va_finder_detail,
hit_data_having_corp_house_records::va_finder_id            AS va_finder_id,
hit_data_having_corp_house_records::va_instance_event       AS va_instance_event,
hit_data_having_corp_house_records::va_new_engagement       AS va_new_engagement,
hit_data_having_corp_house_records::visid_high           AS visid_high,
hit_data_having_corp_house_records::visid_low           AS visid_low,
hit_data_having_corp_house_records::visid_new           AS visid_new,
hit_data_having_corp_house_records::visid_timestamp         AS visid_timestamp,
hit_data_having_corp_house_records::visid_type           AS visid_type,
hit_data_having_corp_house_records::visit_date              AS visit_date,
hit_data_having_corp_house_records::visit_keywords          AS visit_keywords,
hit_data_having_corp_house_records::visit_num           AS visit_num,
hit_data_having_corp_house_records::visit_page_num          AS visit_page_num,
hit_data_having_corp_house_records::visit_referrer          AS visit_referrer,
hit_data_having_corp_house_records::visit_search_engine     AS visit_search_engine,  
hit_data_having_corp_house_records::visit_start_page_url    AS visit_start_page_url,
hit_data_having_corp_house_records::visit_start_pagename    AS visit_start_pagename,
hit_data_having_corp_house_records::visit_start_time_gmt    AS visit_start_time_gmt,
hit_data_having_corp_house_records::weekly_visitor          AS weekly_visitor,
hit_data_having_corp_house_records::yearly_visitor          AS yearly_visitor,
hit_data_having_corp_house_records::zip           AS zip,
hit_data_having_corp_house_records::site_type  AS site_type,
hit_data_having_corp_house_records::cart_id as cart_id,
(int) hit_data_having_corp_house_records::corp as corp,
hit_data_having_corp_house_records::dwelling_nbr as dwelling_nbr; 


hit_data_missing_cart_id_records = foreach hit_data_without_cart_id_records generate ..site_type, null as cart_id, '-1' as corp, '-1' as dwelling_nbr;

hit_data_without_corp_house_records = foreach hit_data_missing_corp_house_records generate 
                          hit_data_with_cart_id_records::accept_language         AS accept_language,
		  hit_data_with_cart_id_records::browser_height          AS browser_height,
		  hit_data_with_cart_id_records::browser_id                 AS browser_id,
		  hit_data_with_cart_id_records::browser_name AS browser_name,
		  hit_data_with_cart_id_records::browser_width           AS browser_width, 
		  hit_data_with_cart_id_records::c_color                 AS c_color,
		  hit_data_with_cart_id_records::campaign                AS campaign,  
		  hit_data_with_cart_id_records::click_action            AS click_action,
		  hit_data_with_cart_id_records::click_action_type       AS click_action_type,
		  hit_data_with_cart_id_records::click_context           AS click_context,
		  hit_data_with_cart_id_records::click_context_type      AS click_context_type,
		  hit_data_with_cart_id_records::click_sourceid          AS click_sourceid,
		  hit_data_with_cart_id_records::click_tag               AS click_tag,
		  hit_data_with_cart_id_records::code_ver                AS code_ver,
		  hit_data_with_cart_id_records::color                   AS color,
		  hit_data_with_cart_id_records::connection_type AS connection_type,
		  hit_data_with_cart_id_records::connection_type_id AS connection_type_id,
		  hit_data_with_cart_id_records::cookies     AS cookies,  
		  hit_data_with_cart_id_records::country_id                 AS country_id,
		  hit_data_with_cart_id_records::country_name AS country_name,
		  hit_data_with_cart_id_records::ct_connect_type         AS ct_connect_type,
		  hit_data_with_cart_id_records::curr_factor             AS curr_factor,
		  hit_data_with_cart_id_records::curr_rate               AS curr_rate,
		  hit_data_with_cart_id_records::currency                AS currency,        
		  hit_data_with_cart_id_records::cust_hit_time_gmt       AS cust_hit_time_gmt,
		  hit_data_with_cart_id_records::cust_visid              AS cust_visid,    
		  hit_data_with_cart_id_records::daily_visitor           AS daily_visitor,
		  hit_data_with_cart_id_records::dtm_created         AS dtm_created, 
		  hit_data_with_cart_id_records::duplicate_events        AS duplicate_events,
		  hit_data_with_cart_id_records::duplicate_purchase      AS duplicate_purchase,  
		  hit_data_with_cart_id_records::duplicated_from         AS duplicated_from,   
		  hit_data_with_cart_id_records::evar1_pagename          AS evar1_pagename,
		  hit_data_with_cart_id_records::evar10_optimum_link                  AS evar10_optimum_link,
		  hit_data_with_cart_id_records::evar11                  AS evar11,
		  hit_data_with_cart_id_records::evar12_live_chat_click                  AS evar12_live_chat_click,
		  hit_data_with_cart_id_records::evar13            AS evar13,
		  hit_data_with_cart_id_records::evar14            AS evar14,
		  hit_data_with_cart_id_records::evar15            AS evar15,
		  hit_data_with_cart_id_records::evar16            AS evar16,  
		  hit_data_with_cart_id_records::evar17            AS evar17,
		  hit_data_with_cart_id_records::evar18            AS evar18,
		  hit_data_with_cart_id_records::evar19_site_language            AS evar19_site_language,
		  hit_data_with_cart_id_records::evar2_page_type                   AS evar2_page_type,
		  hit_data_with_cart_id_records::evar20            AS evar20,
		  hit_data_with_cart_id_records::evar21            AS evar21,
		  hit_data_with_cart_id_records::evar22_form_id            AS evar22_form_id,
		  hit_data_with_cart_id_records::evar23                  AS evar23,
		  hit_data_with_cart_id_records::evar24                  AS evar24,
		  hit_data_with_cart_id_records::evar25                  AS evar25,
		  hit_data_with_cart_id_records::evar26_external_campaign                  AS evar26_external_campaign,
		  hit_data_with_cart_id_records::evar27                  AS evar27,
		  hit_data_with_cart_id_records::evar28_live_call            AS evar28_live_call,
		  hit_data_with_cart_id_records::evar29_purchaseid         AS evar29_purchaseid,  
		  hit_data_with_cart_id_records::evar3_campaign_stacking                   AS evar3_campaign_stacking,
		  hit_data_with_cart_id_records::evar30            AS evar30,
		  hit_data_with_cart_id_records::evar31_lead_form_id            AS evar31_lead_form_id,
		  hit_data_with_cart_id_records::evar32_order_flow_id            AS evar32_order_flow_id,
		  hit_data_with_cart_id_records::evar33_checkout_id            AS evar33_checkout_id,
		  hit_data_with_cart_id_records::evar34            AS evar34,
		  hit_data_with_cart_id_records::evar35            AS evar35,
		  hit_data_with_cart_id_records::evar36_transactionid          AS evar36_transactionid,
		  hit_data_with_cart_id_records::evar37            AS evar37,
		  hit_data_with_cart_id_records::evar38            AS evar38,
		  hit_data_with_cart_id_records::evar39_site_type            AS evar39_site_type,
		  hit_data_with_cart_id_records::evar4                   AS evar4,
		  hit_data_with_cart_id_records::evar40            AS evar40,
		  hit_data_with_cart_id_records::evar41            AS evar41,
		  hit_data_with_cart_id_records::evar42                  AS evar42,
		  hit_data_with_cart_id_records::evar43                  AS evar43,
		  hit_data_with_cart_id_records::evar44                  AS evar44,
		  hit_data_with_cart_id_records::evar45            AS evar45,
		  hit_data_with_cart_id_records::evar46            AS evar46,
		  hit_data_with_cart_id_records::evar47            AS evar47,
		  hit_data_with_cart_id_records::evar48            AS evar48,
		  hit_data_with_cart_id_records::evar49            AS evar49,
		  hit_data_with_cart_id_records::evar5                   AS evar5,
		  hit_data_with_cart_id_records::evar50            AS evar50,
		  hit_data_with_cart_id_records::evar51            AS evar51,
		  hit_data_with_cart_id_records::evar52           AS evar52,
		  hit_data_with_cart_id_records::evar53            AS evar53,
		  hit_data_with_cart_id_records::evar54            AS evar54,
		  hit_data_with_cart_id_records::evar55           AS evar55,
		  hit_data_with_cart_id_records::evar56            AS evar56,
		  hit_data_with_cart_id_records::evar57            AS evar57,
		  hit_data_with_cart_id_records::evar58            AS evar58,
		  hit_data_with_cart_id_records::evar59            AS evar59,  
		  hit_data_with_cart_id_records::evar6                   AS evar6,
		  hit_data_with_cart_id_records::evar60            AS evar60,
		  hit_data_with_cart_id_records::evar61            AS evar61,
		  hit_data_with_cart_id_records::evar62            AS evar62,
		  hit_data_with_cart_id_records::evar63            AS evar63,
		  hit_data_with_cart_id_records::evar64            AS evar64,
		  hit_data_with_cart_id_records::evar65            AS evar65,
		  hit_data_with_cart_id_records::evar66            AS evar66,
		  hit_data_with_cart_id_records::evar67            AS evar67,
		  hit_data_with_cart_id_records::evar68            AS evar68,
		  hit_data_with_cart_id_records::evar69            AS evar69,
		  hit_data_with_cart_id_records::evar7                   AS evar7,
		  hit_data_with_cart_id_records::evar70            AS evar70,
		  hit_data_with_cart_id_records::evar71            AS evar71,
		  hit_data_with_cart_id_records::evar72            AS evar72,
		  hit_data_with_cart_id_records::evar73            AS evar73,
		  hit_data_with_cart_id_records::evar74            AS evar74,
		  hit_data_with_cart_id_records::evar75            AS evar75,
		  hit_data_with_cart_id_records::evar8_visitor_type                   AS evar8_visitor_type,
		  hit_data_with_cart_id_records::evar9                   AS evar9,
		  hit_data_with_cart_id_records::event_list           AS event_list,
		  hit_data_with_cart_id_records::exclude_hit          AS exclude_hit,
		  hit_data_with_cart_id_records::first_hit_page_url      AS first_hit_page_url,
		  hit_data_with_cart_id_records::first_hit_pagename      AS first_hit_pagename,  
		  hit_data_with_cart_id_records::first_hit_referrer      AS first_hit_referrer,
		  hit_data_with_cart_id_records::first_hit_time_gmt      AS first_hit_time_gmt,
		  hit_data_with_cart_id_records::geo_city           AS geo_city,
		  hit_data_with_cart_id_records::geo_country          AS geo_country,
		  hit_data_with_cart_id_records::geo_dma                 AS geo_dma,
		  hit_data_with_cart_id_records::geo_region              AS geo_region,
		  hit_data_with_cart_id_records::geo_zip                 AS geo_zip,
		  hit_data_with_cart_id_records::hier1                   AS hier1,
		  hit_data_with_cart_id_records::hier2            AS hier2,
		  hit_data_with_cart_id_records::hier3            AS hier3,
		  hit_data_with_cart_id_records::hier4            AS hier4,
		  hit_data_with_cart_id_records::hier5            AS hier5,
		  hit_data_with_cart_id_records::hit_source              AS hit_source,
		  hit_data_with_cart_id_records::hit_time_gmt          AS hit_time_gmt,  
		  hit_data_with_cart_id_records::hitid_high           AS hitid_high,
		  hit_data_with_cart_id_records::hitid_low           AS hitid_low,  
		  hit_data_with_cart_id_records::homepage           AS homepage,
		  hit_data_with_cart_id_records::hourly_visitor          AS hourly_visitor,  
		  hit_data_with_cart_id_records::ip             AS ip,             
		  hit_data_with_cart_id_records::ip2            AS ip2,    
		  hit_data_with_cart_id_records::isp_id    AS isp_id,
		  hit_data_with_cart_id_records::isp_name                  AS isp_name,
		  hit_data_with_cart_id_records::j_jscript               AS j_jscript,
		  hit_data_with_cart_id_records::java_enabled          AS java_enabled,
		  hit_data_with_cart_id_records::javascript_version  AS javascript_version,
		  hit_data_with_cart_id_records::javascript_version_id              AS javascript_version_id,  
		  hit_data_with_cart_id_records::language_id                AS language_id,
		  hit_data_with_cart_id_records::language_name   AS language_name,  
		  hit_data_with_cart_id_records::last_hit_time_gmt       AS last_hit_time_gmt,
		  hit_data_with_cart_id_records::last_purchase_num       AS last_purchase_num,       
		  hit_data_with_cart_id_records::last_purchase_time_gmt  AS last_purchase_time_gmt, 
		  hit_data_with_cart_id_records::mobile_id           AS mobile_id,
		  hit_data_with_cart_id_records::monthly_visitor         AS monthly_visitor,
		  hit_data_with_cart_id_records::mvvar1            AS mvvar1,
		  hit_data_with_cart_id_records::mvvar2            AS mvvar2,            
		  hit_data_with_cart_id_records::mvvar3            AS mvvar3,            
		  hit_data_with_cart_id_records::namespace           AS namespace,
		  hit_data_with_cart_id_records::new_visit               AS new_visit,
		  hit_data_with_cart_id_records::operating_system_id                      AS operating_system_id,
		  hit_data_with_cart_id_records::operating_system_name AS operating_system_name,  
		  hit_data_with_cart_id_records::opt_err_msg_id         AS opt_err_msg_id,  
		  hit_data_with_cart_id_records::p_plugins               AS p_plugins,
		  hit_data_with_cart_id_records::page_event              AS page_event,
		  hit_data_with_cart_id_records::page_event_var1         AS page_event_var1,         
		  hit_data_with_cart_id_records::page_event_var2         AS page_event_var2,         
		  hit_data_with_cart_id_records::page_event_var3         AS page_event_var3,  
		  hit_data_with_cart_id_records::page_name_id   AS page_name_id,
		  hit_data_with_cart_id_records::page_type           AS page_type,           
		  hit_data_with_cart_id_records::page_url           AS page_url,       
		  hit_data_with_cart_id_records::pagename    AS pagename,          
		  hit_data_with_cart_id_records::paid_search          AS paid_search,          
		  hit_data_with_cart_id_records::partner_plugins         AS partner_plugins,         
		  hit_data_with_cart_id_records::persistent_cookie       AS persistent_cookie,   
		  hit_data_with_cart_id_records::plugin_name             AS plugin_name,
		  hit_data_with_cart_id_records::plugins           AS plugins,           
		  hit_data_with_cart_id_records::post_browser_height     AS post_browser_height,     
		  hit_data_with_cart_id_records::post_browser_width      AS post_browser_width,      
		  hit_data_with_cart_id_records::post_campaign          AS  post_campaign ,         
		  hit_data_with_cart_id_records::post_channel          AS  post_channel,          
		  hit_data_with_cart_id_records::post_cookies          AS  post_cookies,          
		  hit_data_with_cart_id_records::post_currency          AS  post_currency,          
		  hit_data_with_cart_id_records::post_cust_hit_time_gmt  AS post_cust_hit_time_gmt,  
		  hit_data_with_cart_id_records::post_cust_visid         AS post_cust_visid,         
		  hit_data_with_cart_id_records::post_evar1           AS post_evar1,           
		  hit_data_with_cart_id_records::post_evar10          AS post_evar10,          
		  hit_data_with_cart_id_records::post_evar11          AS post_evar11,          
		  hit_data_with_cart_id_records::post_evar12          AS post_evar12,          
		  hit_data_with_cart_id_records::post_evar13          AS post_evar13,          
		  hit_data_with_cart_id_records::post_evar14          AS post_evar14,          
		  hit_data_with_cart_id_records::post_evar15          AS post_evar15,          
		  hit_data_with_cart_id_records::post_evar16          AS post_evar16,          
		  hit_data_with_cart_id_records::post_evar17          AS post_evar17,          
		  hit_data_with_cart_id_records::post_evar18          AS post_evar18,          
		  hit_data_with_cart_id_records::post_evar19          AS post_evar19,
		  hit_data_with_cart_id_records::post_evar2           AS post_evar2, 
		  hit_data_with_cart_id_records::post_evar20          AS post_evar20,          
		  hit_data_with_cart_id_records::post_evar21          AS post_evar21,          
		  hit_data_with_cart_id_records::post_evar22          AS post_evar22,          
		  hit_data_with_cart_id_records::post_evar23          AS post_evar23,          
		  hit_data_with_cart_id_records::post_evar24          AS post_evar24,          
		  hit_data_with_cart_id_records::post_evar25          AS post_evar25,          
		  hit_data_with_cart_id_records::post_evar26          AS post_evar26,          
		  hit_data_with_cart_id_records::post_evar27          AS post_evar27,          
		  hit_data_with_cart_id_records::post_evar28          AS post_evar28,          
		  hit_data_with_cart_id_records::post_evar29          AS post_evar29,  
		  hit_data_with_cart_id_records::post_evar3           AS post_evar3,  
		          hit_data_with_cart_id_records::post_evar30          AS post_evar30,          
		  hit_data_with_cart_id_records::post_evar31          AS post_evar31,          
		  hit_data_with_cart_id_records::post_evar32          AS post_evar32,          
		  hit_data_with_cart_id_records::post_evar33          AS post_evar33,          
		  hit_data_with_cart_id_records::post_evar34          AS post_evar34,          
		  hit_data_with_cart_id_records::post_evar35          AS post_evar35,          
		  hit_data_with_cart_id_records::post_evar36          AS post_evar36,          
		  hit_data_with_cart_id_records::post_evar37          AS post_evar37,          
		  hit_data_with_cart_id_records::post_evar38          AS post_evar38,          
		  hit_data_with_cart_id_records::post_evar39          AS post_evar39,            
		  hit_data_with_cart_id_records::post_evar4           AS post_evar4,
		         hit_data_with_cart_id_records::post_evar40          AS post_evar40,          
		  hit_data_with_cart_id_records::post_evar41          AS post_evar41,          
		  hit_data_with_cart_id_records::post_evar42          AS post_evar42,          
		  hit_data_with_cart_id_records::post_evar43          AS post_evar43,          
		  hit_data_with_cart_id_records::post_evar44          AS post_evar44,          
		  hit_data_with_cart_id_records::post_evar45          AS post_evar45,          
		  hit_data_with_cart_id_records::post_evar46          AS post_evar46,         
		  hit_data_with_cart_id_records::post_evar47          AS post_evar47,         
		  hit_data_with_cart_id_records::post_evar48          AS post_evar48,         
		  hit_data_with_cart_id_records::post_evar49          AS post_evar49,  
		  hit_data_with_cart_id_records::post_evar5           AS post_evar5,           
		  hit_data_with_cart_id_records::post_evar50          AS post_evar50,         
		  hit_data_with_cart_id_records::post_evar51          AS post_evar51,         
		  hit_data_with_cart_id_records::post_evar52          AS post_evar52,         
		  hit_data_with_cart_id_records::post_evar53          AS post_evar53,         
		  hit_data_with_cart_id_records::post_evar54          AS post_evar54,         
		  hit_data_with_cart_id_records::post_evar55          AS post_evar55,         
		  hit_data_with_cart_id_records::post_evar56          AS post_evar56,         
		  hit_data_with_cart_id_records::post_evar57          AS post_evar57,         
		  hit_data_with_cart_id_records::post_evar58          AS post_evar58,         
		  hit_data_with_cart_id_records::post_evar59          AS post_evar59,     
		  hit_data_with_cart_id_records::post_evar6           AS post_evar6,           
		  hit_data_with_cart_id_records::post_evar60          AS post_evar60,         
		  hit_data_with_cart_id_records::post_evar61          AS post_evar61,         
		  hit_data_with_cart_id_records::post_evar62          AS post_evar62,         
		  hit_data_with_cart_id_records::post_evar63          AS post_evar63,         
		  hit_data_with_cart_id_records::post_evar64          AS post_evar64,         
		  hit_data_with_cart_id_records::post_evar65          AS post_evar65,         
		  hit_data_with_cart_id_records::post_evar66          AS post_evar66,         
		  hit_data_with_cart_id_records::post_evar67          AS post_evar67,         
		  hit_data_with_cart_id_records::post_evar68          AS post_evar68,         
		  hit_data_with_cart_id_records::post_evar69          AS post_evar69,         
		  hit_data_with_cart_id_records::post_evar7           AS post_evar7,           
		  hit_data_with_cart_id_records::post_evar70          AS post_evar70,         
		  hit_data_with_cart_id_records::post_evar71          AS post_evar71,         
		  hit_data_with_cart_id_records::post_evar72           AS post_evar72,         
		  hit_data_with_cart_id_records::post_evar73          AS post_evar73,         
		  hit_data_with_cart_id_records::post_evar74          AS post_evar74,         
		  hit_data_with_cart_id_records::post_evar75          AS post_evar75,         
		  hit_data_with_cart_id_records::post_evar8           AS post_evar8,           
		  hit_data_with_cart_id_records::post_evar9           AS post_evar9,           
		  hit_data_with_cart_id_records::post_event_list         AS post_event_list,
		  hit_data_with_cart_id_records::post_hier1           AS post_hier1,
		  hit_data_with_cart_id_records::post_hier2           AS post_hier2,
		  hit_data_with_cart_id_records::post_hier3           AS post_hier3,
		  hit_data_with_cart_id_records::post_hier4           AS post_hier4,
		  hit_data_with_cart_id_records::post_hier5           AS post_hier5,
		  hit_data_with_cart_id_records::post_java_enabled       AS post_java_enabled,
		  hit_data_with_cart_id_records::post_keywords           AS post_keywords,
		  hit_data_with_cart_id_records::post_mvvar1             AS post_mvvar1,
		  hit_data_with_cart_id_records::post_mvvar2             AS post_mvvar2,
		  hit_data_with_cart_id_records::post_mvvar3             AS post_mvvar3,
		  hit_data_with_cart_id_records::post_page_event         AS post_page_event,
		  hit_data_with_cart_id_records::post_page_event_var1    AS post_page_event_var1,
		  hit_data_with_cart_id_records::post_page_event_var2    AS post_page_event_var2,
		  hit_data_with_cart_id_records::post_page_event_var3    AS post_page_event_var3,
		  hit_data_with_cart_id_records::post_page_type          AS post_page_type,
		  hit_data_with_cart_id_records::post_page_url           AS post_page_url,
		  hit_data_with_cart_id_records::post_pagename           AS post_pagename,
		  hit_data_with_cart_id_records::post_pagename_no_url    AS post_pagename_no_url,  
		  hit_data_with_cart_id_records::post_partner_plugins    AS post_partner_plugins,
		  hit_data_with_cart_id_records::post_persistent_cookie  AS post_persistent_cookie,
		  hit_data_with_cart_id_records::post_product_list       AS post_product_list,
		  hit_data_with_cart_id_records::post_prop1           AS post_prop1,
		  hit_data_with_cart_id_records::post_prop10           AS post_prop10,
		  hit_data_with_cart_id_records::post_prop11          AS post_prop11,        
		  hit_data_with_cart_id_records::post_prop12          AS post_prop12,        
		  hit_data_with_cart_id_records::post_prop13          AS post_prop13,        
		  hit_data_with_cart_id_records::post_prop14          AS post_prop14,        
		  hit_data_with_cart_id_records::post_prop15          AS post_prop15,        
		  hit_data_with_cart_id_records::post_prop16          AS post_prop16,        
		  hit_data_with_cart_id_records::post_prop17          AS post_prop17,        
		  hit_data_with_cart_id_records::post_prop18          AS post_prop18,        
		  hit_data_with_cart_id_records::post_prop19          AS post_prop19,       
		  hit_data_with_cart_id_records::post_prop2           AS post_prop2,
		  hit_data_with_cart_id_records::post_prop20          AS post_prop20,        
		  hit_data_with_cart_id_records::post_prop21          AS post_prop21,        
		  hit_data_with_cart_id_records::post_prop22          AS post_prop22,        
		  hit_data_with_cart_id_records::post_prop23          AS post_prop23,        
		  hit_data_with_cart_id_records::post_prop24          AS post_prop24,        
		  hit_data_with_cart_id_records::post_prop25          AS post_prop25,        
		  hit_data_with_cart_id_records::post_prop26          AS post_prop26,        
		  hit_data_with_cart_id_records::post_prop27          AS post_prop27,        
		  hit_data_with_cart_id_records::post_prop28          AS post_prop28,        
		  hit_data_with_cart_id_records::post_prop29          AS post_prop29,        
		  hit_data_with_cart_id_records::post_prop3           AS post_prop3,
		  hit_data_with_cart_id_records::post_prop30          AS post_prop30,        
		  hit_data_with_cart_id_records::post_prop31          AS post_prop31,       
		  hit_data_with_cart_id_records::post_prop32          AS post_prop32,        
		  hit_data_with_cart_id_records::post_prop33          AS post_prop33,        
		  hit_data_with_cart_id_records::post_prop34          AS post_prop34,        
		  hit_data_with_cart_id_records::post_prop35          AS post_prop35,        
		  hit_data_with_cart_id_records::post_prop36          AS post_prop36,        
		  hit_data_with_cart_id_records::post_prop37          AS post_prop37,        
		  hit_data_with_cart_id_records::post_prop38          AS post_prop38,        
		  hit_data_with_cart_id_records::post_prop39          AS post_prop39,        
		  hit_data_with_cart_id_records::post_prop4           AS post_prop4,
		  hit_data_with_cart_id_records::post_prop40          AS post_prop40,        
		  hit_data_with_cart_id_records::post_prop41          AS post_prop41,        
		  hit_data_with_cart_id_records::post_prop42          AS post_prop42,        
		  hit_data_with_cart_id_records::post_prop43          AS post_prop43,        
		  hit_data_with_cart_id_records::post_prop44          AS post_prop44,        
		  hit_data_with_cart_id_records::post_prop45          AS post_prop45,        
		  hit_data_with_cart_id_records::post_prop46          AS post_prop46,        
		  hit_data_with_cart_id_records::post_prop47          AS post_prop47,        
		  hit_data_with_cart_id_records::post_prop48          AS post_prop48,        
		  hit_data_with_cart_id_records::post_prop49          AS post_prop49,        
		  hit_data_with_cart_id_records::post_prop5           AS post_prop5,
		  hit_data_with_cart_id_records::post_prop50          AS post_prop50,        
		  hit_data_with_cart_id_records::post_prop51          AS post_prop51,        
		  hit_data_with_cart_id_records::post_prop52          AS post_prop52,        
		  hit_data_with_cart_id_records::post_prop53          AS post_prop53,        
		  hit_data_with_cart_id_records::post_prop54          AS post_prop54,        
		  hit_data_with_cart_id_records::post_prop55          AS post_prop55,        
		  hit_data_with_cart_id_records::post_prop56          AS post_prop56,        
		  hit_data_with_cart_id_records::post_prop57          AS post_prop57,        
		  hit_data_with_cart_id_records::post_prop58          AS post_prop58,        
		  hit_data_with_cart_id_records::post_prop59          AS post_prop59,        
		  hit_data_with_cart_id_records::post_prop6           AS post_prop6,
		  hit_data_with_cart_id_records::post_prop60          AS post_prop60,        
		  hit_data_with_cart_id_records::post_prop61          AS post_prop61,        
		  hit_data_with_cart_id_records::post_prop62          AS post_prop62,        
		  hit_data_with_cart_id_records::post_prop63          AS post_prop63,        
		  hit_data_with_cart_id_records::post_prop64          AS post_prop64,       
		  hit_data_with_cart_id_records::post_prop65          AS post_prop65,        
		  hit_data_with_cart_id_records::post_prop66          AS post_prop66,    
		  hit_data_with_cart_id_records::post_prop67          AS post_prop67,        
		  hit_data_with_cart_id_records::post_prop68          AS post_prop68,        
		  hit_data_with_cart_id_records::post_prop69          AS post_prop69,
		  hit_data_with_cart_id_records::post_prop7           AS post_prop7,
		  hit_data_with_cart_id_records::post_prop70          AS post_prop70,        
		  hit_data_with_cart_id_records::post_prop71          AS post_prop71,        
		  hit_data_with_cart_id_records::post_prop72          AS post_prop72,        
		  hit_data_with_cart_id_records::post_prop73          AS post_prop73,        
		  hit_data_with_cart_id_records::post_prop74          AS post_prop74,        
		  hit_data_with_cart_id_records::post_prop75          AS post_prop75,        
		  hit_data_with_cart_id_records::post_prop8          AS post_prop8,
		  hit_data_with_cart_id_records::post_prop9           AS post_prop9,
		  hit_data_with_cart_id_records::post_purchaseid         AS post_purchaseid,
		  hit_data_with_cart_id_records::post_referrer          AS post_referrer,
		  hit_data_with_cart_id_records::post_search_engine      AS post_search_engine,      
		  hit_data_with_cart_id_records::post_state           AS post_state,      
		  hit_data_with_cart_id_records::post_survey          AS post_survey,
		  hit_data_with_cart_id_records::post_t_time_info        AS post_t_time_info,
		  hit_data_with_cart_id_records::post_tnt           AS post_tnt,        
		  hit_data_with_cart_id_records::post_transactionid      AS post_transactionid,                
		  hit_data_with_cart_id_records::post_visid_high     as post_visid_high ,
		  hit_data_with_cart_id_records::post_visid_low    as post_visid_low ,
		  hit_data_with_cart_id_records::post_visid_type         AS post_visid_type,         
		  hit_data_with_cart_id_records::post_zip           AS post_zip,                   
		  hit_data_with_cart_id_records::prev_page           AS prev_page,        
		  hit_data_with_cart_id_records::product_list          AS product_list,     
		  hit_data_with_cart_id_records::product_merchandising   AS product_merchandising,
		  hit_data_with_cart_id_records::prop1            AS prop1,  
		  hit_data_with_cart_id_records::prop10_custom_link                  AS prop10_custom_link,
		  hit_data_with_cart_id_records::prop11                  AS prop11,
		  hit_data_with_cart_id_records::prop12            AS prop12,
		  hit_data_with_cart_id_records::prop13            AS prop13,
		  hit_data_with_cart_id_records::prop14            AS prop14,
		  hit_data_with_cart_id_records::prop15            AS prop15,
		  hit_data_with_cart_id_records::prop16            AS prop16,
		  hit_data_with_cart_id_records::prop17            AS prop17,
		  hit_data_with_cart_id_records::prop18            AS prop18,
		  hit_data_with_cart_id_records::prop19            AS prop19,
		  hit_data_with_cart_id_records::prop2            AS prop2,
		  hit_data_with_cart_id_records::prop20            AS prop20,
		  hit_data_with_cart_id_records::prop21            AS prop21,
		  hit_data_with_cart_id_records::prop22           AS prop22,
		  hit_data_with_cart_id_records::prop23           AS prop23,
		  hit_data_with_cart_id_records::prop24           AS prop24,
		  hit_data_with_cart_id_records::prop25                  AS prop25,
		  hit_data_with_cart_id_records::prop26                  AS prop26,
		  hit_data_with_cart_id_records::prop27           AS prop27,
		  hit_data_with_cart_id_records::prop28           AS prop28,
		  hit_data_with_cart_id_records::prop29           AS prop29,
		  hit_data_with_cart_id_records::prop3            AS prop3,
		  hit_data_with_cart_id_records::prop30           AS prop30,
		  hit_data_with_cart_id_records::prop31           AS prop31,
		  hit_data_with_cart_id_records::prop32           AS prop32,
		  hit_data_with_cart_id_records::prop33           AS prop33,
		  hit_data_with_cart_id_records::prop34           AS prop34,  
		  hit_data_with_cart_id_records::prop35_opt_err_msg_desc                  AS prop35_opt_err_msg_desc,
		  hit_data_with_cart_id_records::prop36                  AS prop36,
		  hit_data_with_cart_id_records::prop37           AS prop37,
		  hit_data_with_cart_id_records::prop38           AS prop38,
		  hit_data_with_cart_id_records::prop39           AS prop39,
		  hit_data_with_cart_id_records::prop4            AS prop4,
		  hit_data_with_cart_id_records::prop40           AS prop40,
		hit_data_with_cart_id_records::prop41_lead_form_field      AS prop41_lead_form_field,
		hit_data_with_cart_id_records::prop42_order_form_field      AS prop42_order_form_field,
		hit_data_with_cart_id_records::prop43_checkout_form_field      AS prop43_checkout_form_field,
		 hit_data_with_cart_id_records::prop44_site_type      AS prop44_site_type,
		 hit_data_with_cart_id_records::prop45_page_type      AS prop45_page_type,
		  hit_data_with_cart_id_records::prop46           AS prop46,
		  hit_data_with_cart_id_records::prop47           AS prop47,
		  hit_data_with_cart_id_records::prop48           AS prop48,
		  hit_data_with_cart_id_records::prop49           AS prop49,
		  hit_data_with_cart_id_records::prop5            AS prop5,
		  hit_data_with_cart_id_records::prop50           AS prop50,
		  hit_data_with_cart_id_records::prop51           AS prop51,
		  hit_data_with_cart_id_records::prop52           AS prop52,
		  hit_data_with_cart_id_records::prop53           AS prop53,
		  hit_data_with_cart_id_records::prop54           AS prop54,
		  hit_data_with_cart_id_records::prop55           AS prop55,
		  hit_data_with_cart_id_records::prop56           AS prop56,
		  hit_data_with_cart_id_records::prop57           AS prop57,
		  hit_data_with_cart_id_records::prop58           AS prop58,
		  hit_data_with_cart_id_records::prop59           AS prop59,
		  hit_data_with_cart_id_records::prop6                     AS prop6,
		  hit_data_with_cart_id_records::prop60           AS prop60,
		  hit_data_with_cart_id_records::prop61           AS prop61,
		  hit_data_with_cart_id_records::prop62           AS prop62,
		  hit_data_with_cart_id_records::prop63           AS prop63,
		  hit_data_with_cart_id_records::prop64           AS prop64,
		  hit_data_with_cart_id_records::prop65           AS prop65,
		  hit_data_with_cart_id_records::prop66           AS prop66,
		  hit_data_with_cart_id_records::prop67           AS prop67,
		  hit_data_with_cart_id_records::prop68           AS prop68,
		  hit_data_with_cart_id_records::prop69           AS prop69,
		  hit_data_with_cart_id_records::prop7                     AS prop7,
		  hit_data_with_cart_id_records::prop70           AS prop70,
		  hit_data_with_cart_id_records::prop71           AS prop71,
		  hit_data_with_cart_id_records::prop72           AS prop72,
		  hit_data_with_cart_id_records::prop73           AS prop73,
		  hit_data_with_cart_id_records::prop74           AS prop74,
		  hit_data_with_cart_id_records::prop75           AS prop75,
		  hit_data_with_cart_id_records::prop8                    AS prop8,
		  hit_data_with_cart_id_records::prop9            AS prop9,    
		  hit_data_with_cart_id_records::quarterly_visitor       AS quarterly_visitor,       
		  hit_data_with_cart_id_records::ref_domain             AS ref_domain,
		  hit_data_with_cart_id_records::referrer                AS referrer,
		  hit_data_with_cart_id_records::referrer_type_fullname      AS   referrer_type_fullname,
		  hit_data_with_cart_id_records::referrer_type_id               AS referrer_type_id,
		  hit_data_with_cart_id_records::referrer_type_shortname     AS referrer_type_shortname,
		         hit_data_with_cart_id_records::resolution              AS resolution,
		  hit_data_with_cart_id_records::s_resolution          AS s_resolution, 
		  hit_data_with_cart_id_records::sampled_hit             AS sampled_hit,
		  hit_data_with_cart_id_records::search_engine_id           AS search_engine_id,
		  hit_data_with_cart_id_records::search_engine_name      AS search_engine_name,
		  hit_data_with_cart_id_records::search_page_num         AS search_page_num,
		  hit_data_with_cart_id_records::secondary_hit     AS secondary_hit,
		  hit_data_with_cart_id_records::service           AS service,         
		  hit_data_with_cart_id_records::site_section_id AS site_section_id, 
		  hit_data_with_cart_id_records::site_section_name                 AS site_section_name,
		  'omniture'              AS sourced_from_system,
		  hit_data_with_cart_id_records::sourceid           AS sourceid,       
		  hit_data_with_cart_id_records::state            AS state,        
		  hit_data_with_cart_id_records::stats_server          AS stats_server, 
		  hit_data_with_cart_id_records::suite_id                   AS suite_id,
		  hit_data_with_cart_id_records::t_time_info         AS t_time_info,
		  hit_data_with_cart_id_records::tnt            AS tnt,
		  hit_data_with_cart_id_records::tnt_post_vista          AS tnt_post_vista,                       
		  hit_data_with_cart_id_records::truncated_hit           AS truncated_hit,            
		  hit_data_with_cart_id_records::ua_color       AS ua_color,
		  hit_data_with_cart_id_records::ua_os            AS ua_os,
		  hit_data_with_cart_id_records::ua_pixels           AS ua_pixels,
		  hit_data_with_cart_id_records::user_agent           AS user_agent,
		  hit_data_with_cart_id_records::user_hash           AS user_hash,
		  hit_data_with_cart_id_records::user_server          AS user_server,
		  hit_data_with_cart_id_records::userid            AS userid,
		  hit_data_with_cart_id_records::username           AS username,  
		  hit_data_with_cart_id_records::va_closer_detail        AS va_closer_detail,
		  hit_data_with_cart_id_records::va_closer_id            AS va_closer_id,
		  hit_data_with_cart_id_records::va_finder_detail        AS va_finder_detail,
		  hit_data_with_cart_id_records::va_finder_id            AS va_finder_id,
		  hit_data_with_cart_id_records::va_instance_event       AS va_instance_event,
		  hit_data_with_cart_id_records::va_new_engagement       AS va_new_engagement,
		  hit_data_with_cart_id_records::visid_high           AS visid_high,
		  hit_data_with_cart_id_records::visid_low           AS visid_low,
		  hit_data_with_cart_id_records::visid_new           AS visid_new,
		  hit_data_with_cart_id_records::visid_timestamp         AS visid_timestamp,
		  hit_data_with_cart_id_records::visid_type           AS visid_type,
		  hit_data_with_cart_id_records::visit_date              AS visit_date,
		  hit_data_with_cart_id_records::visit_keywords          AS visit_keywords,
		  hit_data_with_cart_id_records::visit_num           AS visit_num,
		  hit_data_with_cart_id_records::visit_page_num          AS visit_page_num,
		  hit_data_with_cart_id_records::visit_referrer          AS visit_referrer,
		  hit_data_with_cart_id_records::visit_search_engine     AS visit_search_engine,  
		  hit_data_with_cart_id_records::visit_start_page_url    AS visit_start_page_url,
		  hit_data_with_cart_id_records::visit_start_pagename    AS visit_start_pagename,
		  hit_data_with_cart_id_records::visit_start_time_gmt    AS visit_start_time_gmt,
		  hit_data_with_cart_id_records::weekly_visitor          AS weekly_visitor,
		  hit_data_with_cart_id_records::yearly_visitor          AS yearly_visitor,
		  hit_data_with_cart_id_records::zip           AS zip,
		  hit_data_with_cart_id_records::site_type  AS site_type,
		  cart_id as cart_id,
		  (int) corp as corp,
		  dwelling_nbr as dwelling_nbr;

all_hit_dat_missing_corp_house_records = union onschema hit_data_without_corp_house_records, hit_data_missing_cart_id_records;

joined_multiple_corp_house_records = join all_hit_dat_missing_corp_house_records by CONCAT(CONCAT(CONCAT(post_visid_high,'||'),post_visid_low), 		
		CONCAT('||',ip)) left outer, 
		distinct_visid_high_low_ip_multiple_house_records by CONCAT(CONCAT(CONCAT(post_visid_high,'||'),post_visid_low), CONCAT('||',ip)); 		

split joined_multiple_corp_house_records into
	hit_data_missing_multiple_corp_house_records
	IF (distinct_visid_high_low_ip_multiple_house_records::post_visid_high is not null),
	single_corp_house_hit_data_records OTHERWISE;

hit_data_without_corp_house_single_records = foreach single_corp_house_hit_data_records generate
all_hit_dat_missing_corp_house_records::accept_language         AS accept_language,
all_hit_dat_missing_corp_house_records::browser_height          AS browser_height,
all_hit_dat_missing_corp_house_records::browser_id                 AS browser_id,
all_hit_dat_missing_corp_house_records::browser_name AS browser_name,
all_hit_dat_missing_corp_house_records::browser_width           AS browser_width, 
all_hit_dat_missing_corp_house_records::c_color                 AS c_color,
all_hit_dat_missing_corp_house_records::campaign                AS campaign,  
all_hit_dat_missing_corp_house_records::click_action            AS click_action,
all_hit_dat_missing_corp_house_records::click_action_type       AS click_action_type,
all_hit_dat_missing_corp_house_records::click_context           AS click_context,
all_hit_dat_missing_corp_house_records::click_context_type      AS click_context_type,
all_hit_dat_missing_corp_house_records::click_sourceid          AS click_sourceid,
all_hit_dat_missing_corp_house_records::click_tag               AS click_tag,
all_hit_dat_missing_corp_house_records::code_ver                AS code_ver,
all_hit_dat_missing_corp_house_records::color                   AS color,
all_hit_dat_missing_corp_house_records::connection_type AS connection_type,
all_hit_dat_missing_corp_house_records::connection_type_id AS connection_type_id,
all_hit_dat_missing_corp_house_records::cookies     AS cookies,  
all_hit_dat_missing_corp_house_records::country_id                 AS country_id,
all_hit_dat_missing_corp_house_records::country_name AS country_name,
all_hit_dat_missing_corp_house_records::ct_connect_type         AS ct_connect_type,
all_hit_dat_missing_corp_house_records::curr_factor             AS curr_factor,
all_hit_dat_missing_corp_house_records::curr_rate               AS curr_rate,
all_hit_dat_missing_corp_house_records::currency                AS currency,        
all_hit_dat_missing_corp_house_records::cust_hit_time_gmt       AS cust_hit_time_gmt,
all_hit_dat_missing_corp_house_records::cust_visid              AS cust_visid,    
all_hit_dat_missing_corp_house_records::daily_visitor           AS daily_visitor,
all_hit_dat_missing_corp_house_records::dtm_created         AS dtm_created, 
all_hit_dat_missing_corp_house_records::duplicate_events        AS duplicate_events,
all_hit_dat_missing_corp_house_records::duplicate_purchase      AS duplicate_purchase,  
all_hit_dat_missing_corp_house_records::duplicated_from         AS duplicated_from,   
all_hit_dat_missing_corp_house_records::evar1_pagename          AS evar1_pagename,
all_hit_dat_missing_corp_house_records::evar10_optimum_link                  AS evar10_optimum_link,
all_hit_dat_missing_corp_house_records::evar11                  AS evar11,
all_hit_dat_missing_corp_house_records::evar12_live_chat_click                  AS evar12_live_chat_click,
all_hit_dat_missing_corp_house_records::evar13            AS evar13,
all_hit_dat_missing_corp_house_records::evar14            AS evar14,
all_hit_dat_missing_corp_house_records::evar15            AS evar15,
all_hit_dat_missing_corp_house_records::evar16            AS evar16,  
all_hit_dat_missing_corp_house_records::evar17            AS evar17,
all_hit_dat_missing_corp_house_records::evar18            AS evar18,
all_hit_dat_missing_corp_house_records::evar19_site_language            AS evar19_site_language,
all_hit_dat_missing_corp_house_records::evar2_page_type                   AS evar2_page_type,
all_hit_dat_missing_corp_house_records::evar20            AS evar20,
all_hit_dat_missing_corp_house_records::evar21            AS evar21,
all_hit_dat_missing_corp_house_records::evar22_form_id            AS evar22_form_id,
all_hit_dat_missing_corp_house_records::evar23                  AS evar23,
all_hit_dat_missing_corp_house_records::evar24                  AS evar24,
all_hit_dat_missing_corp_house_records::evar25                  AS evar25,
all_hit_dat_missing_corp_house_records::evar26_external_campaign                  AS evar26_external_campaign,
all_hit_dat_missing_corp_house_records::evar27                  AS evar27,
all_hit_dat_missing_corp_house_records::evar28_live_call            AS evar28_live_call,
all_hit_dat_missing_corp_house_records::evar29_purchaseid         AS evar29_purchaseid,  
all_hit_dat_missing_corp_house_records::evar3_campaign_stacking                   AS evar3_campaign_stacking,
all_hit_dat_missing_corp_house_records::evar30            AS evar30,
all_hit_dat_missing_corp_house_records::evar31_lead_form_id            AS evar31_lead_form_id,
all_hit_dat_missing_corp_house_records::evar32_order_flow_id            AS evar32_order_flow_id,
all_hit_dat_missing_corp_house_records::evar33_checkout_id            AS evar33_checkout_id,
all_hit_dat_missing_corp_house_records::evar34            AS evar34,
all_hit_dat_missing_corp_house_records::evar35            AS evar35,
all_hit_dat_missing_corp_house_records::evar36_transactionid          AS evar36_transactionid,
all_hit_dat_missing_corp_house_records::evar37            AS evar37,
all_hit_dat_missing_corp_house_records::evar38            AS evar38,
all_hit_dat_missing_corp_house_records::evar39_site_type            AS evar39_site_type,
all_hit_dat_missing_corp_house_records::evar4                   AS evar4,
all_hit_dat_missing_corp_house_records::evar40            AS evar40,
all_hit_dat_missing_corp_house_records::evar41            AS evar41,
all_hit_dat_missing_corp_house_records::evar42                  AS evar42,
all_hit_dat_missing_corp_house_records::evar43                  AS evar43,
all_hit_dat_missing_corp_house_records::evar44                  AS evar44,
all_hit_dat_missing_corp_house_records::evar45            AS evar45,
all_hit_dat_missing_corp_house_records::evar46            AS evar46,
all_hit_dat_missing_corp_house_records::evar47            AS evar47,
all_hit_dat_missing_corp_house_records::evar48            AS evar48,
all_hit_dat_missing_corp_house_records::evar49            AS evar49,
all_hit_dat_missing_corp_house_records::evar5                   AS evar5,
all_hit_dat_missing_corp_house_records::evar50            AS evar50,
all_hit_dat_missing_corp_house_records::evar51            AS evar51,
all_hit_dat_missing_corp_house_records::evar52           AS evar52,
all_hit_dat_missing_corp_house_records::evar53            AS evar53,
all_hit_dat_missing_corp_house_records::evar54            AS evar54,
all_hit_dat_missing_corp_house_records::evar55           AS evar55,
all_hit_dat_missing_corp_house_records::evar56            AS evar56,
all_hit_dat_missing_corp_house_records::evar57            AS evar57,
all_hit_dat_missing_corp_house_records::evar58            AS evar58,
all_hit_dat_missing_corp_house_records::evar59            AS evar59,  
all_hit_dat_missing_corp_house_records::evar6                   AS evar6,
all_hit_dat_missing_corp_house_records::evar60            AS evar60,
all_hit_dat_missing_corp_house_records::evar61            AS evar61,
all_hit_dat_missing_corp_house_records::evar62            AS evar62,
all_hit_dat_missing_corp_house_records::evar63            AS evar63,
all_hit_dat_missing_corp_house_records::evar64            AS evar64,
all_hit_dat_missing_corp_house_records::evar65            AS evar65,
all_hit_dat_missing_corp_house_records::evar66            AS evar66,
all_hit_dat_missing_corp_house_records::evar67            AS evar67,
all_hit_dat_missing_corp_house_records::evar68            AS evar68,
all_hit_dat_missing_corp_house_records::evar69            AS evar69,
all_hit_dat_missing_corp_house_records::evar7                   AS evar7,
all_hit_dat_missing_corp_house_records::evar70            AS evar70,
all_hit_dat_missing_corp_house_records::evar71            AS evar71,
all_hit_dat_missing_corp_house_records::evar72            AS evar72,
all_hit_dat_missing_corp_house_records::evar73            AS evar73,
all_hit_dat_missing_corp_house_records::evar74            AS evar74,
all_hit_dat_missing_corp_house_records::evar75            AS evar75,
all_hit_dat_missing_corp_house_records::evar8_visitor_type                   AS evar8_visitor_type,
all_hit_dat_missing_corp_house_records::evar9                   AS evar9,
all_hit_dat_missing_corp_house_records::event_list           AS event_list,
all_hit_dat_missing_corp_house_records::exclude_hit          AS exclude_hit,
all_hit_dat_missing_corp_house_records::first_hit_page_url      AS first_hit_page_url,
all_hit_dat_missing_corp_house_records::first_hit_pagename      AS first_hit_pagename,  
all_hit_dat_missing_corp_house_records::first_hit_referrer      AS first_hit_referrer,
all_hit_dat_missing_corp_house_records::first_hit_time_gmt      AS first_hit_time_gmt,
all_hit_dat_missing_corp_house_records::geo_city           AS geo_city,
all_hit_dat_missing_corp_house_records::geo_country          AS geo_country,
all_hit_dat_missing_corp_house_records::geo_dma                 AS geo_dma,
all_hit_dat_missing_corp_house_records::geo_region              AS geo_region,
all_hit_dat_missing_corp_house_records::geo_zip                 AS geo_zip,
all_hit_dat_missing_corp_house_records::hier1                   AS hier1,
all_hit_dat_missing_corp_house_records::hier2            AS hier2,
all_hit_dat_missing_corp_house_records::hier3            AS hier3,
all_hit_dat_missing_corp_house_records::hier4            AS hier4,
all_hit_dat_missing_corp_house_records::hier5            AS hier5,
all_hit_dat_missing_corp_house_records::hit_source              AS hit_source,
all_hit_dat_missing_corp_house_records::hit_time_gmt          AS hit_time_gmt,  
all_hit_dat_missing_corp_house_records::hitid_high           AS hitid_high,
all_hit_dat_missing_corp_house_records::hitid_low           AS hitid_low,  
all_hit_dat_missing_corp_house_records::homepage           AS homepage,
all_hit_dat_missing_corp_house_records::hourly_visitor          AS hourly_visitor,  
all_hit_dat_missing_corp_house_records::ip             AS ip,             
all_hit_dat_missing_corp_house_records::ip2            AS ip2,    
all_hit_dat_missing_corp_house_records::isp_id    AS isp_id,
all_hit_dat_missing_corp_house_records::isp_name                  AS isp_name,
all_hit_dat_missing_corp_house_records::j_jscript               AS j_jscript,
all_hit_dat_missing_corp_house_records::java_enabled          AS java_enabled,
all_hit_dat_missing_corp_house_records::javascript_version  AS javascript_version,
all_hit_dat_missing_corp_house_records::javascript_version_id              AS javascript_version_id,  
all_hit_dat_missing_corp_house_records::language_id                AS language_id,
all_hit_dat_missing_corp_house_records::language_name   AS language_name,  
all_hit_dat_missing_corp_house_records::last_hit_time_gmt       AS last_hit_time_gmt,
all_hit_dat_missing_corp_house_records::last_purchase_num       AS last_purchase_num,       
all_hit_dat_missing_corp_house_records::last_purchase_time_gmt  AS last_purchase_time_gmt, 
all_hit_dat_missing_corp_house_records::mobile_id           AS mobile_id,
all_hit_dat_missing_corp_house_records::monthly_visitor         AS monthly_visitor,
all_hit_dat_missing_corp_house_records::mvvar1            AS mvvar1,
all_hit_dat_missing_corp_house_records::mvvar2            AS mvvar2,            
all_hit_dat_missing_corp_house_records::mvvar3            AS mvvar3,            
all_hit_dat_missing_corp_house_records::namespace           AS namespace,
all_hit_dat_missing_corp_house_records::new_visit               AS new_visit,
all_hit_dat_missing_corp_house_records::operating_system_id                      AS operating_system_id,
all_hit_dat_missing_corp_house_records::operating_system_name AS operating_system_name,  
all_hit_dat_missing_corp_house_records::opt_err_msg_id         AS opt_err_msg_id,  
all_hit_dat_missing_corp_house_records::p_plugins               AS p_plugins,
all_hit_dat_missing_corp_house_records::page_event              AS page_event,
all_hit_dat_missing_corp_house_records::page_event_var1         AS page_event_var1,         
all_hit_dat_missing_corp_house_records::page_event_var2         AS page_event_var2,         
all_hit_dat_missing_corp_house_records::page_event_var3         AS page_event_var3,  
all_hit_dat_missing_corp_house_records::page_name_id   AS page_name_id,
all_hit_dat_missing_corp_house_records::page_type           AS page_type,           
all_hit_dat_missing_corp_house_records::page_url           AS page_url,       
all_hit_dat_missing_corp_house_records::pagename    AS pagename,          
all_hit_dat_missing_corp_house_records::paid_search          AS paid_search,          
all_hit_dat_missing_corp_house_records::partner_plugins         AS partner_plugins,         
all_hit_dat_missing_corp_house_records::persistent_cookie       AS persistent_cookie,   
all_hit_dat_missing_corp_house_records::plugin_name             AS plugin_name,
all_hit_dat_missing_corp_house_records::plugins           AS plugins,           
all_hit_dat_missing_corp_house_records::post_browser_height     AS post_browser_height,     
all_hit_dat_missing_corp_house_records::post_browser_width      AS post_browser_width,      
all_hit_dat_missing_corp_house_records::post_campaign          AS  post_campaign ,         
all_hit_dat_missing_corp_house_records::post_channel          AS  post_channel,          
all_hit_dat_missing_corp_house_records::post_cookies          AS  post_cookies,          
all_hit_dat_missing_corp_house_records::post_currency          AS  post_currency,          
all_hit_dat_missing_corp_house_records::post_cust_hit_time_gmt  AS post_cust_hit_time_gmt,  
all_hit_dat_missing_corp_house_records::post_cust_visid         AS post_cust_visid,         
all_hit_dat_missing_corp_house_records::post_evar1           AS post_evar1,           
all_hit_dat_missing_corp_house_records::post_evar10          AS post_evar10,          
all_hit_dat_missing_corp_house_records::post_evar11          AS post_evar11,          
all_hit_dat_missing_corp_house_records::post_evar12          AS post_evar12,          
all_hit_dat_missing_corp_house_records::post_evar13          AS post_evar13,          
all_hit_dat_missing_corp_house_records::post_evar14          AS post_evar14,          
all_hit_dat_missing_corp_house_records::post_evar15          AS post_evar15,          
all_hit_dat_missing_corp_house_records::post_evar16          AS post_evar16,          
all_hit_dat_missing_corp_house_records::post_evar17          AS post_evar17,          
all_hit_dat_missing_corp_house_records::post_evar18          AS post_evar18,          
all_hit_dat_missing_corp_house_records::post_evar19          AS post_evar19,
all_hit_dat_missing_corp_house_records::post_evar2           AS post_evar2, 
all_hit_dat_missing_corp_house_records::post_evar20          AS post_evar20,          
all_hit_dat_missing_corp_house_records::post_evar21          AS post_evar21,          
all_hit_dat_missing_corp_house_records::post_evar22          AS post_evar22,          
all_hit_dat_missing_corp_house_records::post_evar23          AS post_evar23,          
all_hit_dat_missing_corp_house_records::post_evar24          AS post_evar24,          
all_hit_dat_missing_corp_house_records::post_evar25          AS post_evar25,          
all_hit_dat_missing_corp_house_records::post_evar26          AS post_evar26,          
all_hit_dat_missing_corp_house_records::post_evar27          AS post_evar27,          
all_hit_dat_missing_corp_house_records::post_evar28          AS post_evar28,          
all_hit_dat_missing_corp_house_records::post_evar29          AS post_evar29,  
all_hit_dat_missing_corp_house_records::post_evar3           AS post_evar3,  
all_hit_dat_missing_corp_house_records::post_evar30          AS post_evar30,          
all_hit_dat_missing_corp_house_records::post_evar31          AS post_evar31,          
all_hit_dat_missing_corp_house_records::post_evar32          AS post_evar32,          
all_hit_dat_missing_corp_house_records::post_evar33          AS post_evar33,          
all_hit_dat_missing_corp_house_records::post_evar34          AS post_evar34,          
all_hit_dat_missing_corp_house_records::post_evar35          AS post_evar35,          
all_hit_dat_missing_corp_house_records::post_evar36          AS post_evar36,          
all_hit_dat_missing_corp_house_records::post_evar37          AS post_evar37,          
all_hit_dat_missing_corp_house_records::post_evar38          AS post_evar38,          
all_hit_dat_missing_corp_house_records::post_evar39          AS post_evar39,            
all_hit_dat_missing_corp_house_records::post_evar4           AS post_evar4,
all_hit_dat_missing_corp_house_records::post_evar40          AS post_evar40,          
all_hit_dat_missing_corp_house_records::post_evar41          AS post_evar41,          
all_hit_dat_missing_corp_house_records::post_evar42          AS post_evar42,          
all_hit_dat_missing_corp_house_records::post_evar43          AS post_evar43,          
all_hit_dat_missing_corp_house_records::post_evar44          AS post_evar44,          
all_hit_dat_missing_corp_house_records::post_evar45          AS post_evar45,          
all_hit_dat_missing_corp_house_records::post_evar46          AS post_evar46,         
all_hit_dat_missing_corp_house_records::post_evar47          AS post_evar47,         
all_hit_dat_missing_corp_house_records::post_evar48          AS post_evar48,         
all_hit_dat_missing_corp_house_records::post_evar49          AS post_evar49,  
all_hit_dat_missing_corp_house_records::post_evar5           AS post_evar5,           
all_hit_dat_missing_corp_house_records::post_evar50          AS post_evar50,         
all_hit_dat_missing_corp_house_records::post_evar51          AS post_evar51,         
all_hit_dat_missing_corp_house_records::post_evar52          AS post_evar52,         
all_hit_dat_missing_corp_house_records::post_evar53          AS post_evar53,         
all_hit_dat_missing_corp_house_records::post_evar54          AS post_evar54,         
all_hit_dat_missing_corp_house_records::post_evar55          AS post_evar55,         
all_hit_dat_missing_corp_house_records::post_evar56          AS post_evar56,         
all_hit_dat_missing_corp_house_records::post_evar57          AS post_evar57,         
all_hit_dat_missing_corp_house_records::post_evar58          AS post_evar58,         
all_hit_dat_missing_corp_house_records::post_evar59          AS post_evar59,     
all_hit_dat_missing_corp_house_records::post_evar6           AS post_evar6,           
all_hit_dat_missing_corp_house_records::post_evar60          AS post_evar60,         
all_hit_dat_missing_corp_house_records::post_evar61          AS post_evar61,         
all_hit_dat_missing_corp_house_records::post_evar62          AS post_evar62,         
all_hit_dat_missing_corp_house_records::post_evar63          AS post_evar63,         
all_hit_dat_missing_corp_house_records::post_evar64          AS post_evar64,         
all_hit_dat_missing_corp_house_records::post_evar65          AS post_evar65,         
all_hit_dat_missing_corp_house_records::post_evar66          AS post_evar66,         
all_hit_dat_missing_corp_house_records::post_evar67          AS post_evar67,         
all_hit_dat_missing_corp_house_records::post_evar68          AS post_evar68,         
all_hit_dat_missing_corp_house_records::post_evar69          AS post_evar69,         
all_hit_dat_missing_corp_house_records::post_evar7           AS post_evar7,           
all_hit_dat_missing_corp_house_records::post_evar70          AS post_evar70,         
all_hit_dat_missing_corp_house_records::post_evar71          AS post_evar71,         
all_hit_dat_missing_corp_house_records::post_evar72           AS post_evar72,         
all_hit_dat_missing_corp_house_records::post_evar73          AS post_evar73,         
all_hit_dat_missing_corp_house_records::post_evar74          AS post_evar74,         
all_hit_dat_missing_corp_house_records::post_evar75          AS post_evar75,         
all_hit_dat_missing_corp_house_records::post_evar8           AS post_evar8,           
all_hit_dat_missing_corp_house_records::post_evar9           AS post_evar9,           
all_hit_dat_missing_corp_house_records::post_event_list         AS post_event_list,
all_hit_dat_missing_corp_house_records::post_hier1           AS post_hier1,
all_hit_dat_missing_corp_house_records::post_hier2           AS post_hier2,
all_hit_dat_missing_corp_house_records::post_hier3           AS post_hier3,
all_hit_dat_missing_corp_house_records::post_hier4           AS post_hier4,
all_hit_dat_missing_corp_house_records::post_hier5           AS post_hier5,
all_hit_dat_missing_corp_house_records::post_java_enabled       AS post_java_enabled,
all_hit_dat_missing_corp_house_records::post_keywords           AS post_keywords,
all_hit_dat_missing_corp_house_records::post_mvvar1             AS post_mvvar1,
all_hit_dat_missing_corp_house_records::post_mvvar2             AS post_mvvar2,
all_hit_dat_missing_corp_house_records::post_mvvar3             AS post_mvvar3,
all_hit_dat_missing_corp_house_records::post_page_event         AS post_page_event,
all_hit_dat_missing_corp_house_records::post_page_event_var1    AS post_page_event_var1,
all_hit_dat_missing_corp_house_records::post_page_event_var2    AS post_page_event_var2,
all_hit_dat_missing_corp_house_records::post_page_event_var3    AS post_page_event_var3,
all_hit_dat_missing_corp_house_records::post_page_type          AS post_page_type,
all_hit_dat_missing_corp_house_records::post_page_url           AS post_page_url,
all_hit_dat_missing_corp_house_records::post_pagename           AS post_pagename,
all_hit_dat_missing_corp_house_records::post_pagename_no_url    AS post_pagename_no_url,  
all_hit_dat_missing_corp_house_records::post_partner_plugins    AS post_partner_plugins,
all_hit_dat_missing_corp_house_records::post_persistent_cookie  AS post_persistent_cookie,
all_hit_dat_missing_corp_house_records::post_product_list       AS post_product_list,
all_hit_dat_missing_corp_house_records::post_prop1           AS post_prop1,
all_hit_dat_missing_corp_house_records::post_prop10           AS post_prop10,
all_hit_dat_missing_corp_house_records::post_prop11          AS post_prop11,        
all_hit_dat_missing_corp_house_records::post_prop12          AS post_prop12,        
all_hit_dat_missing_corp_house_records::post_prop13          AS post_prop13,        
all_hit_dat_missing_corp_house_records::post_prop14          AS post_prop14,        
all_hit_dat_missing_corp_house_records::post_prop15          AS post_prop15,        
all_hit_dat_missing_corp_house_records::post_prop16          AS post_prop16,        
all_hit_dat_missing_corp_house_records::post_prop17          AS post_prop17,        
all_hit_dat_missing_corp_house_records::post_prop18          AS post_prop18,        
all_hit_dat_missing_corp_house_records::post_prop19          AS post_prop19,       
all_hit_dat_missing_corp_house_records::post_prop2           AS post_prop2,
all_hit_dat_missing_corp_house_records::post_prop20          AS post_prop20,        
all_hit_dat_missing_corp_house_records::post_prop21          AS post_prop21,        
all_hit_dat_missing_corp_house_records::post_prop22          AS post_prop22,        
all_hit_dat_missing_corp_house_records::post_prop23          AS post_prop23,        
all_hit_dat_missing_corp_house_records::post_prop24          AS post_prop24,        
all_hit_dat_missing_corp_house_records::post_prop25          AS post_prop25,        
all_hit_dat_missing_corp_house_records::post_prop26          AS post_prop26,        
all_hit_dat_missing_corp_house_records::post_prop27          AS post_prop27,        
all_hit_dat_missing_corp_house_records::post_prop28          AS post_prop28,        
all_hit_dat_missing_corp_house_records::post_prop29          AS post_prop29,        
all_hit_dat_missing_corp_house_records::post_prop3           AS post_prop3,
all_hit_dat_missing_corp_house_records::post_prop30          AS post_prop30,        
all_hit_dat_missing_corp_house_records::post_prop31          AS post_prop31,       
all_hit_dat_missing_corp_house_records::post_prop32          AS post_prop32,        
all_hit_dat_missing_corp_house_records::post_prop33          AS post_prop33,        
all_hit_dat_missing_corp_house_records::post_prop34          AS post_prop34,        
all_hit_dat_missing_corp_house_records::post_prop35          AS post_prop35,        
all_hit_dat_missing_corp_house_records::post_prop36          AS post_prop36,        
all_hit_dat_missing_corp_house_records::post_prop37          AS post_prop37,        
all_hit_dat_missing_corp_house_records::post_prop38          AS post_prop38,        
all_hit_dat_missing_corp_house_records::post_prop39          AS post_prop39,        
all_hit_dat_missing_corp_house_records::post_prop4           AS post_prop4,
all_hit_dat_missing_corp_house_records::post_prop40          AS post_prop40,        
all_hit_dat_missing_corp_house_records::post_prop41          AS post_prop41,        
all_hit_dat_missing_corp_house_records::post_prop42          AS post_prop42,        
all_hit_dat_missing_corp_house_records::post_prop43          AS post_prop43,        
all_hit_dat_missing_corp_house_records::post_prop44          AS post_prop44,        
all_hit_dat_missing_corp_house_records::post_prop45          AS post_prop45,        
all_hit_dat_missing_corp_house_records::post_prop46          AS post_prop46,        
all_hit_dat_missing_corp_house_records::post_prop47          AS post_prop47,        
all_hit_dat_missing_corp_house_records::post_prop48          AS post_prop48,        
all_hit_dat_missing_corp_house_records::post_prop49          AS post_prop49,        
all_hit_dat_missing_corp_house_records::post_prop5           AS post_prop5,
all_hit_dat_missing_corp_house_records::post_prop50          AS post_prop50,        
all_hit_dat_missing_corp_house_records::post_prop51          AS post_prop51,        
all_hit_dat_missing_corp_house_records::post_prop52          AS post_prop52,        
all_hit_dat_missing_corp_house_records::post_prop53          AS post_prop53,        
all_hit_dat_missing_corp_house_records::post_prop54          AS post_prop54,        
all_hit_dat_missing_corp_house_records::post_prop55          AS post_prop55,        
all_hit_dat_missing_corp_house_records::post_prop56          AS post_prop56,        
all_hit_dat_missing_corp_house_records::post_prop57          AS post_prop57,        
all_hit_dat_missing_corp_house_records::post_prop58          AS post_prop58,        
all_hit_dat_missing_corp_house_records::post_prop59          AS post_prop59,        
all_hit_dat_missing_corp_house_records::post_prop6           AS post_prop6,
all_hit_dat_missing_corp_house_records::post_prop60          AS post_prop60,        
all_hit_dat_missing_corp_house_records::post_prop61          AS post_prop61,        
all_hit_dat_missing_corp_house_records::post_prop62          AS post_prop62,        
all_hit_dat_missing_corp_house_records::post_prop63          AS post_prop63,        
all_hit_dat_missing_corp_house_records::post_prop64          AS post_prop64,       
all_hit_dat_missing_corp_house_records::post_prop65          AS post_prop65,        
all_hit_dat_missing_corp_house_records::post_prop66          AS post_prop66,    
all_hit_dat_missing_corp_house_records::post_prop67          AS post_prop67,        
all_hit_dat_missing_corp_house_records::post_prop68          AS post_prop68,        
all_hit_dat_missing_corp_house_records::post_prop69          AS post_prop69,
all_hit_dat_missing_corp_house_records::post_prop7           AS post_prop7,
all_hit_dat_missing_corp_house_records::post_prop70          AS post_prop70,        
all_hit_dat_missing_corp_house_records::post_prop71          AS post_prop71,        
all_hit_dat_missing_corp_house_records::post_prop72          AS post_prop72,        
all_hit_dat_missing_corp_house_records::post_prop73          AS post_prop73,        
all_hit_dat_missing_corp_house_records::post_prop74          AS post_prop74,        
all_hit_dat_missing_corp_house_records::post_prop75          AS post_prop75,        
all_hit_dat_missing_corp_house_records::post_prop8          AS post_prop8,
all_hit_dat_missing_corp_house_records::post_prop9           AS post_prop9,
all_hit_dat_missing_corp_house_records::post_purchaseid         AS post_purchaseid,
all_hit_dat_missing_corp_house_records::post_referrer          AS post_referrer,
all_hit_dat_missing_corp_house_records::post_search_engine      AS post_search_engine,      
all_hit_dat_missing_corp_house_records::post_state           AS post_state,      
all_hit_dat_missing_corp_house_records::post_survey          AS post_survey,
all_hit_dat_missing_corp_house_records::post_t_time_info        AS post_t_time_info,
all_hit_dat_missing_corp_house_records::post_tnt           AS post_tnt,        
all_hit_dat_missing_corp_house_records::post_transactionid      AS post_transactionid,                
all_hit_dat_missing_corp_house_records::post_visid_high     as post_visid_high ,
all_hit_dat_missing_corp_house_records::post_visid_low    as post_visid_low ,
all_hit_dat_missing_corp_house_records::post_visid_type         AS post_visid_type,         
all_hit_dat_missing_corp_house_records::post_zip           AS post_zip,                   
all_hit_dat_missing_corp_house_records::prev_page           AS prev_page,        
all_hit_dat_missing_corp_house_records::product_list          AS product_list,     
all_hit_dat_missing_corp_house_records::product_merchandising   AS product_merchandising,
all_hit_dat_missing_corp_house_records::prop1            AS prop1,  
all_hit_dat_missing_corp_house_records::prop10_custom_link                  AS prop10_custom_link,
all_hit_dat_missing_corp_house_records::prop11                  AS prop11,
all_hit_dat_missing_corp_house_records::prop12            AS prop12,
all_hit_dat_missing_corp_house_records::prop13            AS prop13,
all_hit_dat_missing_corp_house_records::prop14            AS prop14,
all_hit_dat_missing_corp_house_records::prop15            AS prop15,
all_hit_dat_missing_corp_house_records::prop16            AS prop16,
all_hit_dat_missing_corp_house_records::prop17            AS prop17,
all_hit_dat_missing_corp_house_records::prop18            AS prop18,
all_hit_dat_missing_corp_house_records::prop19            AS prop19,
all_hit_dat_missing_corp_house_records::prop2            AS prop2,
all_hit_dat_missing_corp_house_records::prop20            AS prop20,
all_hit_dat_missing_corp_house_records::prop21            AS prop21,
all_hit_dat_missing_corp_house_records::prop22           AS prop22,
all_hit_dat_missing_corp_house_records::prop23           AS prop23,
all_hit_dat_missing_corp_house_records::prop24           AS prop24,
all_hit_dat_missing_corp_house_records::prop25                  AS prop25,
all_hit_dat_missing_corp_house_records::prop26                  AS prop26,
all_hit_dat_missing_corp_house_records::prop27           AS prop27,
all_hit_dat_missing_corp_house_records::prop28           AS prop28,
all_hit_dat_missing_corp_house_records::prop29           AS prop29,
all_hit_dat_missing_corp_house_records::prop3            AS prop3,
all_hit_dat_missing_corp_house_records::prop30           AS prop30,
all_hit_dat_missing_corp_house_records::prop31           AS prop31,
all_hit_dat_missing_corp_house_records::prop32           AS prop32,
all_hit_dat_missing_corp_house_records::prop33           AS prop33,
all_hit_dat_missing_corp_house_records::prop34           AS prop34,  
all_hit_dat_missing_corp_house_records::prop35_opt_err_msg_desc                  AS prop35_opt_err_msg_desc,
all_hit_dat_missing_corp_house_records::prop36                  AS prop36,
all_hit_dat_missing_corp_house_records::prop37           AS prop37,
all_hit_dat_missing_corp_house_records::prop38           AS prop38,
all_hit_dat_missing_corp_house_records::prop39           AS prop39,
all_hit_dat_missing_corp_house_records::prop4            AS prop4,
all_hit_dat_missing_corp_house_records::prop40           AS prop40,
all_hit_dat_missing_corp_house_records::prop41_lead_form_field      AS prop41_lead_form_field,
all_hit_dat_missing_corp_house_records::prop42_order_form_field      AS prop42_order_form_field,
all_hit_dat_missing_corp_house_records::prop43_checkout_form_field      AS prop43_checkout_form_field,
all_hit_dat_missing_corp_house_records::prop44_site_type      AS prop44_site_type,
all_hit_dat_missing_corp_house_records::prop45_page_type      AS prop45_page_type,
all_hit_dat_missing_corp_house_records::prop46           AS prop46,
all_hit_dat_missing_corp_house_records::prop47           AS prop47,
all_hit_dat_missing_corp_house_records::prop48           AS prop48,
all_hit_dat_missing_corp_house_records::prop49           AS prop49,
all_hit_dat_missing_corp_house_records::prop5            AS prop5,
all_hit_dat_missing_corp_house_records::prop50           AS prop50,
all_hit_dat_missing_corp_house_records::prop51           AS prop51,
all_hit_dat_missing_corp_house_records::prop52           AS prop52,
all_hit_dat_missing_corp_house_records::prop53           AS prop53,
all_hit_dat_missing_corp_house_records::prop54           AS prop54,
all_hit_dat_missing_corp_house_records::prop55           AS prop55,
all_hit_dat_missing_corp_house_records::prop56           AS prop56,
all_hit_dat_missing_corp_house_records::prop57           AS prop57,
all_hit_dat_missing_corp_house_records::prop58           AS prop58,
all_hit_dat_missing_corp_house_records::prop59           AS prop59,
all_hit_dat_missing_corp_house_records::prop6                     AS prop6,
all_hit_dat_missing_corp_house_records::prop60           AS prop60,
all_hit_dat_missing_corp_house_records::prop61           AS prop61,
all_hit_dat_missing_corp_house_records::prop62           AS prop62,
all_hit_dat_missing_corp_house_records::prop63           AS prop63,
all_hit_dat_missing_corp_house_records::prop64           AS prop64,
all_hit_dat_missing_corp_house_records::prop65           AS prop65,
all_hit_dat_missing_corp_house_records::prop66           AS prop66,
all_hit_dat_missing_corp_house_records::prop67           AS prop67,
all_hit_dat_missing_corp_house_records::prop68           AS prop68,
all_hit_dat_missing_corp_house_records::prop69           AS prop69,
all_hit_dat_missing_corp_house_records::prop7                     AS prop7,
all_hit_dat_missing_corp_house_records::prop70           AS prop70,
all_hit_dat_missing_corp_house_records::prop71           AS prop71,
all_hit_dat_missing_corp_house_records::prop72           AS prop72,
all_hit_dat_missing_corp_house_records::prop73           AS prop73,
all_hit_dat_missing_corp_house_records::prop74           AS prop74,
all_hit_dat_missing_corp_house_records::prop75           AS prop75,
all_hit_dat_missing_corp_house_records::prop8                    AS prop8,
all_hit_dat_missing_corp_house_records::prop9            AS prop9,    
all_hit_dat_missing_corp_house_records::quarterly_visitor       AS quarterly_visitor,       
all_hit_dat_missing_corp_house_records::ref_domain             AS ref_domain,
all_hit_dat_missing_corp_house_records::referrer                AS referrer,
all_hit_dat_missing_corp_house_records::referrer_type_fullname      AS   referrer_type_fullname,
all_hit_dat_missing_corp_house_records::referrer_type_id               AS referrer_type_id,
all_hit_dat_missing_corp_house_records::referrer_type_shortname     AS referrer_type_shortname,
all_hit_dat_missing_corp_house_records::resolution              AS resolution,
all_hit_dat_missing_corp_house_records::s_resolution          AS s_resolution, 
all_hit_dat_missing_corp_house_records::sampled_hit             AS sampled_hit,
all_hit_dat_missing_corp_house_records::search_engine_id           AS search_engine_id,
all_hit_dat_missing_corp_house_records::search_engine_name      AS search_engine_name,
all_hit_dat_missing_corp_house_records::search_page_num         AS search_page_num,
all_hit_dat_missing_corp_house_records::secondary_hit     AS secondary_hit,
all_hit_dat_missing_corp_house_records::service           AS service,         
all_hit_dat_missing_corp_house_records::site_section_id AS site_section_id, 
all_hit_dat_missing_corp_house_records::site_section_name                 AS site_section_name,
'omniture'              AS sourced_from_system,
all_hit_dat_missing_corp_house_records::sourceid           AS sourceid,       
all_hit_dat_missing_corp_house_records::state            AS state,        
all_hit_dat_missing_corp_house_records::stats_server          AS stats_server, 
all_hit_dat_missing_corp_house_records::suite_id                   AS suite_id,
all_hit_dat_missing_corp_house_records::t_time_info         AS t_time_info,
all_hit_dat_missing_corp_house_records::tnt            AS tnt,
all_hit_dat_missing_corp_house_records::tnt_post_vista          AS tnt_post_vista,                       
all_hit_dat_missing_corp_house_records::truncated_hit           AS truncated_hit,            
all_hit_dat_missing_corp_house_records::ua_color       AS ua_color,
all_hit_dat_missing_corp_house_records::ua_os            AS ua_os,
all_hit_dat_missing_corp_house_records::ua_pixels           AS ua_pixels,
all_hit_dat_missing_corp_house_records::user_agent           AS user_agent,
all_hit_dat_missing_corp_house_records::user_hash           AS user_hash,
all_hit_dat_missing_corp_house_records::user_server          AS user_server,
all_hit_dat_missing_corp_house_records::userid            AS userid,
all_hit_dat_missing_corp_house_records::username           AS username,  
all_hit_dat_missing_corp_house_records::va_closer_detail        AS va_closer_detail,
all_hit_dat_missing_corp_house_records::va_closer_id            AS va_closer_id,
all_hit_dat_missing_corp_house_records::va_finder_detail        AS va_finder_detail,
all_hit_dat_missing_corp_house_records::va_finder_id            AS va_finder_id,
all_hit_dat_missing_corp_house_records::va_instance_event       AS va_instance_event,
all_hit_dat_missing_corp_house_records::va_new_engagement       AS va_new_engagement,
all_hit_dat_missing_corp_house_records::visid_high           AS visid_high,
all_hit_dat_missing_corp_house_records::visid_low           AS visid_low,
all_hit_dat_missing_corp_house_records::visid_new           AS visid_new,
all_hit_dat_missing_corp_house_records::visid_timestamp         AS visid_timestamp,
all_hit_dat_missing_corp_house_records::visid_type           AS visid_type,
all_hit_dat_missing_corp_house_records::visit_date              AS visit_date,
all_hit_dat_missing_corp_house_records::visit_keywords          AS visit_keywords,
all_hit_dat_missing_corp_house_records::visit_num           AS visit_num,
all_hit_dat_missing_corp_house_records::visit_page_num          AS visit_page_num,
all_hit_dat_missing_corp_house_records::visit_referrer          AS visit_referrer,
all_hit_dat_missing_corp_house_records::visit_search_engine     AS visit_search_engine,  
all_hit_dat_missing_corp_house_records::visit_start_page_url    AS visit_start_page_url,
all_hit_dat_missing_corp_house_records::visit_start_pagename    AS visit_start_pagename,
all_hit_dat_missing_corp_house_records::visit_start_time_gmt    AS visit_start_time_gmt,
all_hit_dat_missing_corp_house_records::weekly_visitor          AS weekly_visitor,
all_hit_dat_missing_corp_house_records::yearly_visitor          AS yearly_visitor,
all_hit_dat_missing_corp_house_records::zip           AS zip,
all_hit_dat_missing_corp_house_records::site_type  AS site_type,
all_hit_dat_missing_corp_house_records::cart_id as cart_id,
(int) all_hit_dat_missing_corp_house_records::corp as corp,
all_hit_dat_missing_corp_house_records::dwelling_nbr as dwelling_nbr;




hit_data_without_corp_house_multiple_records = foreach hit_data_missing_multiple_corp_house_records generate 
	all_hit_dat_missing_corp_house_records::accept_language         AS accept_language,
all_hit_dat_missing_corp_house_records::browser_height          AS browser_height,
all_hit_dat_missing_corp_house_records::browser_id                 AS browser_id,
all_hit_dat_missing_corp_house_records::browser_name AS browser_name,
all_hit_dat_missing_corp_house_records::browser_width           AS browser_width, 
all_hit_dat_missing_corp_house_records::c_color                 AS c_color,
all_hit_dat_missing_corp_house_records::campaign                AS campaign,  
all_hit_dat_missing_corp_house_records::click_action            AS click_action,
all_hit_dat_missing_corp_house_records::click_action_type       AS click_action_type,
all_hit_dat_missing_corp_house_records::click_context           AS click_context,
all_hit_dat_missing_corp_house_records::click_context_type      AS click_context_type,
all_hit_dat_missing_corp_house_records::click_sourceid          AS click_sourceid,
all_hit_dat_missing_corp_house_records::click_tag               AS click_tag,
all_hit_dat_missing_corp_house_records::code_ver                AS code_ver,
all_hit_dat_missing_corp_house_records::color                   AS color,
all_hit_dat_missing_corp_house_records::connection_type AS connection_type,
all_hit_dat_missing_corp_house_records::connection_type_id AS connection_type_id,
all_hit_dat_missing_corp_house_records::cookies     AS cookies,  
all_hit_dat_missing_corp_house_records::country_id                 AS country_id,
all_hit_dat_missing_corp_house_records::country_name AS country_name,
all_hit_dat_missing_corp_house_records::ct_connect_type         AS ct_connect_type,
all_hit_dat_missing_corp_house_records::curr_factor             AS curr_factor,
all_hit_dat_missing_corp_house_records::curr_rate               AS curr_rate,
all_hit_dat_missing_corp_house_records::currency                AS currency,        
all_hit_dat_missing_corp_house_records::cust_hit_time_gmt       AS cust_hit_time_gmt,
all_hit_dat_missing_corp_house_records::cust_visid              AS cust_visid,    
all_hit_dat_missing_corp_house_records::daily_visitor           AS daily_visitor,
all_hit_dat_missing_corp_house_records::dtm_created         AS dtm_created, 
all_hit_dat_missing_corp_house_records::duplicate_events        AS duplicate_events,
all_hit_dat_missing_corp_house_records::duplicate_purchase      AS duplicate_purchase,  
all_hit_dat_missing_corp_house_records::duplicated_from         AS duplicated_from,   
all_hit_dat_missing_corp_house_records::evar1_pagename          AS evar1_pagename,
all_hit_dat_missing_corp_house_records::evar10_optimum_link                  AS evar10_optimum_link,
all_hit_dat_missing_corp_house_records::evar11                  AS evar11,
all_hit_dat_missing_corp_house_records::evar12_live_chat_click                  AS evar12_live_chat_click,
all_hit_dat_missing_corp_house_records::evar13            AS evar13,
all_hit_dat_missing_corp_house_records::evar14            AS evar14,
all_hit_dat_missing_corp_house_records::evar15            AS evar15,
all_hit_dat_missing_corp_house_records::evar16            AS evar16,  
all_hit_dat_missing_corp_house_records::evar17            AS evar17,
all_hit_dat_missing_corp_house_records::evar18            AS evar18,
all_hit_dat_missing_corp_house_records::evar19_site_language            AS evar19_site_language,
all_hit_dat_missing_corp_house_records::evar2_page_type                   AS evar2_page_type,
all_hit_dat_missing_corp_house_records::evar20            AS evar20,
all_hit_dat_missing_corp_house_records::evar21            AS evar21,
all_hit_dat_missing_corp_house_records::evar22_form_id            AS evar22_form_id,
all_hit_dat_missing_corp_house_records::evar23                  AS evar23,
all_hit_dat_missing_corp_house_records::evar24                  AS evar24,
all_hit_dat_missing_corp_house_records::evar25                  AS evar25,
all_hit_dat_missing_corp_house_records::evar26_external_campaign                  AS evar26_external_campaign,
all_hit_dat_missing_corp_house_records::evar27                  AS evar27,
all_hit_dat_missing_corp_house_records::evar28_live_call            AS evar28_live_call,
all_hit_dat_missing_corp_house_records::evar29_purchaseid         AS evar29_purchaseid,  
all_hit_dat_missing_corp_house_records::evar3_campaign_stacking                   AS evar3_campaign_stacking,
all_hit_dat_missing_corp_house_records::evar30            AS evar30,
all_hit_dat_missing_corp_house_records::evar31_lead_form_id            AS evar31_lead_form_id,
all_hit_dat_missing_corp_house_records::evar32_order_flow_id            AS evar32_order_flow_id,
all_hit_dat_missing_corp_house_records::evar33_checkout_id            AS evar33_checkout_id,
all_hit_dat_missing_corp_house_records::evar34            AS evar34,
all_hit_dat_missing_corp_house_records::evar35            AS evar35,
all_hit_dat_missing_corp_house_records::evar36_transactionid          AS evar36_transactionid,
all_hit_dat_missing_corp_house_records::evar37            AS evar37,
all_hit_dat_missing_corp_house_records::evar38            AS evar38,
all_hit_dat_missing_corp_house_records::evar39_site_type            AS evar39_site_type,
all_hit_dat_missing_corp_house_records::evar4                   AS evar4,
all_hit_dat_missing_corp_house_records::evar40            AS evar40,
all_hit_dat_missing_corp_house_records::evar41            AS evar41,
all_hit_dat_missing_corp_house_records::evar42                  AS evar42,
all_hit_dat_missing_corp_house_records::evar43                  AS evar43,
all_hit_dat_missing_corp_house_records::evar44                  AS evar44,
all_hit_dat_missing_corp_house_records::evar45            AS evar45,
all_hit_dat_missing_corp_house_records::evar46            AS evar46,
all_hit_dat_missing_corp_house_records::evar47            AS evar47,
all_hit_dat_missing_corp_house_records::evar48            AS evar48,
all_hit_dat_missing_corp_house_records::evar49            AS evar49,
all_hit_dat_missing_corp_house_records::evar5                   AS evar5,
all_hit_dat_missing_corp_house_records::evar50            AS evar50,
all_hit_dat_missing_corp_house_records::evar51            AS evar51,
all_hit_dat_missing_corp_house_records::evar52           AS evar52,
all_hit_dat_missing_corp_house_records::evar53            AS evar53,
all_hit_dat_missing_corp_house_records::evar54            AS evar54,
all_hit_dat_missing_corp_house_records::evar55           AS evar55,
all_hit_dat_missing_corp_house_records::evar56            AS evar56,
all_hit_dat_missing_corp_house_records::evar57            AS evar57,
all_hit_dat_missing_corp_house_records::evar58            AS evar58,
all_hit_dat_missing_corp_house_records::evar59            AS evar59,  
all_hit_dat_missing_corp_house_records::evar6                   AS evar6,
all_hit_dat_missing_corp_house_records::evar60            AS evar60,
all_hit_dat_missing_corp_house_records::evar61            AS evar61,
all_hit_dat_missing_corp_house_records::evar62            AS evar62,
all_hit_dat_missing_corp_house_records::evar63            AS evar63,
all_hit_dat_missing_corp_house_records::evar64            AS evar64,
all_hit_dat_missing_corp_house_records::evar65            AS evar65,
all_hit_dat_missing_corp_house_records::evar66            AS evar66,
all_hit_dat_missing_corp_house_records::evar67            AS evar67,
all_hit_dat_missing_corp_house_records::evar68            AS evar68,
all_hit_dat_missing_corp_house_records::evar69            AS evar69,
all_hit_dat_missing_corp_house_records::evar7                   AS evar7,
all_hit_dat_missing_corp_house_records::evar70            AS evar70,
all_hit_dat_missing_corp_house_records::evar71            AS evar71,
all_hit_dat_missing_corp_house_records::evar72            AS evar72,
all_hit_dat_missing_corp_house_records::evar73            AS evar73,
all_hit_dat_missing_corp_house_records::evar74            AS evar74,
all_hit_dat_missing_corp_house_records::evar75            AS evar75,
all_hit_dat_missing_corp_house_records::evar8_visitor_type                   AS evar8_visitor_type,
all_hit_dat_missing_corp_house_records::evar9                   AS evar9,
all_hit_dat_missing_corp_house_records::event_list           AS event_list,
all_hit_dat_missing_corp_house_records::exclude_hit          AS exclude_hit,
all_hit_dat_missing_corp_house_records::first_hit_page_url      AS first_hit_page_url,
all_hit_dat_missing_corp_house_records::first_hit_pagename      AS first_hit_pagename,  
all_hit_dat_missing_corp_house_records::first_hit_referrer      AS first_hit_referrer,
all_hit_dat_missing_corp_house_records::first_hit_time_gmt      AS first_hit_time_gmt,
all_hit_dat_missing_corp_house_records::geo_city           AS geo_city,
all_hit_dat_missing_corp_house_records::geo_country          AS geo_country,
all_hit_dat_missing_corp_house_records::geo_dma                 AS geo_dma,
all_hit_dat_missing_corp_house_records::geo_region              AS geo_region,
all_hit_dat_missing_corp_house_records::geo_zip                 AS geo_zip,
all_hit_dat_missing_corp_house_records::hier1                   AS hier1,
all_hit_dat_missing_corp_house_records::hier2            AS hier2,
all_hit_dat_missing_corp_house_records::hier3            AS hier3,
all_hit_dat_missing_corp_house_records::hier4            AS hier4,
all_hit_dat_missing_corp_house_records::hier5            AS hier5,
all_hit_dat_missing_corp_house_records::hit_source              AS hit_source,
all_hit_dat_missing_corp_house_records::hit_time_gmt          AS hit_time_gmt,  
all_hit_dat_missing_corp_house_records::hitid_high           AS hitid_high,
all_hit_dat_missing_corp_house_records::hitid_low           AS hitid_low,  
all_hit_dat_missing_corp_house_records::homepage           AS homepage,
all_hit_dat_missing_corp_house_records::hourly_visitor          AS hourly_visitor,  
all_hit_dat_missing_corp_house_records::ip             AS ip,             
all_hit_dat_missing_corp_house_records::ip2            AS ip2,    
all_hit_dat_missing_corp_house_records::isp_id    AS isp_id,
all_hit_dat_missing_corp_house_records::isp_name                  AS isp_name,
all_hit_dat_missing_corp_house_records::j_jscript               AS j_jscript,
all_hit_dat_missing_corp_house_records::java_enabled          AS java_enabled,
all_hit_dat_missing_corp_house_records::javascript_version  AS javascript_version,
all_hit_dat_missing_corp_house_records::javascript_version_id              AS javascript_version_id,  
all_hit_dat_missing_corp_house_records::language_id                AS language_id,
all_hit_dat_missing_corp_house_records::language_name   AS language_name,  
all_hit_dat_missing_corp_house_records::last_hit_time_gmt       AS last_hit_time_gmt,
all_hit_dat_missing_corp_house_records::last_purchase_num       AS last_purchase_num,       
all_hit_dat_missing_corp_house_records::last_purchase_time_gmt  AS last_purchase_time_gmt, 
all_hit_dat_missing_corp_house_records::mobile_id           AS mobile_id,
all_hit_dat_missing_corp_house_records::monthly_visitor         AS monthly_visitor,
all_hit_dat_missing_corp_house_records::mvvar1            AS mvvar1,
all_hit_dat_missing_corp_house_records::mvvar2            AS mvvar2,            
all_hit_dat_missing_corp_house_records::mvvar3            AS mvvar3,            
all_hit_dat_missing_corp_house_records::namespace           AS namespace,
all_hit_dat_missing_corp_house_records::new_visit               AS new_visit,
all_hit_dat_missing_corp_house_records::operating_system_id                      AS operating_system_id,
all_hit_dat_missing_corp_house_records::operating_system_name AS operating_system_name,  
all_hit_dat_missing_corp_house_records::opt_err_msg_id         AS opt_err_msg_id,  
all_hit_dat_missing_corp_house_records::p_plugins               AS p_plugins,
all_hit_dat_missing_corp_house_records::page_event              AS page_event,
all_hit_dat_missing_corp_house_records::page_event_var1         AS page_event_var1,         
all_hit_dat_missing_corp_house_records::page_event_var2         AS page_event_var2,         
all_hit_dat_missing_corp_house_records::page_event_var3         AS page_event_var3,  
all_hit_dat_missing_corp_house_records::page_name_id   AS page_name_id,
all_hit_dat_missing_corp_house_records::page_type           AS page_type,           
all_hit_dat_missing_corp_house_records::page_url           AS page_url,       
all_hit_dat_missing_corp_house_records::pagename    AS pagename,          
all_hit_dat_missing_corp_house_records::paid_search          AS paid_search,          
all_hit_dat_missing_corp_house_records::partner_plugins         AS partner_plugins,         
all_hit_dat_missing_corp_house_records::persistent_cookie       AS persistent_cookie,   
all_hit_dat_missing_corp_house_records::plugin_name             AS plugin_name,
all_hit_dat_missing_corp_house_records::plugins           AS plugins,           
all_hit_dat_missing_corp_house_records::post_browser_height     AS post_browser_height,     
all_hit_dat_missing_corp_house_records::post_browser_width      AS post_browser_width,      
all_hit_dat_missing_corp_house_records::post_campaign          AS  post_campaign ,         
all_hit_dat_missing_corp_house_records::post_channel          AS  post_channel,          
all_hit_dat_missing_corp_house_records::post_cookies          AS  post_cookies,          
all_hit_dat_missing_corp_house_records::post_currency          AS  post_currency,          
all_hit_dat_missing_corp_house_records::post_cust_hit_time_gmt  AS post_cust_hit_time_gmt,  
all_hit_dat_missing_corp_house_records::post_cust_visid         AS post_cust_visid,         
all_hit_dat_missing_corp_house_records::post_evar1           AS post_evar1,           
all_hit_dat_missing_corp_house_records::post_evar10          AS post_evar10,          
all_hit_dat_missing_corp_house_records::post_evar11          AS post_evar11,          
all_hit_dat_missing_corp_house_records::post_evar12          AS post_evar12,          
all_hit_dat_missing_corp_house_records::post_evar13          AS post_evar13,          
all_hit_dat_missing_corp_house_records::post_evar14          AS post_evar14,          
all_hit_dat_missing_corp_house_records::post_evar15          AS post_evar15,          
all_hit_dat_missing_corp_house_records::post_evar16          AS post_evar16,          
all_hit_dat_missing_corp_house_records::post_evar17          AS post_evar17,          
all_hit_dat_missing_corp_house_records::post_evar18          AS post_evar18,          
all_hit_dat_missing_corp_house_records::post_evar19          AS post_evar19,
all_hit_dat_missing_corp_house_records::post_evar2           AS post_evar2, 
all_hit_dat_missing_corp_house_records::post_evar20          AS post_evar20,          
all_hit_dat_missing_corp_house_records::post_evar21          AS post_evar21,          
all_hit_dat_missing_corp_house_records::post_evar22          AS post_evar22,          
all_hit_dat_missing_corp_house_records::post_evar23          AS post_evar23,          
all_hit_dat_missing_corp_house_records::post_evar24          AS post_evar24,          
all_hit_dat_missing_corp_house_records::post_evar25          AS post_evar25,          
all_hit_dat_missing_corp_house_records::post_evar26          AS post_evar26,          
all_hit_dat_missing_corp_house_records::post_evar27          AS post_evar27,          
all_hit_dat_missing_corp_house_records::post_evar28          AS post_evar28,          
all_hit_dat_missing_corp_house_records::post_evar29          AS post_evar29,  
all_hit_dat_missing_corp_house_records::post_evar3           AS post_evar3,  
all_hit_dat_missing_corp_house_records::post_evar30          AS post_evar30,          
all_hit_dat_missing_corp_house_records::post_evar31          AS post_evar31,          
all_hit_dat_missing_corp_house_records::post_evar32          AS post_evar32,          
all_hit_dat_missing_corp_house_records::post_evar33          AS post_evar33,          
all_hit_dat_missing_corp_house_records::post_evar34          AS post_evar34,          
all_hit_dat_missing_corp_house_records::post_evar35          AS post_evar35,          
all_hit_dat_missing_corp_house_records::post_evar36          AS post_evar36,          
all_hit_dat_missing_corp_house_records::post_evar37          AS post_evar37,          
all_hit_dat_missing_corp_house_records::post_evar38          AS post_evar38,          
all_hit_dat_missing_corp_house_records::post_evar39          AS post_evar39,            
all_hit_dat_missing_corp_house_records::post_evar4           AS post_evar4,
all_hit_dat_missing_corp_house_records::post_evar40          AS post_evar40,          
all_hit_dat_missing_corp_house_records::post_evar41          AS post_evar41,          
all_hit_dat_missing_corp_house_records::post_evar42          AS post_evar42,          
all_hit_dat_missing_corp_house_records::post_evar43          AS post_evar43,          
all_hit_dat_missing_corp_house_records::post_evar44          AS post_evar44,          
all_hit_dat_missing_corp_house_records::post_evar45          AS post_evar45,          
all_hit_dat_missing_corp_house_records::post_evar46          AS post_evar46,         
all_hit_dat_missing_corp_house_records::post_evar47          AS post_evar47,         
all_hit_dat_missing_corp_house_records::post_evar48          AS post_evar48,         
all_hit_dat_missing_corp_house_records::post_evar49          AS post_evar49,  
all_hit_dat_missing_corp_house_records::post_evar5           AS post_evar5,           
all_hit_dat_missing_corp_house_records::post_evar50          AS post_evar50,         
all_hit_dat_missing_corp_house_records::post_evar51          AS post_evar51,         
all_hit_dat_missing_corp_house_records::post_evar52          AS post_evar52,         
all_hit_dat_missing_corp_house_records::post_evar53          AS post_evar53,         
all_hit_dat_missing_corp_house_records::post_evar54          AS post_evar54,         
all_hit_dat_missing_corp_house_records::post_evar55          AS post_evar55,         
all_hit_dat_missing_corp_house_records::post_evar56          AS post_evar56,         
all_hit_dat_missing_corp_house_records::post_evar57          AS post_evar57,         
all_hit_dat_missing_corp_house_records::post_evar58          AS post_evar58,         
all_hit_dat_missing_corp_house_records::post_evar59          AS post_evar59,     
all_hit_dat_missing_corp_house_records::post_evar6           AS post_evar6,           
all_hit_dat_missing_corp_house_records::post_evar60          AS post_evar60,         
all_hit_dat_missing_corp_house_records::post_evar61          AS post_evar61,         
all_hit_dat_missing_corp_house_records::post_evar62          AS post_evar62,         
all_hit_dat_missing_corp_house_records::post_evar63          AS post_evar63,         
all_hit_dat_missing_corp_house_records::post_evar64          AS post_evar64,         
all_hit_dat_missing_corp_house_records::post_evar65          AS post_evar65,         
all_hit_dat_missing_corp_house_records::post_evar66          AS post_evar66,         
all_hit_dat_missing_corp_house_records::post_evar67          AS post_evar67,         
all_hit_dat_missing_corp_house_records::post_evar68          AS post_evar68,         
all_hit_dat_missing_corp_house_records::post_evar69          AS post_evar69,         
all_hit_dat_missing_corp_house_records::post_evar7           AS post_evar7,           
all_hit_dat_missing_corp_house_records::post_evar70          AS post_evar70,         
all_hit_dat_missing_corp_house_records::post_evar71          AS post_evar71,         
all_hit_dat_missing_corp_house_records::post_evar72           AS post_evar72,         
all_hit_dat_missing_corp_house_records::post_evar73          AS post_evar73,         
all_hit_dat_missing_corp_house_records::post_evar74          AS post_evar74,         
all_hit_dat_missing_corp_house_records::post_evar75          AS post_evar75,         
all_hit_dat_missing_corp_house_records::post_evar8           AS post_evar8,           
all_hit_dat_missing_corp_house_records::post_evar9           AS post_evar9,           
all_hit_dat_missing_corp_house_records::post_event_list         AS post_event_list,
all_hit_dat_missing_corp_house_records::post_hier1           AS post_hier1,
all_hit_dat_missing_corp_house_records::post_hier2           AS post_hier2,
all_hit_dat_missing_corp_house_records::post_hier3           AS post_hier3,
all_hit_dat_missing_corp_house_records::post_hier4           AS post_hier4,
all_hit_dat_missing_corp_house_records::post_hier5           AS post_hier5,
all_hit_dat_missing_corp_house_records::post_java_enabled       AS post_java_enabled,
all_hit_dat_missing_corp_house_records::post_keywords           AS post_keywords,
all_hit_dat_missing_corp_house_records::post_mvvar1             AS post_mvvar1,
all_hit_dat_missing_corp_house_records::post_mvvar2             AS post_mvvar2,
all_hit_dat_missing_corp_house_records::post_mvvar3             AS post_mvvar3,
all_hit_dat_missing_corp_house_records::post_page_event         AS post_page_event,
all_hit_dat_missing_corp_house_records::post_page_event_var1    AS post_page_event_var1,
all_hit_dat_missing_corp_house_records::post_page_event_var2    AS post_page_event_var2,
all_hit_dat_missing_corp_house_records::post_page_event_var3    AS post_page_event_var3,
all_hit_dat_missing_corp_house_records::post_page_type          AS post_page_type,
all_hit_dat_missing_corp_house_records::post_page_url           AS post_page_url,
all_hit_dat_missing_corp_house_records::post_pagename           AS post_pagename,
all_hit_dat_missing_corp_house_records::post_pagename_no_url    AS post_pagename_no_url,  
all_hit_dat_missing_corp_house_records::post_partner_plugins    AS post_partner_plugins,
all_hit_dat_missing_corp_house_records::post_persistent_cookie  AS post_persistent_cookie,
all_hit_dat_missing_corp_house_records::post_product_list       AS post_product_list,
all_hit_dat_missing_corp_house_records::post_prop1           AS post_prop1,
all_hit_dat_missing_corp_house_records::post_prop10           AS post_prop10,
all_hit_dat_missing_corp_house_records::post_prop11          AS post_prop11,        
all_hit_dat_missing_corp_house_records::post_prop12          AS post_prop12,        
all_hit_dat_missing_corp_house_records::post_prop13          AS post_prop13,        
all_hit_dat_missing_corp_house_records::post_prop14          AS post_prop14,        
all_hit_dat_missing_corp_house_records::post_prop15          AS post_prop15,        
all_hit_dat_missing_corp_house_records::post_prop16          AS post_prop16,        
all_hit_dat_missing_corp_house_records::post_prop17          AS post_prop17,        
all_hit_dat_missing_corp_house_records::post_prop18          AS post_prop18,        
all_hit_dat_missing_corp_house_records::post_prop19          AS post_prop19,       
all_hit_dat_missing_corp_house_records::post_prop2           AS post_prop2,
all_hit_dat_missing_corp_house_records::post_prop20          AS post_prop20,        
all_hit_dat_missing_corp_house_records::post_prop21          AS post_prop21,        
all_hit_dat_missing_corp_house_records::post_prop22          AS post_prop22,        
all_hit_dat_missing_corp_house_records::post_prop23          AS post_prop23,        
all_hit_dat_missing_corp_house_records::post_prop24          AS post_prop24,        
all_hit_dat_missing_corp_house_records::post_prop25          AS post_prop25,        
all_hit_dat_missing_corp_house_records::post_prop26          AS post_prop26,        
all_hit_dat_missing_corp_house_records::post_prop27          AS post_prop27,        
all_hit_dat_missing_corp_house_records::post_prop28          AS post_prop28,        
all_hit_dat_missing_corp_house_records::post_prop29          AS post_prop29,        
all_hit_dat_missing_corp_house_records::post_prop3           AS post_prop3,
all_hit_dat_missing_corp_house_records::post_prop30          AS post_prop30,        
all_hit_dat_missing_corp_house_records::post_prop31          AS post_prop31,       
all_hit_dat_missing_corp_house_records::post_prop32          AS post_prop32,        
all_hit_dat_missing_corp_house_records::post_prop33          AS post_prop33,        
all_hit_dat_missing_corp_house_records::post_prop34          AS post_prop34,        
all_hit_dat_missing_corp_house_records::post_prop35          AS post_prop35,        
all_hit_dat_missing_corp_house_records::post_prop36          AS post_prop36,        
all_hit_dat_missing_corp_house_records::post_prop37          AS post_prop37,        
all_hit_dat_missing_corp_house_records::post_prop38          AS post_prop38,        
all_hit_dat_missing_corp_house_records::post_prop39          AS post_prop39,        
all_hit_dat_missing_corp_house_records::post_prop4           AS post_prop4,
all_hit_dat_missing_corp_house_records::post_prop40          AS post_prop40,        
all_hit_dat_missing_corp_house_records::post_prop41          AS post_prop41,        
all_hit_dat_missing_corp_house_records::post_prop42          AS post_prop42,        
all_hit_dat_missing_corp_house_records::post_prop43          AS post_prop43,        
all_hit_dat_missing_corp_house_records::post_prop44          AS post_prop44,        
all_hit_dat_missing_corp_house_records::post_prop45          AS post_prop45,        
all_hit_dat_missing_corp_house_records::post_prop46          AS post_prop46,        
all_hit_dat_missing_corp_house_records::post_prop47          AS post_prop47,        
all_hit_dat_missing_corp_house_records::post_prop48          AS post_prop48,        
all_hit_dat_missing_corp_house_records::post_prop49          AS post_prop49,        
all_hit_dat_missing_corp_house_records::post_prop5           AS post_prop5,
all_hit_dat_missing_corp_house_records::post_prop50          AS post_prop50,        
all_hit_dat_missing_corp_house_records::post_prop51          AS post_prop51,        
all_hit_dat_missing_corp_house_records::post_prop52          AS post_prop52,        
all_hit_dat_missing_corp_house_records::post_prop53          AS post_prop53,        
all_hit_dat_missing_corp_house_records::post_prop54          AS post_prop54,        
all_hit_dat_missing_corp_house_records::post_prop55          AS post_prop55,        
all_hit_dat_missing_corp_house_records::post_prop56          AS post_prop56,        
all_hit_dat_missing_corp_house_records::post_prop57          AS post_prop57,        
all_hit_dat_missing_corp_house_records::post_prop58          AS post_prop58,        
all_hit_dat_missing_corp_house_records::post_prop59          AS post_prop59,        
all_hit_dat_missing_corp_house_records::post_prop6           AS post_prop6,
all_hit_dat_missing_corp_house_records::post_prop60          AS post_prop60,        
all_hit_dat_missing_corp_house_records::post_prop61          AS post_prop61,        
all_hit_dat_missing_corp_house_records::post_prop62          AS post_prop62,        
all_hit_dat_missing_corp_house_records::post_prop63          AS post_prop63,        
all_hit_dat_missing_corp_house_records::post_prop64          AS post_prop64,       
all_hit_dat_missing_corp_house_records::post_prop65          AS post_prop65,        
all_hit_dat_missing_corp_house_records::post_prop66          AS post_prop66,    
all_hit_dat_missing_corp_house_records::post_prop67          AS post_prop67,        
all_hit_dat_missing_corp_house_records::post_prop68          AS post_prop68,        
all_hit_dat_missing_corp_house_records::post_prop69          AS post_prop69,
all_hit_dat_missing_corp_house_records::post_prop7           AS post_prop7,
all_hit_dat_missing_corp_house_records::post_prop70          AS post_prop70,        
all_hit_dat_missing_corp_house_records::post_prop71          AS post_prop71,        
all_hit_dat_missing_corp_house_records::post_prop72          AS post_prop72,        
all_hit_dat_missing_corp_house_records::post_prop73          AS post_prop73,        
all_hit_dat_missing_corp_house_records::post_prop74          AS post_prop74,        
all_hit_dat_missing_corp_house_records::post_prop75          AS post_prop75,        
all_hit_dat_missing_corp_house_records::post_prop8          AS post_prop8,
all_hit_dat_missing_corp_house_records::post_prop9           AS post_prop9,
all_hit_dat_missing_corp_house_records::post_purchaseid         AS post_purchaseid,
all_hit_dat_missing_corp_house_records::post_referrer          AS post_referrer,
all_hit_dat_missing_corp_house_records::post_search_engine      AS post_search_engine,      
all_hit_dat_missing_corp_house_records::post_state           AS post_state,      
all_hit_dat_missing_corp_house_records::post_survey          AS post_survey,
all_hit_dat_missing_corp_house_records::post_t_time_info        AS post_t_time_info,
all_hit_dat_missing_corp_house_records::post_tnt           AS post_tnt,        
all_hit_dat_missing_corp_house_records::post_transactionid      AS post_transactionid,                
all_hit_dat_missing_corp_house_records::post_visid_high     as post_visid_high ,
all_hit_dat_missing_corp_house_records::post_visid_low    as post_visid_low ,
all_hit_dat_missing_corp_house_records::post_visid_type         AS post_visid_type,         
all_hit_dat_missing_corp_house_records::post_zip           AS post_zip,                   
all_hit_dat_missing_corp_house_records::prev_page           AS prev_page,        
all_hit_dat_missing_corp_house_records::product_list          AS product_list,     
all_hit_dat_missing_corp_house_records::product_merchandising   AS product_merchandising,
all_hit_dat_missing_corp_house_records::prop1            AS prop1,  
all_hit_dat_missing_corp_house_records::prop10_custom_link                  AS prop10_custom_link,
all_hit_dat_missing_corp_house_records::prop11                  AS prop11,
all_hit_dat_missing_corp_house_records::prop12            AS prop12,
all_hit_dat_missing_corp_house_records::prop13            AS prop13,
all_hit_dat_missing_corp_house_records::prop14            AS prop14,
all_hit_dat_missing_corp_house_records::prop15            AS prop15,
all_hit_dat_missing_corp_house_records::prop16            AS prop16,
all_hit_dat_missing_corp_house_records::prop17            AS prop17,
all_hit_dat_missing_corp_house_records::prop18            AS prop18,
all_hit_dat_missing_corp_house_records::prop19            AS prop19,
all_hit_dat_missing_corp_house_records::prop2            AS prop2,
all_hit_dat_missing_corp_house_records::prop20            AS prop20,
all_hit_dat_missing_corp_house_records::prop21            AS prop21,
all_hit_dat_missing_corp_house_records::prop22           AS prop22,
all_hit_dat_missing_corp_house_records::prop23           AS prop23,
all_hit_dat_missing_corp_house_records::prop24           AS prop24,
all_hit_dat_missing_corp_house_records::prop25                  AS prop25,
all_hit_dat_missing_corp_house_records::prop26                  AS prop26,
all_hit_dat_missing_corp_house_records::prop27           AS prop27,
all_hit_dat_missing_corp_house_records::prop28           AS prop28,
all_hit_dat_missing_corp_house_records::prop29           AS prop29,
all_hit_dat_missing_corp_house_records::prop3            AS prop3,
all_hit_dat_missing_corp_house_records::prop30           AS prop30,
all_hit_dat_missing_corp_house_records::prop31           AS prop31,
all_hit_dat_missing_corp_house_records::prop32           AS prop32,
all_hit_dat_missing_corp_house_records::prop33           AS prop33,
all_hit_dat_missing_corp_house_records::prop34           AS prop34,  
all_hit_dat_missing_corp_house_records::prop35_opt_err_msg_desc                  AS prop35_opt_err_msg_desc,
all_hit_dat_missing_corp_house_records::prop36                  AS prop36,
all_hit_dat_missing_corp_house_records::prop37           AS prop37,
all_hit_dat_missing_corp_house_records::prop38           AS prop38,
all_hit_dat_missing_corp_house_records::prop39           AS prop39,
all_hit_dat_missing_corp_house_records::prop4            AS prop4,
all_hit_dat_missing_corp_house_records::prop40           AS prop40,
all_hit_dat_missing_corp_house_records::prop41_lead_form_field      AS prop41_lead_form_field,
all_hit_dat_missing_corp_house_records::prop42_order_form_field      AS prop42_order_form_field,
all_hit_dat_missing_corp_house_records::prop43_checkout_form_field      AS prop43_checkout_form_field,
all_hit_dat_missing_corp_house_records::prop44_site_type      AS prop44_site_type,
all_hit_dat_missing_corp_house_records::prop45_page_type      AS prop45_page_type,
all_hit_dat_missing_corp_house_records::prop46           AS prop46,
all_hit_dat_missing_corp_house_records::prop47           AS prop47,
all_hit_dat_missing_corp_house_records::prop48           AS prop48,
all_hit_dat_missing_corp_house_records::prop49           AS prop49,
all_hit_dat_missing_corp_house_records::prop5            AS prop5,
all_hit_dat_missing_corp_house_records::prop50           AS prop50,
all_hit_dat_missing_corp_house_records::prop51           AS prop51,
all_hit_dat_missing_corp_house_records::prop52           AS prop52,
all_hit_dat_missing_corp_house_records::prop53           AS prop53,
all_hit_dat_missing_corp_house_records::prop54           AS prop54,
all_hit_dat_missing_corp_house_records::prop55           AS prop55,
all_hit_dat_missing_corp_house_records::prop56           AS prop56,
all_hit_dat_missing_corp_house_records::prop57           AS prop57,
all_hit_dat_missing_corp_house_records::prop58           AS prop58,
all_hit_dat_missing_corp_house_records::prop59           AS prop59,
all_hit_dat_missing_corp_house_records::prop6                     AS prop6,
all_hit_dat_missing_corp_house_records::prop60           AS prop60,
all_hit_dat_missing_corp_house_records::prop61           AS prop61,
all_hit_dat_missing_corp_house_records::prop62           AS prop62,
all_hit_dat_missing_corp_house_records::prop63           AS prop63,
all_hit_dat_missing_corp_house_records::prop64           AS prop64,
all_hit_dat_missing_corp_house_records::prop65           AS prop65,
all_hit_dat_missing_corp_house_records::prop66           AS prop66,
all_hit_dat_missing_corp_house_records::prop67           AS prop67,
all_hit_dat_missing_corp_house_records::prop68           AS prop68,
all_hit_dat_missing_corp_house_records::prop69           AS prop69,
all_hit_dat_missing_corp_house_records::prop7                     AS prop7,
all_hit_dat_missing_corp_house_records::prop70           AS prop70,
all_hit_dat_missing_corp_house_records::prop71           AS prop71,
all_hit_dat_missing_corp_house_records::prop72           AS prop72,
all_hit_dat_missing_corp_house_records::prop73           AS prop73,
all_hit_dat_missing_corp_house_records::prop74           AS prop74,
all_hit_dat_missing_corp_house_records::prop75           AS prop75,
all_hit_dat_missing_corp_house_records::prop8                    AS prop8,
all_hit_dat_missing_corp_house_records::prop9            AS prop9,    
all_hit_dat_missing_corp_house_records::quarterly_visitor       AS quarterly_visitor,       
all_hit_dat_missing_corp_house_records::ref_domain             AS ref_domain,
all_hit_dat_missing_corp_house_records::referrer                AS referrer,
all_hit_dat_missing_corp_house_records::referrer_type_fullname      AS   referrer_type_fullname,
all_hit_dat_missing_corp_house_records::referrer_type_id               AS referrer_type_id,
all_hit_dat_missing_corp_house_records::referrer_type_shortname     AS referrer_type_shortname,
all_hit_dat_missing_corp_house_records::resolution              AS resolution,
all_hit_dat_missing_corp_house_records::s_resolution          AS s_resolution, 
all_hit_dat_missing_corp_house_records::sampled_hit             AS sampled_hit,
all_hit_dat_missing_corp_house_records::search_engine_id           AS search_engine_id,
all_hit_dat_missing_corp_house_records::search_engine_name      AS search_engine_name,
all_hit_dat_missing_corp_house_records::search_page_num         AS search_page_num,
all_hit_dat_missing_corp_house_records::secondary_hit     AS secondary_hit,
all_hit_dat_missing_corp_house_records::service           AS service,         
all_hit_dat_missing_corp_house_records::site_section_id AS site_section_id, 
all_hit_dat_missing_corp_house_records::site_section_name                 AS site_section_name,
'omniture'              AS sourced_from_system,
all_hit_dat_missing_corp_house_records::sourceid           AS sourceid,       
all_hit_dat_missing_corp_house_records::state            AS state,        
all_hit_dat_missing_corp_house_records::stats_server          AS stats_server, 
all_hit_dat_missing_corp_house_records::suite_id                   AS suite_id,
all_hit_dat_missing_corp_house_records::t_time_info         AS t_time_info,
all_hit_dat_missing_corp_house_records::tnt            AS tnt,
all_hit_dat_missing_corp_house_records::tnt_post_vista          AS tnt_post_vista,                       
all_hit_dat_missing_corp_house_records::truncated_hit           AS truncated_hit,            
all_hit_dat_missing_corp_house_records::ua_color       AS ua_color,
all_hit_dat_missing_corp_house_records::ua_os            AS ua_os,
all_hit_dat_missing_corp_house_records::ua_pixels           AS ua_pixels,
all_hit_dat_missing_corp_house_records::user_agent           AS user_agent,
all_hit_dat_missing_corp_house_records::user_hash           AS user_hash,
all_hit_dat_missing_corp_house_records::user_server          AS user_server,
all_hit_dat_missing_corp_house_records::userid            AS userid,
all_hit_dat_missing_corp_house_records::username           AS username,  
all_hit_dat_missing_corp_house_records::va_closer_detail        AS va_closer_detail,
all_hit_dat_missing_corp_house_records::va_closer_id            AS va_closer_id,
all_hit_dat_missing_corp_house_records::va_finder_detail        AS va_finder_detail,
all_hit_dat_missing_corp_house_records::va_finder_id            AS va_finder_id,
all_hit_dat_missing_corp_house_records::va_instance_event       AS va_instance_event,
all_hit_dat_missing_corp_house_records::va_new_engagement       AS va_new_engagement,
all_hit_dat_missing_corp_house_records::visid_high           AS visid_high,
all_hit_dat_missing_corp_house_records::visid_low           AS visid_low,
all_hit_dat_missing_corp_house_records::visid_new           AS visid_new,
all_hit_dat_missing_corp_house_records::visid_timestamp         AS visid_timestamp,
all_hit_dat_missing_corp_house_records::visid_type           AS visid_type,
all_hit_dat_missing_corp_house_records::visit_date              AS visit_date,
all_hit_dat_missing_corp_house_records::visit_keywords          AS visit_keywords,
all_hit_dat_missing_corp_house_records::visit_num           AS visit_num,
all_hit_dat_missing_corp_house_records::visit_page_num          AS visit_page_num,
all_hit_dat_missing_corp_house_records::visit_referrer          AS visit_referrer,
all_hit_dat_missing_corp_house_records::visit_search_engine     AS visit_search_engine,  
all_hit_dat_missing_corp_house_records::visit_start_page_url    AS visit_start_page_url,
all_hit_dat_missing_corp_house_records::visit_start_pagename    AS visit_start_pagename,
all_hit_dat_missing_corp_house_records::visit_start_time_gmt    AS visit_start_time_gmt,
all_hit_dat_missing_corp_house_records::weekly_visitor          AS weekly_visitor,
all_hit_dat_missing_corp_house_records::yearly_visitor          AS yearly_visitor,
all_hit_dat_missing_corp_house_records::zip           AS zip,
all_hit_dat_missing_corp_house_records::site_type  AS site_type,
all_hit_dat_missing_corp_house_records::cart_id as cart_id,
(int) all_hit_dat_missing_corp_house_records::corp as corp,
all_hit_dat_missing_corp_house_records::dwelling_nbr as dwelling_nbr;


hit_data_with_multiple_corp_house_records = union onschema hit_data_with_corp_house_multiple_records, hit_data_without_corp_house_multiple_records; 

populated_multiple_corp_house_records = foreach (group hit_data_with_multiple_corp_house_records by (post_visid_high, post_visid_low, ip)) {
	sorted = order hit_data_with_multiple_corp_house_records by visit_date;
 	generate flatten(AssignHouseNumber(sorted));
}

				
hit_data_populated_single_corp_house_records = foreach (join distinct_single_corp_house_visid_high_low_ip_records
	by CONCAT(CONCAT(CONCAT(post_visid_high,'||'),post_visid_low), CONCAT('||',ip)) 
	right outer, hit_data_without_corp_house_single_records by CONCAT(CONCAT(CONCAT(post_visid_high,'||'),post_visid_low), CONCAT('||',ip))) 
	generate accept_language..site_type, cart_id, (distinct_single_corp_house_visid_high_low_ip_records::corp is not null ? distinct_single_corp_house_visid_high_low_ip_records::corp : -1)
	as corp, (distinct_single_corp_house_visid_high_low_ip_records::dwelling_nbr is not null ? distinct_single_corp_house_visid_high_low_ip_records::dwelling_nbr : '-1')
	as dwelling_nbr;

result_hit_data_records_1 = union onschema hit_data_populated_single_corp_house_records, hit_data_with_corp_house_single_records;
final_result_records = union onschema result_hit_data_records_1, populated_multiple_corp_house_records;

--##############################################################################
--#                                 Store                                      #
--##############################################################################

  STORE final_result_records 
   INTO '${hive_database_name_gold}.${gold_unified_hit_data_tbl}' 
   USING org.apache.hive.hcatalog.pig.HCatStorer('suite_name=$suite_name, source_date=$source_date')
; 
				

--##############################################################################
--#                              End                                           #
--##############################################################################			


